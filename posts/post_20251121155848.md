# NetCDF (.nc) 文件简介
### 什么是NetCDF

NetCDF 是由美国国家水气数据中心（Unidata）开发的一种用于创建、访问和共享科学数据的开源文件格式。它被广泛应用于存储多维数组数据，尤其在科学研究中，如气候研究、海洋科学、遥感等领域。
### 文件结构

一个典型的 NetCDF 文件包含以下几个部分：

- **维度（Dimensions）**：定义数据的维度，如时间、经度、纬度等。例如：`time`, `latitude`, `longitude`。
- **变量（Variables）**：存储数据的实际内容，变量可以是标量或多维数组。例如，温度（temperature）、盐度（salinity）等。
- **属性（Attributes）**：为变量和维度提供额外的信息。例如，单位（units）、数据来源（source）、描述（description）等。


# NetCDF 文件格式与 C# 读取实战

> 本文介绍 NetCDF 文件格式的基础知识，并分享如何在 C# 环境下读取和处理 NetCDF 科学数据，适合气象、海洋、遥感等领域的开发者参考。

---

## 1. NetCDF 文件是什么？

NetCDF（Network Common Data Form）是一种专为科学数据设计的开源文件格式，由美国 Unidata 组织开发。它支持多维数组数据的高效存储和访问，广泛应用于气候、海洋、遥感等科学领域。

### NetCDF 文件结构

- **维度（Dimensions）**：如时间、经度、纬度等，定义数据的空间和时间范围。
- **变量（Variables）**：实际存储的数据内容，可以是标量或多维数组，如温度、盐度等。
- **属性（Attributes）**：为变量和维度提供补充说明，如单位、来源、描述等。

举例：一个海洋环境数据文件 `ocean_data.nc` 可能包含：

| 维度      | 说明                |
|-----------|---------------------|
| time      | 时间点              |
| lat       | 纬度（-90 ~ 90）    |
| lon       | 经度（-180 ~ 180）  |

| 变量         | 单位      |
|--------------|----------|
| temperature  | 摄氏度    |
| salinity     | psu      |

---

## 2. C# 读取 NetCDF 文件

### 环境准备

1. **ScientificDataSet.dll**
   - 下载：[Microsoft Scientific Data Set](https://www.microsoft.com/en-us/research/project/scientific-dataset/)
   - 或 NuGet 安装 SDSLite：
     ```bash
     dotnet add package SDSLite --version 3.0.1
     ```
2. **netCDF 软件**
   - 推荐版本：[netCDF4.9.2-NC4-64.exe](https://downloads.unidata.ucar.edu/netcdf-c/4.9.2/netCDF4.9.2-NC4-64.exe)
   - 更多版本见：https://downloads.unidata.ucar.edu/netcdf/

> Unity 项目：将 `ScientificDataSet.dll` 放入 Plugins 文件夹即可。
> .NET 项目：直接 NuGet 安装 SDSLite。

### 示例代码

```csharp
using Microsoft.Research.Science.Data;
using Microsoft.Research.Science.Data.Imperative;

// 下载 NetCDF 文件
var client = new System.Net.Http.HttpClient();
var response = await client.GetAsync("https://www.unidata.ucar.edu/software/netcdf/examples/sresa1b_ncar_ccsm3-example.nc");
using (var stream = System.IO.File.OpenWrite("sresa1b_ncar_ccsm3-example.nc")) {
    await response.Content.CopyToAsync(stream);
}

// 打开并读取数据
using (DataSet ds = DataSet.Open("msds:nc?file=sresa1b_ncar_ccsm3-example.nc&openMode=readOnly")) {
    Console.WriteLine(ds);
    Console.WriteLine(ds.Metadata["comment"]);
    var lat = ds.GetData<float[]>("lat");
    var ua = ds.GetData<float[,,,]>("ua");
    var plev = ds.GetData<double[]>("plev");
    Console.WriteLine($"latitude: len={lat.Length}, min={lat.Min()}, max={lat.Max()}");
}
```

#### 运行结果示例

```
msds:nc?openMode=readOnly&file=c:\Users\***\sresa1b_ncar_ccsm3-example.nc
[1]
DSID: ca6c1f06-f743-4190-9b94-20cf0cbc18f7
[12] ua of type Single (time:1) (plev:17) (lat:128) (lon:256)
[2] lat of type Single (lat:128)
...（省略部分）
latitude: len=128, min=-88.927734, max=88.927734
```

---

## 3. 常见问题与资源

- 不同电脑可能对 netCDF 版本有要求，建议根据实际情况选择。
- 更多资源下载：[ScientificDataSet.dll和NetCDF.exe](https://download.csdn.net/download/wa36d/90266779)

---

欢迎交流 NetCDF 数据处理相关问题，或留言分享你的科学数据开发经验！
