[["Map",1,2,7,8],"meta::meta",["Map",3,4,5,6],"astro-version","5.16.6","astro-config-digest","{\"root\":{},\"srcDir\":{},\"publicDir\":{},\"outDir\":{},\"cacheDir\":{},\"compressHTML\":true,\"base\":\"/\",\"trailingSlash\":\"ignore\",\"output\":\"static\",\"scopedStyleStrategy\":\"attribute\",\"build\":{\"format\":\"directory\",\"client\":{},\"server\":{},\"assets\":\"_astro\",\"serverEntry\":\"entry.mjs\",\"redirects\":true,\"inlineStylesheets\":\"auto\",\"concurrency\":1},\"server\":{\"open\":false,\"host\":false,\"port\":4321,\"streaming\":true,\"allowedHosts\":[]},\"redirects\":{},\"image\":{\"endpoint\":{\"route\":\"/_image\"},\"service\":{\"entrypoint\":\"astro/assets/services/sharp\",\"config\":{}},\"domains\":[],\"remotePatterns\":[],\"responsiveStyles\":false},\"devToolbar\":{\"enabled\":true},\"markdown\":{\"syntaxHighlight\":{\"type\":\"shiki\",\"excludeLangs\":[\"math\"]},\"shikiConfig\":{\"langs\":[],\"langAlias\":{},\"theme\":\"github-dark\",\"themes\":{},\"wrap\":false,\"transformers\":[]},\"remarkPlugins\":[],\"rehypePlugins\":[],\"remarkRehype\":{},\"gfm\":true,\"smartypants\":true},\"security\":{\"checkOrigin\":true,\"allowedDomains\":[]},\"env\":{\"schema\":{},\"validateSecrets\":false},\"experimental\":{\"clientPrerender\":false,\"contentIntellisense\":false,\"headingIdCompat\":false,\"preserveScriptOrder\":false,\"liveContentCollections\":false,\"csp\":false,\"staticImportMetaEnv\":false,\"chromeDevtoolsWorkspace\":false,\"failOnPrerenderConflict\":false,\"svgo\":false},\"legacy\":{\"collections\":false}}","posts",["Map",9,10,26,27,60,61,87,88],"about",{"id":9,"data":11,"body":12,"filePath":13,"digest":14,"rendered":15,"legacyId":25},{},"# 关于我\r\n\r\n  大家好，我是又来！来着长沙的一位热爱游戏和技术的00后开发者。\r\n\r\n  我喜欢用代码创造属于自己的世界，尤其喜欢研究游戏的底层机制和各种有趣的玩法。Unity 是我最常用的开发工具，无论是做单机、联机还是 VR/AR 项目，都能让我乐在其中。\r\n\r\n  平时除了写代码，也喜欢玩各种类型的游戏，尤其是策略类、动作类和独立游戏。最喜欢的系列有《文明》、《塞尔达》、《P5》、《星露谷物语》等等。偶尔也会自己做一些小游戏，或者和朋友一起开发一些有趣的 Demo。\r\n\r\n  兴趣爱好方面，除了游戏和编程，我还喜欢画画、摄影、看科幻小说、研究 AI 技术。喜欢和志同道合的朋友交流技术、分享创意。\r\n\r\n  我相信游戏不仅仅是娱乐，更是一种表达和连接的方式。希望能用自己的技术和创意，做出让人开心、感动、甚至能改变一点点世界的作品。\r\n\r\n  欢迎交流、一起玩游戏或者合作开发！","src/content/posts/about.md","7b2021144f2b4143",{"html":16,"metadata":17},"\u003Ch1 id=\"关于我\">关于我\u003C/h1>\n\u003Cp>大家好，我是又来！来着长沙的一位热爱游戏和技术的00后开发者。\u003C/p>\n\u003Cp>我喜欢用代码创造属于自己的世界，尤其喜欢研究游戏的底层机制和各种有趣的玩法。Unity 是我最常用的开发工具，无论是做单机、联机还是 VR/AR 项目，都能让我乐在其中。\u003C/p>\n\u003Cp>平时除了写代码，也喜欢玩各种类型的游戏，尤其是策略类、动作类和独立游戏。最喜欢的系列有《文明》、《塞尔达》、《P5》、《星露谷物语》等等。偶尔也会自己做一些小游戏，或者和朋友一起开发一些有趣的 Demo。\u003C/p>\n\u003Cp>兴趣爱好方面，除了游戏和编程，我还喜欢画画、摄影、看科幻小说、研究 AI 技术。喜欢和志同道合的朋友交流技术、分享创意。\u003C/p>\n\u003Cp>我相信游戏不仅仅是娱乐，更是一种表达和连接的方式。希望能用自己的技术和创意，做出让人开心、感动、甚至能改变一点点世界的作品。\u003C/p>\n\u003Cp>欢迎交流、一起玩游戏或者合作开发！\u003C/p>",{"headings":18,"localImagePaths":22,"remoteImagePaths":23,"frontmatter":11,"imagePaths":24},[19],{"depth":20,"slug":21,"text":21},1,"关于我",[],[],[],"about.md","post_20251226054819",{"id":26,"data":28,"body":29,"filePath":30,"digest":31,"rendered":32,"legacyId":59},{},"在 Unity 中进行手柄开发时，按键的对应名称（Button Names）取决于你使用的是 **传统的 Input Manager (旧版)** 还是 **Input System Package (新版)**。\n\n目前主流且推荐的做法是使用 **Input System Package**，因为它能自动处理不同手柄（Xbox, PS4, Switch）之间的差异。\n\n---\n\n## 1. 新版 Input System (推荐)\n\n在新版系统中，你不需要记忆复杂的编号，只需使用路径（Path）即可。\n\n| 手柄按键 (通用名称) | 路径名称 (Path) |\n| --- | --- |\n| **南面按键** (Xbox: A / PS: ×) | `\u003CGamepad>/buttonSouth` |\n| **东面按键** (Xbox: B / PS: ○) | `\u003CGamepad>/buttonEast` |\n| **西面按键** (Xbox: X / PS: □) | `\u003CGamepad>/buttonWest` |\n| **北面按键** (Xbox: Y / PS: △) | `\u003CGamepad>/buttonNorth` |\n| **左/右肩键** (LB / RB) | `\u003CGamepad>/leftShoulder`, `\u003CGamepad>/rightShoulder` |\n| **左/右扳机** (LT / RT) | `\u003CGamepad>/leftTrigger`, `\u003CGamepad>/rightTrigger` |\n| **左/右摇杆点击** (LS / RS) | `\u003CGamepad>/leftStickPress`, `\u003CGamepad>/rightStickPress` |\n| **方向键** (D-Pad) | `\u003CGamepad>/dpad/up`, `down`, `left`, `right` |\n| **功能键** (Start / Back) | `\u003CGamepad>/start`, `\u003CGamepad>/select` |\n\n---\n\n## 2. 旧版 Input Manager (默认项目设置)\n\n如果你在 `Project Settings -> Input Manager` 中手动设置，通常需要对应 **Joystick Button** 的编号。以下是以 **Xbox Controller (Windows)** 为标准的映射：\n\n### 常用按键映射表 (Xbox)\n\n\n\n![3ba9965a91e04fa59ca496e1a5db8142.png](/uploads/images/1766734880544-906187610.png)\n\n\n### 按钮映射表 (Buttons)\n| 物理按键 (Physical Button) | Unity 映射 ID (Map to) | 备注 |\n| --- | --- | --- |\n| **A** | `joystick button 0` | 确认 / 跳跃 |\n| **B** | `joystick button 1` | 取消 / 返回 |\n| **X** | `joystick button 2` | **(你在图中漏标了这个)** |\n| **Y** | `joystick button 3` |  |\n| **LB** (左肩键) | `joystick button 4` | Left Bumper |\n| **RB** (右肩键) | `joystick button 5` | Right Bumper |\n| **View** (双框图标) | `joystick button 6` | 旧称 Back 键 |\n| **Menu** (三道杠图标) | `joystick button 7` | 旧称 Start 键 |\n| **L3** (按下左摇杆) | `joystick button 8` | Left Stick Click |\n| **R3** (按下右摇杆) | `joystick button 9` | Right Stick Click |\n| **Share** (中间分享键) | *通常无法识别* | 旧版输入系统很难直接检测到此键 |\n| **Xbox 标** (西瓜键) | *系统占用* | 呼出 Windows 游戏栏，Unity 无法获取 |\n### 轴线映射 (Axes)\n| 物理输入 (Physical Input) | Unity 轴向 (Axis Name/Number) | 值范围 (Value) |\n| --- | --- | --- |\n| **左摇杆 - 水平** | `X Axis` | -1 (左) 到 1 (右) |\n| **左摇杆 - 垂直** | `Y Axis` | -1 (下) 到 1 (上)* |\n| **右摇杆 - 水平** | `4th Axis` | -1 (左) 到 1 (右) |\n| **右摇杆 - 垂直** | `5th Axis` | -1 (下) 到 1 (上)* |\n| **D-Pad (十字键) - 水平** | `6th Axis` | -1 (左) 到 1 (右) |\n| **D-Pad (十字键) - 垂直** | `7th Axis` | -1 (下) 到 1 (上) |\n| **LT (左扳机)** | `9th Axis` | 0 (松开) 到 1 (按下) |\n| **RT (右扳机)** | `10th Axis` | 0 (松开) 到 1 (按下) |\n---\n\n## 3. 注意事项：PS4/PS5 手柄差异\n\n如果你使用的是 PS4 DualShock 手柄且通过旧版 Input Manager 识别，编号会完全不同：\n\n* **× (South):** `joystick button 1`\n* **○ (East):** `joystick button 2`\n* **□ (West):** `joystick button 0`\n* **△ (North):** `joystick button 3`","src/content/posts/post_20251226054819.md","4b8f0d427946eea8",{"html":33,"metadata":34},"\u003Cp>在 Unity 中进行手柄开发时，按键的对应名称（Button Names）取决于你使用的是 \u003Cstrong>传统的 Input Manager (旧版)\u003C/strong> 还是 \u003Cstrong>Input System Package (新版)\u003C/strong>。\u003C/p>\n\u003Cp>目前主流且推荐的做法是使用 \u003Cstrong>Input System Package\u003C/strong>，因为它能自动处理不同手柄（Xbox, PS4, Switch）之间的差异。\u003C/p>\n\u003Chr>\n\u003Ch2 id=\"1-新版-input-system-推荐\">1. 新版 Input System (推荐)\u003C/h2>\n\u003Cp>在新版系统中，你不需要记忆复杂的编号，只需使用路径（Path）即可。\u003C/p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003Ctable>\u003Cthead>\u003Ctr>\u003Cth>手柄按键 (通用名称)\u003C/th>\u003Cth>路径名称 (Path)\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd>\u003Cstrong>南面按键\u003C/strong> (Xbox: A / PS: ×)\u003C/td>\u003Ctd>\u003Ccode>&#x3C;Gamepad>/buttonSouth\u003C/code>\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>东面按键\u003C/strong> (Xbox: B / PS: ○)\u003C/td>\u003Ctd>\u003Ccode>&#x3C;Gamepad>/buttonEast\u003C/code>\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>西面按键\u003C/strong> (Xbox: X / PS: □)\u003C/td>\u003Ctd>\u003Ccode>&#x3C;Gamepad>/buttonWest\u003C/code>\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>北面按键\u003C/strong> (Xbox: Y / PS: △)\u003C/td>\u003Ctd>\u003Ccode>&#x3C;Gamepad>/buttonNorth\u003C/code>\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>左/右肩键\u003C/strong> (LB / RB)\u003C/td>\u003Ctd>\u003Ccode>&#x3C;Gamepad>/leftShoulder\u003C/code>, \u003Ccode>&#x3C;Gamepad>/rightShoulder\u003C/code>\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>左/右扳机\u003C/strong> (LT / RT)\u003C/td>\u003Ctd>\u003Ccode>&#x3C;Gamepad>/leftTrigger\u003C/code>, \u003Ccode>&#x3C;Gamepad>/rightTrigger\u003C/code>\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>左/右摇杆点击\u003C/strong> (LS / RS)\u003C/td>\u003Ctd>\u003Ccode>&#x3C;Gamepad>/leftStickPress\u003C/code>, \u003Ccode>&#x3C;Gamepad>/rightStickPress\u003C/code>\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>方向键\u003C/strong> (D-Pad)\u003C/td>\u003Ctd>\u003Ccode>&#x3C;Gamepad>/dpad/up\u003C/code>, \u003Ccode>down\u003C/code>, \u003Ccode>left\u003C/code>, \u003Ccode>right\u003C/code>\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>功能键\u003C/strong> (Start / Back)\u003C/td>\u003Ctd>\u003Ccode>&#x3C;Gamepad>/start\u003C/code>, \u003Ccode>&#x3C;Gamepad>/select\u003C/code>\u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\n\u003Chr>\n\u003Ch2 id=\"2-旧版-input-manager-默认项目设置\">2. 旧版 Input Manager (默认项目设置)\u003C/h2>\n\u003Cp>如果你在 \u003Ccode>Project Settings -> Input Manager\u003C/code> 中手动设置，通常需要对应 \u003Cstrong>Joystick Button\u003C/strong> 的编号。以下是以 \u003Cstrong>Xbox Controller (Windows)\u003C/strong> 为标准的映射：\u003C/p>\n\u003Ch3 id=\"常用按键映射表-xbox\">常用按键映射表 (Xbox)\u003C/h3>\n\u003Cp>\u003Cimg src=\"/uploads/images/1766734880544-906187610.png\" alt=\"3ba9965a91e04fa59ca496e1a5db8142.png\">\u003C/p>\n\u003Ch3 id=\"按钮映射表-buttons\">按钮映射表 (Buttons)\u003C/h3>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003Ctable>\u003Cthead>\u003Ctr>\u003Cth>物理按键 (Physical Button)\u003C/th>\u003Cth>Unity 映射 ID (Map to)\u003C/th>\u003Cth>备注\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd>\u003Cstrong>A\u003C/strong>\u003C/td>\u003Ctd>\u003Ccode>joystick button 0\u003C/code>\u003C/td>\u003Ctd>确认 / 跳跃\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>B\u003C/strong>\u003C/td>\u003Ctd>\u003Ccode>joystick button 1\u003C/code>\u003C/td>\u003Ctd>取消 / 返回\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>X\u003C/strong>\u003C/td>\u003Ctd>\u003Ccode>joystick button 2\u003C/code>\u003C/td>\u003Ctd>\u003Cstrong>(你在图中漏标了这个)\u003C/strong>\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>Y\u003C/strong>\u003C/td>\u003Ctd>\u003Ccode>joystick button 3\u003C/code>\u003C/td>\u003Ctd>\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>LB\u003C/strong> (左肩键)\u003C/td>\u003Ctd>\u003Ccode>joystick button 4\u003C/code>\u003C/td>\u003Ctd>Left Bumper\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>RB\u003C/strong> (右肩键)\u003C/td>\u003Ctd>\u003Ccode>joystick button 5\u003C/code>\u003C/td>\u003Ctd>Right Bumper\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>View\u003C/strong> (双框图标)\u003C/td>\u003Ctd>\u003Ccode>joystick button 6\u003C/code>\u003C/td>\u003Ctd>旧称 Back 键\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>Menu\u003C/strong> (三道杠图标)\u003C/td>\u003Ctd>\u003Ccode>joystick button 7\u003C/code>\u003C/td>\u003Ctd>旧称 Start 键\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>L3\u003C/strong> (按下左摇杆)\u003C/td>\u003Ctd>\u003Ccode>joystick button 8\u003C/code>\u003C/td>\u003Ctd>Left Stick Click\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>R3\u003C/strong> (按下右摇杆)\u003C/td>\u003Ctd>\u003Ccode>joystick button 9\u003C/code>\u003C/td>\u003Ctd>Right Stick Click\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>Share\u003C/strong> (中间分享键)\u003C/td>\u003Ctd>\u003Cem>通常无法识别\u003C/em>\u003C/td>\u003Ctd>旧版输入系统很难直接检测到此键\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>Xbox 标\u003C/strong> (西瓜键)\u003C/td>\u003Ctd>\u003Cem>系统占用\u003C/em>\u003C/td>\u003Ctd>呼出 Windows 游戏栏，Unity 无法获取\u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\n\u003Ch3 id=\"轴线映射-axes\">轴线映射 (Axes)\u003C/h3>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003Ctable>\u003Cthead>\u003Ctr>\u003Cth>物理输入 (Physical Input)\u003C/th>\u003Cth>Unity 轴向 (Axis Name/Number)\u003C/th>\u003Cth>值范围 (Value)\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd>\u003Cstrong>左摇杆 - 水平\u003C/strong>\u003C/td>\u003Ctd>\u003Ccode>X Axis\u003C/code>\u003C/td>\u003Ctd>-1 (左) 到 1 (右)\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>左摇杆 - 垂直\u003C/strong>\u003C/td>\u003Ctd>\u003Ccode>Y Axis\u003C/code>\u003C/td>\u003Ctd>-1 (下) 到 1 (上)*\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>右摇杆 - 水平\u003C/strong>\u003C/td>\u003Ctd>\u003Ccode>4th Axis\u003C/code>\u003C/td>\u003Ctd>-1 (左) 到 1 (右)\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>右摇杆 - 垂直\u003C/strong>\u003C/td>\u003Ctd>\u003Ccode>5th Axis\u003C/code>\u003C/td>\u003Ctd>-1 (下) 到 1 (上)*\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>D-Pad (十字键) - 水平\u003C/strong>\u003C/td>\u003Ctd>\u003Ccode>6th Axis\u003C/code>\u003C/td>\u003Ctd>-1 (左) 到 1 (右)\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>D-Pad (十字键) - 垂直\u003C/strong>\u003C/td>\u003Ctd>\u003Ccode>7th Axis\u003C/code>\u003C/td>\u003Ctd>-1 (下) 到 1 (上)\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>LT (左扳机)\u003C/strong>\u003C/td>\u003Ctd>\u003Ccode>9th Axis\u003C/code>\u003C/td>\u003Ctd>0 (松开) 到 1 (按下)\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>RT (右扳机)\u003C/strong>\u003C/td>\u003Ctd>\u003Ccode>10th Axis\u003C/code>\u003C/td>\u003Ctd>0 (松开) 到 1 (按下)\u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\n\u003Chr>\n\u003Ch2 id=\"3-注意事项ps4ps5-手柄差异\">3. 注意事项：PS4/PS5 手柄差异\u003C/h2>\n\u003Cp>如果你使用的是 PS4 DualShock 手柄且通过旧版 Input Manager 识别，编号会完全不同：\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cstrong>× (South):\u003C/strong> \u003Ccode>joystick button 1\u003C/code>\u003C/li>\n\u003Cli>\u003Cstrong>○ (East):\u003C/strong> \u003Ccode>joystick button 2\u003C/code>\u003C/li>\n\u003Cli>\u003Cstrong>□ (West):\u003C/strong> \u003Ccode>joystick button 0\u003C/code>\u003C/li>\n\u003Cli>\u003Cstrong>△ (North):\u003C/strong> \u003Ccode>joystick button 3\u003C/code>\u003C/li>\n\u003C/ul>",{"headings":35,"localImagePaths":56,"remoteImagePaths":57,"frontmatter":28,"imagePaths":58},[36,40,43,47,50,53],{"depth":37,"slug":38,"text":39},2,"1-新版-input-system-推荐","1. 新版 Input System (推荐)",{"depth":37,"slug":41,"text":42},"2-旧版-input-manager-默认项目设置","2. 旧版 Input Manager (默认项目设置)",{"depth":44,"slug":45,"text":46},3,"常用按键映射表-xbox","常用按键映射表 (Xbox)",{"depth":44,"slug":48,"text":49},"按钮映射表-buttons","按钮映射表 (Buttons)",{"depth":44,"slug":51,"text":52},"轴线映射-axes","轴线映射 (Axes)",{"depth":37,"slug":54,"text":55},"3-注意事项ps4ps5-手柄差异","3. 注意事项：PS4/PS5 手柄差异",[],[],[],"post_20251226054819.md","unity_001",{"id":60,"data":62,"body":63,"filePath":64,"digest":65,"rendered":66,"legacyId":86},{},"# Unity 自由相机\r\n### 操作方式\r\n- WASD水平移动 (按住左SHIFT加速移动) \r\n- QE垂直移动   \r\n- 鼠标右键按下旋转视角\r\n\r\n### 代码内容\r\n```csharp\r\nusing UnityEngine;\r\n\r\n/// \u003Csummary>\r\n/// 自由相机\r\n/// \u003C/summary>\r\npublic class FreeCamera : MonoBehaviour\r\n{\r\n    [Tooltip(\"水平移动速度\")] public float horizontalSpeed = 50f; //水平移动速度\r\n    [Tooltip(\"垂直移动速度\")] public float verticalSpeed = 10f; //垂直移动速度\r\n    [Tooltip(\"鼠标旋转速度\")] public float rotationSpeed = 2f; //旋转速度\r\n\r\n    private float _rotationX; //上下旋转角度\r\n\r\n    public void Update()\r\n    {\r\n        HandleMove();\r\n        HandleRotate();\r\n    }\r\n\r\n    /// \u003Csummary>\r\n    /// 相机移动\r\n    /// \u003C/summary>\r\n    private void HandleMove()\r\n    {\r\n        //视角平行移动\r\n        var horizontal = Input.GetAxis(\"Horizontal\");\r\n        var vertical = Input.GetAxis(\"Vertical\");\r\n        var direction = horizontalSpeed * Time.deltaTime * new Vector3(horizontal, 0f, vertical);\r\n\r\n        if (Input.GetKey(KeyCode.LeftShift))  //按Shift移动加速\r\n            direction *= 3;\r\n\r\n        transform.Translate(direction);\r\n\r\n        //  控制摄像机垂直移动\r\n        if (Input.GetKey(KeyCode.Q))\r\n            transform.position += transform.up * (verticalSpeed * Time.deltaTime);\r\n        else if (Input.GetKey(KeyCode.E))\r\n            transform.position -= transform.up * (verticalSpeed * Time.deltaTime);\r\n    }\r\n\r\n\r\n    /// \u003Csummary>\r\n    /// 视角旋转\r\n    /// \u003C/summary>\r\n    private void HandleRotate()\r\n    {\r\n        if (Input.GetMouseButton(1))\r\n        {\r\n            var mouseX = Input.GetAxis(\"Mouse X\") * rotationSpeed;\r\n            var mouseY = Input.GetAxis(\"Mouse Y\") * rotationSpeed;\r\n\r\n            _rotationX -= mouseY;\r\n            _rotationX = Mathf.Clamp(_rotationX, -90， 90);\r\n            transform.localRotation = Quaternion.Euler(_rotationX, transform.localEulerAngles.y, 0f);\r\n            transform.Rotate(Vector3.up * mouseX, Space.World);\r\n        }\r\n    }\r\n}\r\n```\r\n\r\n# Unity RTS相机1\r\n```csharp\r\nusing UnityEngine;\r\n\r\npublic class CameraController01 : MonoBehaviour\r\n{\r\n    private Vector3 moveInput;//接收键盘的输入量\r\n    [SerializeField] private float panSpeed;//相机平移的速度\r\n\r\n    [SerializeField] private float scrollSpeed;//鼠标滚动的速度\r\n\r\n    private void Update()\r\n    {\r\n        HandleMovementInput();\r\n    }\r\n\r\n    private void HandleMovementInput()\r\n    {\r\n        //我们其实动态改变的是Main Camera的Trans组件的Pos\r\n        Vector3 pos = transform.position;\r\n\r\n        //moveInput = new Vector3(Input.GetAxisRaw(\"Horizontal\"), 0, Input.GetAxisRaw(\"Vertical\"));//性能？\r\n        moveInput.Set(Input.GetAxisRaw(\"Horizontal\"), 0, Input.GetAxisRaw(\"Vertical\"));\r\n\r\n        Vector2 mousePos = Input.mousePosition;\r\n        if (mousePos.x > Screen.width * 0.9f && mousePos.x \u003C Screen.width)\r\n            moveInput.x = 1;\r\n        if (mousePos.x \u003C Screen.width * 0.1f && mousePos.x > 0)\r\n            moveInput.x = -1;\r\n        if (mousePos.y > Screen.height * 0.9 && mousePos.y \u003C Screen.height)\r\n            moveInput.z = 1;\r\n        if (mousePos.y \u003C Screen.height * 0.1 && mousePos.y > 0)\r\n            moveInput.z = -1;\r\n\r\n        //pos += moveInput * panSpeed * Time.deltaTime;//ERROR\r\n        //pos += moveInput.normalized * panSpeed * Time.deltaTime;//匀速运动，归一化/向量化\r\n\r\n        pos.x += moveInput.normalized.x * panSpeed * Time.deltaTime;\r\n        pos.y += Input.GetAxis(\"Mouse ScrollWheel\") * scrollSpeed * Time.deltaTime;//Y轴滚轮输入量\r\n        pos.z += moveInput.normalized.z * panSpeed * Time.deltaTime;\r\n\r\n        pos.x = Mathf.Clamp(pos.x, -10, 10);\r\n        pos.y = Mathf.Clamp(pos.y, 5, 30);\r\n        pos.z = Mathf.Clamp(pos.z, -25, 5);//根据自己的地图范围进行调整，可以设置为变量，方便嘛！\r\n\r\n        transform.position = pos;\r\n    }\r\n}\r\n```\r\n\r\n# Unity RTS相机2\r\n```csharp\r\nusing System;\r\nusing UnityEngine;\r\n\r\npublic class CameraController02 : MonoBehaviour\r\n{\r\n    private float panSpeed;\r\n    [SerializeField] private float moveTime;//缓冲时间，用于之后的Vector3.Lerp和Quaternion.Lerp方法/函数\r\n    [SerializeField] private float normalSpeed, fastSpeed;\r\n\r\n    private Vector3 newPos;\r\n    private Quaternion newRotation;\r\n    [SerializeField] private float rotationAmount;//旋转的程度\r\n\r\n    private Transform cameraTrans;//子物体嘛～主相机Trans，要改YZ数值\r\n    [SerializeField] private Vector3 zoomAmount;//要改YZ数值，设置zoomAmount结构体中YZ的数值\r\n    private Vector3 newZoom;\r\n\r\n    private Vector3 dragStartPos, dragCurrentPos;//鼠标拖拽的起始点，和鼠标拖拽的当前位置\r\n    private Vector3 rotateStart, rotateCurrent;//鼠标初始位置和当前位置，用来计算相机旋转角度\r\n\r\n    private void Start()\r\n    {\r\n        newPos = transform.position;\r\n        newRotation = transform.rotation;\r\n\r\n        cameraTrans = transform.GetChild(0);\r\n        newZoom = cameraTrans.localPosition;\r\n    }\r\n\r\n    private void Update()\r\n    {\r\n        HandleMovementInput();//通过键盘控制相机\r\n        HandleMouseInput();//通过鼠标控制相机\r\n    }\r\n\r\n    private void HandleMouseInput()\r\n    {\r\n        if(Input.GetMouseButtonDown(1))//鼠标按下一瞬间！\r\n        {\r\n            Plane plane = new Plane(Vector3.up, Vector3.zero);\r\n            Ray ray = Camera.main.ScreenPointToRay(Input.mousePosition);\r\n            float distance;\r\n            if(plane.Raycast(ray, out distance))//out输出参数，一般方法返回一个数值，out则返回return和out数值，2个结果\r\n            {\r\n                dragStartPos = ray.GetPoint(distance);\r\n            }\r\n        }\r\n\r\n        if (Input.GetMouseButton(1))//鼠标按着（当前）\r\n        {\r\n            Plane plane = new Plane(Vector3.up, Vector3.zero);\r\n            Ray ray = Camera.main.ScreenPointToRay(Input.mousePosition);\r\n            float distance;\r\n            if (plane.Raycast(ray, out distance))//out输出参数，一般方法返回一个数值，out则返回return和out数值，2个结果\r\n            {\r\n                dragCurrentPos = ray.GetPoint(distance);\r\n\r\n                Vector3 difference = dragStartPos - dragCurrentPos;//大家可以试试反过来写，效果雷同只是方向相反\r\n                newPos = transform.position + difference;\r\n            }\r\n        }\r\n\r\n        newZoom += Input.mouseScrollDelta.y * zoomAmount;\r\n\r\n        if (Input.GetMouseButtonDown(2))\r\n            rotateStart = Input.mousePosition;\r\n        if(Input.GetMouseButton(2))\r\n        {\r\n            rotateCurrent = Input.mousePosition;\r\n            Vector3 difference = rotateStart - rotateCurrent;\r\n\r\n            rotateStart = rotateCurrent;//赋值最新的鼠标位置\r\n            newRotation *= Quaternion.Euler(Vector3.up * -difference.x / 20);//水平方向触发旋转\r\n            //newRotation *= Quaternion.Euler(Vector3.up * -difference.y / 20);//垂直方向\r\n        }\r\n    }\r\n\r\n    private void HandleMovementInput()\r\n    {\r\n        if (Input.GetKey(KeyCode.LeftShift))\r\n            panSpeed = fastSpeed;\r\n        else\r\n            panSpeed = normalSpeed;\r\n\r\n        if (Input.GetKey(KeyCode.UpArrow) || Input.GetKey(KeyCode.W))\r\n            newPos += transform.forward * panSpeed * Time.deltaTime;//相机平移向上\r\n        if (Input.GetKey(KeyCode.DownArrow) || Input.GetKey(KeyCode.S))\r\n            newPos -= transform.forward * panSpeed * Time.deltaTime;\r\n        if (Input.GetKey(KeyCode.RightArrow) || Input.GetKey(KeyCode.D))\r\n            newPos += transform.right * panSpeed * Time.deltaTime;//相机平移向右\r\n        if(Input.GetKey(KeyCode.LeftArrow) || Input.GetKey(KeyCode.A))\r\n            newPos -= transform.right * panSpeed * Time.deltaTime;\r\n\r\n        if (Input.GetKey(KeyCode.Q))\r\n            newRotation *= Quaternion.Euler(Vector3.up * rotationAmount);//Q：逆时针\r\n        if (Input.GetKey(KeyCode.E))\r\n            newRotation *= Quaternion.Euler(Vector3.down * rotationAmount);//(0,-1,0)顺时针\r\n\r\n        if (Input.GetKey(KeyCode.R))\r\n            newZoom += zoomAmount;//放大功能：Y越来越小，Z越来越大\r\n        if (Input.GetKey(KeyCode.F))\r\n            newZoom -= zoomAmount;//缩小：Y越来越大，Z越来越小\r\n\r\n        //transform.position = newPos;//AxisRaw / Axis\r\n        //Lerp方法：当前位置，目标位置，最大距离：速度 * 时间 =>从当前位置，到目标位置，需要多少时间到达\r\n        transform.position = Vector3.Lerp(transform.position, newPos, moveTime * Time.deltaTime);\r\n\r\n        //transform.rotation = newRotation;\r\n        transform.rotation = Quaternion.Lerp(transform.rotation, newRotation, moveTime * Time.deltaTime);\r\n\r\n        cameraTrans.localPosition = Vector3.Lerp(cameraTrans.localPosition, newZoom, moveTime * Time.deltaTime);\r\n    }\r\n}\r\n```\r\n\r\nrts相机部分代码来自：\r\nhttps://github.com/zheyuanzhou/EP00_RTSCamera/tree/main","src/content/posts/unity_001.md","b902277b5ca97ce6",{"html":67,"metadata":68},"\u003Ch1 id=\"unity-自由相机\">Unity 自由相机\u003C/h1>\n\u003Ch3 id=\"操作方式\">操作方式\u003C/h3>\n\u003Cul>\n\u003Cli>WASD水平移动 (按住左SHIFT加速移动)\u003C/li>\n\u003Cli>QE垂直移动\u003C/li>\n\u003Cli>鼠标右键按下旋转视角\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"代码内容\">代码内容\u003C/h3>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"csharp\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">using\u003C/span>\u003Cspan style=\"color:#B392F0\"> UnityEngine\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">/// &#x3C;\u003C/span>\u003Cspan style=\"color:#85E89D\">summary\u003C/span>\u003Cspan style=\"color:#6A737D\">>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">/// 自由相机\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">/// &#x3C;/\u003C/span>\u003Cspan style=\"color:#85E89D\">summary\u003C/span>\u003Cspan style=\"color:#6A737D\">>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">public\u003C/span>\u003Cspan style=\"color:#F97583\"> class\u003C/span>\u003Cspan style=\"color:#B392F0\"> FreeCamera\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> : \u003C/span>\u003Cspan style=\"color:#B392F0\">MonoBehaviour\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#B392F0\">Tooltip\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"水平移动速度\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)] \u003C/span>\u003Cspan style=\"color:#F97583\">public\u003C/span>\u003Cspan style=\"color:#F97583\"> float\u003C/span>\u003Cspan style=\"color:#B392F0\"> horizontalSpeed\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 50f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">; \u003C/span>\u003Cspan style=\"color:#6A737D\">//水平移动速度\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#B392F0\">Tooltip\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"垂直移动速度\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)] \u003C/span>\u003Cspan style=\"color:#F97583\">public\u003C/span>\u003Cspan style=\"color:#F97583\"> float\u003C/span>\u003Cspan style=\"color:#B392F0\"> verticalSpeed\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 10f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">; \u003C/span>\u003Cspan style=\"color:#6A737D\">//垂直移动速度\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#B392F0\">Tooltip\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"鼠标旋转速度\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)] \u003C/span>\u003Cspan style=\"color:#F97583\">public\u003C/span>\u003Cspan style=\"color:#F97583\"> float\u003C/span>\u003Cspan style=\"color:#B392F0\"> rotationSpeed\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 2f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">; \u003C/span>\u003Cspan style=\"color:#6A737D\">//旋转速度\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> float\u003C/span>\u003Cspan style=\"color:#B392F0\"> _rotationX\u003C/span>\u003Cspan style=\"color:#E1E4E8\">; \u003C/span>\u003Cspan style=\"color:#6A737D\">//上下旋转角度\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    public\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> Update\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        HandleMove\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        HandleRotate\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    /// &#x3C;\u003C/span>\u003Cspan style=\"color:#85E89D\">summary\u003C/span>\u003Cspan style=\"color:#6A737D\">>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    /// 相机移动\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    /// &#x3C;/\u003C/span>\u003Cspan style=\"color:#85E89D\">summary\u003C/span>\u003Cspan style=\"color:#6A737D\">>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> HandleMove\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        //视角平行移动\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        var\u003C/span>\u003Cspan style=\"color:#B392F0\"> horizontal\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetAxis\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Horizontal\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        var\u003C/span>\u003Cspan style=\"color:#B392F0\"> vertical\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetAxis\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Vertical\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        var\u003C/span>\u003Cspan style=\"color:#B392F0\"> direction\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> horizontalSpeed \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Time.deltaTime \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#F97583\"> new\u003C/span>\u003Cspan style=\"color:#B392F0\"> Vector3\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(horizontal, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, vertical);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(KeyCode.LeftShift))  \u003C/span>\u003Cspan style=\"color:#6A737D\">//按Shift移动加速\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            direction \u003C/span>\u003Cspan style=\"color:#F97583\">*=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 3\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        transform.\u003C/span>\u003Cspan style=\"color:#B392F0\">Translate\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(direction);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        //  控制摄像机垂直移动\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(KeyCode.Q))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            transform.position \u003C/span>\u003Cspan style=\"color:#F97583\">+=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> transform.up \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (verticalSpeed \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Time.deltaTime);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        else\u003C/span>\u003Cspan style=\"color:#F97583\"> if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(KeyCode.E))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            transform.position \u003C/span>\u003Cspan style=\"color:#F97583\">-=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> transform.up \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (verticalSpeed \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Time.deltaTime);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    /// &#x3C;\u003C/span>\u003Cspan style=\"color:#85E89D\">summary\u003C/span>\u003Cspan style=\"color:#6A737D\">>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    /// 视角旋转\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    /// &#x3C;/\u003C/span>\u003Cspan style=\"color:#85E89D\">summary\u003C/span>\u003Cspan style=\"color:#6A737D\">>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> HandleRotate\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetMouseButton\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            var\u003C/span>\u003Cspan style=\"color:#B392F0\"> mouseX\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetAxis\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Mouse X\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> rotationSpeed;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            var\u003C/span>\u003Cspan style=\"color:#B392F0\"> mouseY\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetAxis\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Mouse Y\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> rotationSpeed;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            _rotationX \u003C/span>\u003Cspan style=\"color:#F97583\">-=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> mouseY;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            _rotationX \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Mathf.\u003C/span>\u003Cspan style=\"color:#B392F0\">Clamp\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(_rotationX, \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#79B8FF\">90\u003C/span>\u003Cspan style=\"color:#E1E4E8\">， \u003C/span>\u003Cspan style=\"color:#79B8FF\">90\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            transform.localRotation \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Quaternion.\u003C/span>\u003Cspan style=\"color:#B392F0\">Euler\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(_rotationX, transform.localEulerAngles.y, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            transform.\u003C/span>\u003Cspan style=\"color:#B392F0\">Rotate\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(Vector3.up \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> mouseX, Space.World);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch1 id=\"unity-rts相机1\">Unity RTS相机1\u003C/h1>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"csharp\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">using\u003C/span>\u003Cspan style=\"color:#B392F0\"> UnityEngine\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">public\u003C/span>\u003Cspan style=\"color:#F97583\"> class\u003C/span>\u003Cspan style=\"color:#B392F0\"> CameraController01\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> : \u003C/span>\u003Cspan style=\"color:#B392F0\">MonoBehaviour\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#B392F0\"> Vector3\u003C/span>\u003Cspan style=\"color:#B392F0\"> moveInput\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003Cspan style=\"color:#6A737D\">//接收键盘的输入量\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#B392F0\">SerializeField\u003C/span>\u003Cspan style=\"color:#E1E4E8\">] \u003C/span>\u003Cspan style=\"color:#F97583\">private\u003C/span>\u003Cspan style=\"color:#F97583\"> float\u003C/span>\u003Cspan style=\"color:#B392F0\"> panSpeed\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003Cspan style=\"color:#6A737D\">//相机平移的速度\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#B392F0\">SerializeField\u003C/span>\u003Cspan style=\"color:#E1E4E8\">] \u003C/span>\u003Cspan style=\"color:#F97583\">private\u003C/span>\u003Cspan style=\"color:#F97583\"> float\u003C/span>\u003Cspan style=\"color:#B392F0\"> scrollSpeed\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003Cspan style=\"color:#6A737D\">//鼠标滚动的速度\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> Update\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        HandleMovementInput\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> HandleMovementInput\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        //我们其实动态改变的是Main Camera的Trans组件的Pos\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        Vector3\u003C/span>\u003Cspan style=\"color:#B392F0\"> pos\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> transform.position;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        //moveInput = new Vector3(Input.GetAxisRaw(\"Horizontal\"), 0, Input.GetAxisRaw(\"Vertical\"));//性能？\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        moveInput.\u003C/span>\u003Cspan style=\"color:#B392F0\">Set\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetAxisRaw\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Horizontal\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">), \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetAxisRaw\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Vertical\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        Vector2\u003C/span>\u003Cspan style=\"color:#B392F0\"> mousePos\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Input.mousePosition;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (mousePos.x \u003C/span>\u003Cspan style=\"color:#F97583\">>\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Screen.width \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0.9f\u003C/span>\u003Cspan style=\"color:#F97583\"> &#x26;&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> mousePos.x \u003C/span>\u003Cspan style=\"color:#F97583\">&#x3C;\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Screen.width)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            moveInput.x \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (mousePos.x \u003C/span>\u003Cspan style=\"color:#F97583\">&#x3C;\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Screen.width \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0.1f\u003C/span>\u003Cspan style=\"color:#F97583\"> &#x26;&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> mousePos.x \u003C/span>\u003Cspan style=\"color:#F97583\">>\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            moveInput.x \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> -\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (mousePos.y \u003C/span>\u003Cspan style=\"color:#F97583\">>\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Screen.height \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0.9\u003C/span>\u003Cspan style=\"color:#F97583\"> &#x26;&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> mousePos.y \u003C/span>\u003Cspan style=\"color:#F97583\">&#x3C;\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Screen.height)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            moveInput.z \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (mousePos.y \u003C/span>\u003Cspan style=\"color:#F97583\">&#x3C;\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Screen.height \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0.1\u003C/span>\u003Cspan style=\"color:#F97583\"> &#x26;&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> mousePos.y \u003C/span>\u003Cspan style=\"color:#F97583\">>\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            moveInput.z \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> -\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        //pos += moveInput * panSpeed * Time.deltaTime;//ERROR\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        //pos += moveInput.normalized * panSpeed * Time.deltaTime;//匀速运动，归一化/向量化\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        pos.x \u003C/span>\u003Cspan style=\"color:#F97583\">+=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> moveInput.normalized.x \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> panSpeed \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Time.deltaTime;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        pos.y \u003C/span>\u003Cspan style=\"color:#F97583\">+=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetAxis\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Mouse ScrollWheel\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> scrollSpeed \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Time.deltaTime;\u003C/span>\u003Cspan style=\"color:#6A737D\">//Y轴滚轮输入量\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        pos.z \u003C/span>\u003Cspan style=\"color:#F97583\">+=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> moveInput.normalized.z \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> panSpeed \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Time.deltaTime;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        pos.x \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Mathf.\u003C/span>\u003Cspan style=\"color:#B392F0\">Clamp\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pos.x, \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#79B8FF\">10\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">10\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        pos.y \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Mathf.\u003C/span>\u003Cspan style=\"color:#B392F0\">Clamp\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pos.y, \u003C/span>\u003Cspan style=\"color:#79B8FF\">5\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">30\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        pos.z \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Mathf.\u003C/span>\u003Cspan style=\"color:#B392F0\">Clamp\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pos.z, \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#79B8FF\">25\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">5\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003Cspan style=\"color:#6A737D\">//根据自己的地图范围进行调整，可以设置为变量，方便嘛！\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        transform.position \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> pos;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch1 id=\"unity-rts相机2\">Unity RTS相机2\u003C/h1>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"csharp\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">using\u003C/span>\u003Cspan style=\"color:#B392F0\"> System\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">using\u003C/span>\u003Cspan style=\"color:#B392F0\"> UnityEngine\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">public\u003C/span>\u003Cspan style=\"color:#F97583\"> class\u003C/span>\u003Cspan style=\"color:#B392F0\"> CameraController02\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> : \u003C/span>\u003Cspan style=\"color:#B392F0\">MonoBehaviour\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> float\u003C/span>\u003Cspan style=\"color:#B392F0\"> panSpeed\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#B392F0\">SerializeField\u003C/span>\u003Cspan style=\"color:#E1E4E8\">] \u003C/span>\u003Cspan style=\"color:#F97583\">private\u003C/span>\u003Cspan style=\"color:#F97583\"> float\u003C/span>\u003Cspan style=\"color:#B392F0\"> moveTime\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003Cspan style=\"color:#6A737D\">//缓冲时间，用于之后的Vector3.Lerp和Quaternion.Lerp方法/函数\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#B392F0\">SerializeField\u003C/span>\u003Cspan style=\"color:#E1E4E8\">] \u003C/span>\u003Cspan style=\"color:#F97583\">private\u003C/span>\u003Cspan style=\"color:#F97583\"> float\u003C/span>\u003Cspan style=\"color:#B392F0\"> normalSpeed\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">fastSpeed\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#B392F0\"> Vector3\u003C/span>\u003Cspan style=\"color:#B392F0\"> newPos\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#B392F0\"> Quaternion\u003C/span>\u003Cspan style=\"color:#B392F0\"> newRotation\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#B392F0\">SerializeField\u003C/span>\u003Cspan style=\"color:#E1E4E8\">] \u003C/span>\u003Cspan style=\"color:#F97583\">private\u003C/span>\u003Cspan style=\"color:#F97583\"> float\u003C/span>\u003Cspan style=\"color:#B392F0\"> rotationAmount\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003Cspan style=\"color:#6A737D\">//旋转的程度\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#B392F0\"> Transform\u003C/span>\u003Cspan style=\"color:#B392F0\"> cameraTrans\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003Cspan style=\"color:#6A737D\">//子物体嘛～主相机Trans，要改YZ数值\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#B392F0\">SerializeField\u003C/span>\u003Cspan style=\"color:#E1E4E8\">] \u003C/span>\u003Cspan style=\"color:#F97583\">private\u003C/span>\u003Cspan style=\"color:#B392F0\"> Vector3\u003C/span>\u003Cspan style=\"color:#B392F0\"> zoomAmount\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003Cspan style=\"color:#6A737D\">//要改YZ数值，设置zoomAmount结构体中YZ的数值\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#B392F0\"> Vector3\u003C/span>\u003Cspan style=\"color:#B392F0\"> newZoom\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#B392F0\"> Vector3\u003C/span>\u003Cspan style=\"color:#B392F0\"> dragStartPos\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">dragCurrentPos\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003Cspan style=\"color:#6A737D\">//鼠标拖拽的起始点，和鼠标拖拽的当前位置\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#B392F0\"> Vector3\u003C/span>\u003Cspan style=\"color:#B392F0\"> rotateStart\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">rotateCurrent\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003Cspan style=\"color:#6A737D\">//鼠标初始位置和当前位置，用来计算相机旋转角度\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> Start\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        newPos \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> transform.position;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        newRotation \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> transform.rotation;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        cameraTrans \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> transform.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetChild\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        newZoom \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> cameraTrans.localPosition;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> Update\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        HandleMovementInput\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003Cspan style=\"color:#6A737D\">//通过键盘控制相机\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        HandleMouseInput\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003Cspan style=\"color:#6A737D\">//通过鼠标控制相机\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> HandleMouseInput\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetMouseButtonDown\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">))\u003C/span>\u003Cspan style=\"color:#6A737D\">//鼠标按下一瞬间！\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            Plane\u003C/span>\u003Cspan style=\"color:#B392F0\"> plane\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#F97583\"> new\u003C/span>\u003Cspan style=\"color:#B392F0\"> Plane\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(Vector3.up, Vector3.zero);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            Ray\u003C/span>\u003Cspan style=\"color:#B392F0\"> ray\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Camera.main.\u003C/span>\u003Cspan style=\"color:#B392F0\">ScreenPointToRay\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(Input.mousePosition);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            float\u003C/span>\u003Cspan style=\"color:#B392F0\"> distance\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            if\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(plane.\u003C/span>\u003Cspan style=\"color:#B392F0\">Raycast\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(ray, \u003C/span>\u003Cspan style=\"color:#F97583\">out\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> distance))\u003C/span>\u003Cspan style=\"color:#6A737D\">//out输出参数，一般方法返回一个数值，out则返回return和out数值，2个结果\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                dragStartPos \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ray.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetPoint\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(distance);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetMouseButton\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">))\u003C/span>\u003Cspan style=\"color:#6A737D\">//鼠标按着（当前）\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            Plane\u003C/span>\u003Cspan style=\"color:#B392F0\"> plane\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#F97583\"> new\u003C/span>\u003Cspan style=\"color:#B392F0\"> Plane\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(Vector3.up, Vector3.zero);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            Ray\u003C/span>\u003Cspan style=\"color:#B392F0\"> ray\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Camera.main.\u003C/span>\u003Cspan style=\"color:#B392F0\">ScreenPointToRay\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(Input.mousePosition);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            float\u003C/span>\u003Cspan style=\"color:#B392F0\"> distance\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (plane.\u003C/span>\u003Cspan style=\"color:#B392F0\">Raycast\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(ray, \u003C/span>\u003Cspan style=\"color:#F97583\">out\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> distance))\u003C/span>\u003Cspan style=\"color:#6A737D\">//out输出参数，一般方法返回一个数值，out则返回return和out数值，2个结果\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                dragCurrentPos \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ray.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetPoint\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(distance);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                Vector3\u003C/span>\u003Cspan style=\"color:#B392F0\"> difference\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> dragStartPos \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> dragCurrentPos;\u003C/span>\u003Cspan style=\"color:#6A737D\">//大家可以试试反过来写，效果雷同只是方向相反\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                newPos \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> transform.position \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> difference;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        newZoom \u003C/span>\u003Cspan style=\"color:#F97583\">+=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Input.mouseScrollDelta.y \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> zoomAmount;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetMouseButtonDown\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            rotateStart \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Input.mousePosition;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetMouseButton\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            rotateCurrent \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Input.mousePosition;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            Vector3\u003C/span>\u003Cspan style=\"color:#B392F0\"> difference\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> rotateStart \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> rotateCurrent;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            rotateStart \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> rotateCurrent;\u003C/span>\u003Cspan style=\"color:#6A737D\">//赋值最新的鼠标位置\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            newRotation \u003C/span>\u003Cspan style=\"color:#F97583\">*=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Quaternion.\u003C/span>\u003Cspan style=\"color:#B392F0\">Euler\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(Vector3.up \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#F97583\"> -\u003C/span>\u003Cspan style=\"color:#E1E4E8\">difference.x \u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 20\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003Cspan style=\"color:#6A737D\">//水平方向触发旋转\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            //newRotation *= Quaternion.Euler(Vector3.up * -difference.y / 20);//垂直方向\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> HandleMovementInput\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(KeyCode.LeftShift))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            panSpeed \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> fastSpeed;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        else\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            panSpeed \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> normalSpeed;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(KeyCode.UpArrow) \u003C/span>\u003Cspan style=\"color:#F97583\">||\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(KeyCode.W))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            newPos \u003C/span>\u003Cspan style=\"color:#F97583\">+=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> transform.forward \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> panSpeed \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Time.deltaTime;\u003C/span>\u003Cspan style=\"color:#6A737D\">//相机平移向上\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(KeyCode.DownArrow) \u003C/span>\u003Cspan style=\"color:#F97583\">||\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(KeyCode.S))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            newPos \u003C/span>\u003Cspan style=\"color:#F97583\">-=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> transform.forward \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> panSpeed \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Time.deltaTime;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(KeyCode.RightArrow) \u003C/span>\u003Cspan style=\"color:#F97583\">||\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(KeyCode.D))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            newPos \u003C/span>\u003Cspan style=\"color:#F97583\">+=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> transform.right \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> panSpeed \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Time.deltaTime;\u003C/span>\u003Cspan style=\"color:#6A737D\">//相机平移向右\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(KeyCode.LeftArrow) \u003C/span>\u003Cspan style=\"color:#F97583\">||\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(KeyCode.A))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            newPos \u003C/span>\u003Cspan style=\"color:#F97583\">-=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> transform.right \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> panSpeed \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Time.deltaTime;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(KeyCode.Q))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            newRotation \u003C/span>\u003Cspan style=\"color:#F97583\">*=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Quaternion.\u003C/span>\u003Cspan style=\"color:#B392F0\">Euler\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(Vector3.up \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> rotationAmount);\u003C/span>\u003Cspan style=\"color:#6A737D\">//Q：逆时针\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(KeyCode.E))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            newRotation \u003C/span>\u003Cspan style=\"color:#F97583\">*=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Quaternion.\u003C/span>\u003Cspan style=\"color:#B392F0\">Euler\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(Vector3.down \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> rotationAmount);\u003C/span>\u003Cspan style=\"color:#6A737D\">//(0,-1,0)顺时针\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(KeyCode.R))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            newZoom \u003C/span>\u003Cspan style=\"color:#F97583\">+=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> zoomAmount;\u003C/span>\u003Cspan style=\"color:#6A737D\">//放大功能：Y越来越小，Z越来越大\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(KeyCode.F))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            newZoom \u003C/span>\u003Cspan style=\"color:#F97583\">-=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> zoomAmount;\u003C/span>\u003Cspan style=\"color:#6A737D\">//缩小：Y越来越大，Z越来越小\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        //transform.position = newPos;//AxisRaw / Axis\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        //Lerp方法：当前位置，目标位置，最大距离：速度 * 时间 =>从当前位置，到目标位置，需要多少时间到达\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        transform.position \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Vector3.\u003C/span>\u003Cspan style=\"color:#B392F0\">Lerp\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(transform.position, newPos, moveTime \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Time.deltaTime);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        //transform.rotation = newRotation;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        transform.rotation \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Quaternion.\u003C/span>\u003Cspan style=\"color:#B392F0\">Lerp\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(transform.rotation, newRotation, moveTime \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Time.deltaTime);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        cameraTrans.localPosition \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Vector3.\u003C/span>\u003Cspan style=\"color:#B392F0\">Lerp\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(cameraTrans.localPosition, newZoom, moveTime \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Time.deltaTime);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>rts相机部分代码来自：\r\n\u003Ca href=\"https://github.com/zheyuanzhou/EP00_RTSCamera/tree/main\">https://github.com/zheyuanzhou/EP00_RTSCamera/tree/main\u003C/a>\u003C/p>",{"headings":69,"localImagePaths":83,"remoteImagePaths":84,"frontmatter":62,"imagePaths":85},[70,73,75,77,80],{"depth":20,"slug":71,"text":72},"unity-自由相机","Unity 自由相机",{"depth":44,"slug":74,"text":74},"操作方式",{"depth":44,"slug":76,"text":76},"代码内容",{"depth":20,"slug":78,"text":79},"unity-rts相机1","Unity RTS相机1",{"depth":20,"slug":81,"text":82},"unity-rts相机2","Unity RTS相机2",[],[],[],"unity_001.md","post_20251226070813",{"id":87,"data":89,"body":90,"filePath":91,"digest":92,"rendered":93,"legacyId":148},{},"# Unity 无人机物理模拟开发日志：从零打造穿越机手感\n\n> **摘要**：本文记录了在 Unity 中构建一个高拟真 FPV 穿越机（Drone）物理模拟系统的过程。从基础的 PID 控制到引入空气动力学阻力、地面效应和电机惯性，一步步逼近真实的飞行手感。\n\n---\n环境：`Unity 2022.3.57c1f1` `Window10`  \n\n\n![cad859e8da0f4a42b86025f0b7122778.png](/uploads/images/1766733359777-825864655.png)\n\n\n### 开源仓库地址\n[Unity引擎开发的无人机模拟系统](https://gitee.com/youlai-code/unity-drone.git)\n### 演示视频：  \n[Unity无人机仿真-bilbil](https://www.bilibili.com/video/BV1Y8BVB9Edu/?share_source=copy_web&vd_source=996906670f4a2574b3c77132cb5ebda3)\n\u003Ciframe src=\"//player.bilibili.com/player.html?isOutside=true&aid=115772286377550&bvid=BV1Y8BVB9Edu&cid=34941700066&p=1\" scrolling=\"no\" border=\"0\" frameborder=\"no\" framespacing=\"0\" allowfullscreen=\"true\">\u003C/iframe>\n\n---\n# 功能介绍\n##  输入系统\n\n最初的实现使用键盘鼠标控制，但这对于模拟穿越机来说完全不够。真实的穿越机需要细腻的模拟量输入。\n\n\n![Gemini_Generated_Image_gczo5ggczo5ggczo.jpg](/uploads/images/1766732941939-2276967.jpg)\n\n\n---\n\n## 核心物理引擎\n\nUnity 的 `Rigidbody` 提供了基础物理，但要飞得像穿越机，必须手动计算力和力矩。\n\n### PID 控制器 (Rate Loop)\n这是飞控的灵魂。我们实现了三个独立的 PID 控制器分别控制 Pitch、Roll 和 Yaw 的**角速度**。\n**PID**的介绍请看我的另外一篇文档：  [PID算法](https://blog.csdn.net/wa36d/article/details/145108722?spm=1001.2014.3001.5502)\n*   **目标**：摇杆输入 = 目标角速度（例如满杆 200度/秒）。\n*   **反馈**：`rb.angularVelocity`。\n*   **输出**：PID 计算出的修正力矩。\n\n### 混控器 (Mixer)\n将 PID 输出分配到四个电机。采用标准的 **Quad X** 布局：\n\n\n\n![d09f547e541e4fbeaf68b5022ca118d2.png](/uploads/images/1766734335095-585963069.png)\n\n```csharp\n// FL (左前): +Pitch +Roll -Yaw\n// FR (右前): +Pitch -Roll +Yaw\n// BL (左后): -Pitch +Roll +Yaw\n// BR (右后): -Pitch -Roll -Yaw\n```\n---\n\n## 物理细节的打磨\n\n基础 PID 能飞，但手感像“在真空中飞行”或者“完美的刚体”。为了真实感，我引入了三个关键特性：\n\n### 电机惯性 (Motor Inertia)\n真实的电机从 0 加速到 100% 需要时间。\n*   **实现**：使用 `Mathf.Lerp` 对油门输入进行低通滤波。\n*   **效果**：消除了“瞬移般”的响应，给油门带来了一丝“肉”感和延迟，极大提升了重量感。\n```csharp\n    // 更新动力 (在 FlightController 的 FixedUpdate 中调用)\n    public void UpdatePhysics(float targetThrottle)\n    {\n        // 模拟电机惯性 (一阶低通滤波)\n        // 从当前油门平滑过渡到目标油门\n        float dt = Time.fixedDeltaTime;\n        currentThrottle = Mathf.Lerp(currentThrottle, targetThrottle, dt * motorResponseSpeed);\n\n        // 1. 施加升力 (垂直于机臂向上)\n        Vector3 force = transform.up * (currentThrottle * maxThrust);\n        rb.AddForceAtPosition(force, transform.position);\n\n        // 2. 施加反扭矩 (Yaw控制)\n        // 顺时针旋转的电机，会给机身施加逆时针的扭矩，反之亦然\n        float torqueDir = isClockwise ? -1f : 1f;\n        float torqueMagnitude = currentThrottle * maxThrust * torqueFactor * torqueDir;\n        rb.AddTorque(transform.up * torqueMagnitude, ForceMode.Force);\n    }\n```\n### 地面效应 (Ground Effect)\n当无人机贴近地面时，下洗气流受阻，升力会增加。\n*   **实现**：向下发射射线检测高度。高度 \u003C 0.5m 时，根据距离非线性增加升力系数。\n*   **效果**：降落时会有明显的“气垫感”，不会直接“砸”向地面，起飞也更轻盈。\n```csharp\n            // --- 地面效应 (Ground Effect) ---\n            RaycastHit hit;\n            if (Physics.Raycast(transform.position, Vector3.down, out hit, groundEffectMaxHeight))\n            {\n                float ratio = 1.0f - (hit.distance / groundEffectMaxHeight);\n                float groundEffectMultiplier = 1.0f + (ratio * groundEffectLiftFactor);\n                \n                m1 *= groundEffectMultiplier;\n                m2 *= groundEffectMultiplier;\n                m3 *= groundEffectMultiplier;\n                m4 *= groundEffectMultiplier;\n            }\n```\n### 非线性空气阻力 (Quadratic Drag)\nUnity 默认的 `Drag` 是线性的 ($F \\propto v$)，这让无人机感觉像在水里游。\n*   **实现**：手动计算平方阻力 $F = -v \\cdot |v| \\cdot k$。\n*   **差异化阻力**：\n    *   **垂直方向**：机身扁平，阻力系数大 (1.0)。下落会有明显的终端速度。\n    *   **水平方向**：机身流线，阻力系数小 (0.2)。允许长距离惯性滑行。\n*   **效果**：这是手感提升最明显的一步。前飞松杆后的滑行感，以及高空下落时的速度平衡，都非常接近真机。\n```csharp\n        // 计算平方阻力: F = -v * |v| * dragFactor\n        Vector3 dragForceLocal = Vector3.zero;\n        dragForceLocal.x = -localVel.x * Mathf.Abs(localVel.x) * dragFactors.x;\n        dragForceLocal.y = -localVel.y * Mathf.Abs(localVel.y) * dragFactors.y; // 垂直阻力通常较大\n        dragForceLocal.z = -localVel.z * Mathf.Abs(localVel.z) * dragFactors.z;\n```\n---\n\n## 飞行模式\n\n无人机操作一共配置了两种模式\n### Acro Mode (手动模式)\n*   **逻辑**：摇杆控制**角速度**。松杆后无人机保持当前姿态。\n### Angle Mode (自稳模式)\n*   **逻辑**：**双环 PID 控制**。\n    *   **外环**：摇杆控制**角度** (例如满杆 45 度)。计算出目标角速度。\n    *   **内环**：执行目标角速度。\n*   **特性**：松杆自动回平。\n```csharp\n       if (mode == FlightMode.Angle)\n        {\n            // --- Angle Mode (自稳模式) ---\n            // 摇杆输入映射为目标角度 (-45 ~ 45 度)\n            float targetPitchAngle = input.Pitch * maxTiltAngle;\n            float targetRollAngle = -input.Roll * maxTiltAngle; // Unity Z轴旋转方向可能需要反转\n\n            // 获取当前角度 (将 0-360 转换为 +/- 180)\n            Vector3 currentEuler = transform.localEulerAngles;\n            float currentPitch = Mathf.DeltaAngle(0, currentEuler.x);\n            float currentRoll = Mathf.DeltaAngle(0, currentEuler.z);\n\n            // 外环 P 控制: 角度误差 -> 目标角速度\n            // Pitch: 目标 - 当前 (因为后面混控器 Pitch 反转了，所以这里保持 目标-当前)\n            targetPitchRate = (targetPitchAngle - currentPitch) * angleKP;\n            \n            // Roll: 当前 - 目标 (反转逻辑，防止正反馈翻滚)\n            // 右滚是负角度，如果不反转，误差为正，导致继续右滚\n            targetRollRate = (currentRoll - targetRollAngle) * angleKP;\n            \n            // Yaw 轴通常保持 Rate 模式\n            targetYawRate = input.Yaw * 150f;\n        }\n        else\n        {\n            // --- Acro Mode (特技/手动模式) ---\n            // 摇杆输入直接映射为目标角速度 (-200 ~ 200 度/秒)\n            targetPitchRate = input.Pitch * 200f;\n            targetRollRate = input.Roll * 200f;\n            targetYawRate = input.Yaw * 150f;\n        }\n```\n---\n\n## 稳定性与体验优化\n\n除了核心物理，还有很多细节决定了模拟器的可用性：\n\n*   **怠速保护 (Idle Protection)**：\n    *   问题：地面待机时，PID 积分项累积导致无人机“抽搐”或乱跳。\n    *   解决：油门 \u003C 5% 时，强制关闭电机并 **Reset PID**。\n```csharp\n        // --- 怠速保护逻辑 ---\n        if (throttleBase \u003C 0.05f)\n        {\n            m1 = m2 = m3 = m4 = 0f;\n            pitchPID.Reset();\n            rollPID.Reset();\n            yawPID.Reset();\n        }\n```\n*   **PID 限幅 (Authority Limit)**：\n    *   限制 PID 对电机的最大控制权 (例如 30%)，防止极端情况下 PID 输出过大导致电机饱和甚至侧翻。\n   ```csharp\n            // --- PID 限幅保护 ---\n            float pOut = Mathf.Clamp(pitchCorrection * correctionScale, -maxPIDAuthority, maxPIDAuthority);\n            float rOut = Mathf.Clamp(rollCorrection * correctionScale, -maxPIDAuthority, maxPIDAuthority);\n            float yOut = Mathf.Clamp(yawCorrection * correctionScale, -maxPIDAuthority, maxPIDAuthority); \n   ```\n*   **一键重置**：\n    *   添加手柄 **Y 键** 复位功能，炸机后瞬间回到原点并清空物理速度，方便反复练习。\n\n---\n# 二、源码\n## 代码结构\n代码结构比较简单，一共就4个代码就实现了整个无人机模拟，以下是流程图：\n\n![Gemini_Generated_Image_v4l1irv4l1irv4l1.jpg](/uploads/images/1766732962738-221925025.jpg)\n\n| 架构分层   | 核心脚本              | 角色定位         | 主要功能与逻辑                                                                                                                                                                                | 数据流向 / 物理作用                                                            |\n| ---------- | --------------------- | ---------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------ |\n| **输入层** | `DroneInput.cs`       | **信号预处理**   | 1. **读取硬件**：接收物理手柄输入。\u003Cbr> 2. **数据清洗**：处理摇杆死区、应用映射曲线。                                                                                                             | **输出**：标准化控制信号\u003Cbr>• 油门 (Throttle): `0 ~ 1` \u003Cbr>•俯仰/横滚/偏航: `-1 ~ 1`   |\n| **控制层** | `FlightController.cs` | **大脑 (Brain)** | 1. **模式处理**：根据 Angle/Acro 模式将输入转为目标角速度。\u003Cbr>2. **PID 调度**：调用 `PID.cs` 计算误差。\u003Cbr> 3. **混控 (Mixer)**：混合主油门与 PID 修正值。\u003Cbr>  4. **环境模拟**：计算非线性阻力与地面效应。 | **输入**：标准化信号 + 刚体物理状态\u003Cbr>**输出**：4 个电机的最终目标油门            |\n| **算法层** | `PID.cs`              | **纯数学计算**   | 1. **误差计算**：对比目标值与当前值。\u003Cbr>2. **修正输出**：计算比例(P)+积分(I)+微分(D)的总和。                                                                                                     | **输入**：目标值、当前值、时间差 (dt)\u003Cbr>**输出**：PID 修正值                      |\n| **执行层** | `MotorEngine.cs`      | **四肢 (Limbs)** | 1. **惯性模拟**：通过低通滤波模拟电机响应延迟。\u003Cbr>2. **物理交互**：将油门值转换为具体的物理力。                                                                                                  | **输入**：目标油门值\u003Cbr>**作用**：向 Rigidbody 施加\u003Cbr>• 推力 (Force)\u003Cbr>• 反扭矩 (Torque) |\n\n# 总结\n\n通过以上步骤，我们从一个简单的刚体运动，进化到了一个具备空气动力学特性的飞行模拟器。目前的物理手感已经能传达出穿越机的“惯性”和“风阻”。\n\n如果能帮助到你！可以给我来个点赞吗？ 谢谢！u😘","src/content/posts/post_20251226070813.md","f091314540f4b01d",{"html":94,"metadata":95},"\u003Ch1 id=\"unity-无人机物理模拟开发日志从零打造穿越机手感\">Unity 无人机物理模拟开发日志：从零打造穿越机手感\u003C/h1>\n\u003Cblockquote>\n\u003Cp>\u003Cstrong>摘要\u003C/strong>：本文记录了在 Unity 中构建一个高拟真 FPV 穿越机（Drone）物理模拟系统的过程。从基础的 PID 控制到引入空气动力学阻力、地面效应和电机惯性，一步步逼近真实的飞行手感。\u003C/p>\n\u003C/blockquote>\n\u003Chr>\n\u003Cp>环境：\u003Ccode>Unity 2022.3.57c1f1\u003C/code> \u003Ccode>Window10\u003C/code>\u003C/p>\n\u003Cp>\u003Cimg src=\"/uploads/images/1766733359777-825864655.png\" alt=\"cad859e8da0f4a42b86025f0b7122778.png\">\u003C/p>\n\u003Ch3 id=\"开源仓库地址\">开源仓库地址\u003C/h3>\n\u003Cp>\u003Ca href=\"https://gitee.com/youlai-code/unity-drone.git\">Unity引擎开发的无人机模拟系统\u003C/a>\u003C/p>\n\u003Ch3 id=\"演示视频\">演示视频：\u003C/h3>\n\u003Cp>\u003Ca href=\"https://www.bilibili.com/video/BV1Y8BVB9Edu/?share_source=copy_web&#x26;vd_source=996906670f4a2574b3c77132cb5ebda3\">Unity无人机仿真-bilbil\u003C/a>\u003C/p>\n\u003Ciframe src=\"//player.bilibili.com/player.html?isOutside=true&#x26;aid=115772286377550&#x26;bvid=BV1Y8BVB9Edu&#x26;cid=34941700066&#x26;p=1\" scrolling=\"no\" border=\"0\" frameborder=\"no\" framespacing=\"0\" allowfullscreen=\"true\">\u003C/iframe>\n\u003Chr>\n\u003Ch1 id=\"功能介绍\">功能介绍\u003C/h1>\n\u003Ch2 id=\"输入系统\">输入系统\u003C/h2>\n\u003Cp>最初的实现使用键盘鼠标控制，但这对于模拟穿越机来说完全不够。真实的穿越机需要细腻的模拟量输入。\u003C/p>\n\u003Cp>\u003Cimg src=\"/uploads/images/1766732941939-2276967.jpg\" alt=\"Gemini_Generated_Image_gczo5ggczo5ggczo.jpg\">\u003C/p>\n\u003Chr>\n\u003Ch2 id=\"核心物理引擎\">核心物理引擎\u003C/h2>\n\u003Cp>Unity 的 \u003Ccode>Rigidbody\u003C/code> 提供了基础物理，但要飞得像穿越机，必须手动计算力和力矩。\u003C/p>\n\u003Ch3 id=\"pid-控制器-rate-loop\">PID 控制器 (Rate Loop)\u003C/h3>\n\u003Cp>这是飞控的灵魂。我们实现了三个独立的 PID 控制器分别控制 Pitch、Roll 和 Yaw 的\u003Cstrong>角速度\u003C/strong>。\n\u003Cstrong>PID\u003C/strong>的介绍请看我的另外一篇文档：  \u003Ca href=\"https://blog.csdn.net/wa36d/article/details/145108722?spm=1001.2014.3001.5502\">PID算法\u003C/a>\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cstrong>目标\u003C/strong>：摇杆输入 = 目标角速度（例如满杆 200度/秒）。\u003C/li>\n\u003Cli>\u003Cstrong>反馈\u003C/strong>：\u003Ccode>rb.angularVelocity\u003C/code>。\u003C/li>\n\u003Cli>\u003Cstrong>输出\u003C/strong>：PID 计算出的修正力矩。\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"混控器-mixer\">混控器 (Mixer)\u003C/h3>\n\u003Cp>将 PID 输出分配到四个电机。采用标准的 \u003Cstrong>Quad X\u003C/strong> 布局：\u003C/p>\n\u003Cp>\u003Cimg src=\"/uploads/images/1766734335095-585963069.png\" alt=\"d09f547e541e4fbeaf68b5022ca118d2.png\">\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"csharp\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// FL (左前): +Pitch +Roll -Yaw\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// FR (右前): +Pitch -Roll +Yaw\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// BL (左后): -Pitch +Roll +Yaw\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// BR (右后): -Pitch -Roll -Yaw\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Chr>\n\u003Ch2 id=\"物理细节的打磨\">物理细节的打磨\u003C/h2>\n\u003Cp>基础 PID 能飞，但手感像“在真空中飞行”或者“完美的刚体”。为了真实感，我引入了三个关键特性：\u003C/p>\n\u003Ch3 id=\"电机惯性-motor-inertia\">电机惯性 (Motor Inertia)\u003C/h3>\n\u003Cp>真实的电机从 0 加速到 100% 需要时间。\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cstrong>实现\u003C/strong>：使用 \u003Ccode>Mathf.Lerp\u003C/code> 对油门输入进行低通滤波。\u003C/li>\n\u003Cli>\u003Cstrong>效果\u003C/strong>：消除了“瞬移般”的响应，给油门带来了一丝“肉”感和延迟，极大提升了重量感。\u003C/li>\n\u003C/ul>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"csharp\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 更新动力 (在 FlightController 的 FixedUpdate 中调用)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    public\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> UpdatePhysics\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">float\u003C/span>\u003Cspan style=\"color:#B392F0\"> targetThrottle\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // 模拟电机惯性 (一阶低通滤波)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // 从当前油门平滑过渡到目标油门\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        float\u003C/span>\u003Cspan style=\"color:#B392F0\"> dt\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Time.fixedDeltaTime;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        currentThrottle \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Mathf.\u003C/span>\u003Cspan style=\"color:#B392F0\">Lerp\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(currentThrottle, targetThrottle, dt \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> motorResponseSpeed);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // 1. 施加升力 (垂直于机臂向上)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        Vector3\u003C/span>\u003Cspan style=\"color:#B392F0\"> force\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> transform.up \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (currentThrottle \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> maxThrust);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        rb.\u003C/span>\u003Cspan style=\"color:#B392F0\">AddForceAtPosition\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(force, transform.position);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // 2. 施加反扭矩 (Yaw控制)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // 顺时针旋转的电机，会给机身施加逆时针的扭矩，反之亦然\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        float\u003C/span>\u003Cspan style=\"color:#B392F0\"> torqueDir\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> isClockwise \u003C/span>\u003Cspan style=\"color:#F97583\">?\u003C/span>\u003Cspan style=\"color:#F97583\"> -\u003C/span>\u003Cspan style=\"color:#79B8FF\">1f\u003C/span>\u003Cspan style=\"color:#F97583\"> :\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        float\u003C/span>\u003Cspan style=\"color:#B392F0\"> torqueMagnitude\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> currentThrottle \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> maxThrust \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> torqueFactor \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> torqueDir;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        rb.\u003C/span>\u003Cspan style=\"color:#B392F0\">AddTorque\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(transform.up \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> torqueMagnitude, ForceMode.Force);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch3 id=\"地面效应-ground-effect\">地面效应 (Ground Effect)\u003C/h3>\n\u003Cp>当无人机贴近地面时，下洗气流受阻，升力会增加。\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cstrong>实现\u003C/strong>：向下发射射线检测高度。高度 &#x3C; 0.5m 时，根据距离非线性增加升力系数。\u003C/li>\n\u003Cli>\u003Cstrong>效果\u003C/strong>：降落时会有明显的“气垫感”，不会直接“砸”向地面，起飞也更轻盈。\u003C/li>\n\u003C/ul>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"csharp\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            // --- 地面效应 (Ground Effect) ---\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            RaycastHit\u003C/span>\u003Cspan style=\"color:#B392F0\"> hit\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Physics.\u003C/span>\u003Cspan style=\"color:#B392F0\">Raycast\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(transform.position, Vector3.down, \u003C/span>\u003Cspan style=\"color:#F97583\">out\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> hit, groundEffectMaxHeight))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                float\u003C/span>\u003Cspan style=\"color:#B392F0\"> ratio\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1.0f\u003C/span>\u003Cspan style=\"color:#F97583\"> -\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (hit.distance \u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> groundEffectMaxHeight);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                float\u003C/span>\u003Cspan style=\"color:#B392F0\"> groundEffectMultiplier\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1.0f\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (ratio \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> groundEffectLiftFactor);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                m1 \u003C/span>\u003Cspan style=\"color:#F97583\">*=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> groundEffectMultiplier;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                m2 \u003C/span>\u003Cspan style=\"color:#F97583\">*=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> groundEffectMultiplier;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                m3 \u003C/span>\u003Cspan style=\"color:#F97583\">*=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> groundEffectMultiplier;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                m4 \u003C/span>\u003Cspan style=\"color:#F97583\">*=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> groundEffectMultiplier;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            }\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch3 id=\"非线性空气阻力-quadratic-drag\">非线性空气阻力 (Quadratic Drag)\u003C/h3>\n\u003Cp>Unity 默认的 \u003Ccode>Drag\u003C/code> 是线性的 ($F \\propto v$)，这让无人机感觉像在水里游。\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cstrong>实现\u003C/strong>：手动计算平方阻力 $F = -v \\cdot |v| \\cdot k$。\u003C/li>\n\u003Cli>\u003Cstrong>差异化阻力\u003C/strong>：\n\u003Cul>\n\u003Cli>\u003Cstrong>垂直方向\u003C/strong>：机身扁平，阻力系数大 (1.0)。下落会有明显的终端速度。\u003C/li>\n\u003Cli>\u003Cstrong>水平方向\u003C/strong>：机身流线，阻力系数小 (0.2)。允许长距离惯性滑行。\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\u003Cstrong>效果\u003C/strong>：这是手感提升最明显的一步。前飞松杆后的滑行感，以及高空下落时的速度平衡，都非常接近真机。\u003C/li>\n\u003C/ul>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"csharp\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // 计算平方阻力: F = -v * |v| * dragFactor\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        Vector3\u003C/span>\u003Cspan style=\"color:#B392F0\"> dragForceLocal\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Vector3.zero;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        dragForceLocal.x \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> -\u003C/span>\u003Cspan style=\"color:#E1E4E8\">localVel.x \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Mathf.\u003C/span>\u003Cspan style=\"color:#B392F0\">Abs\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(localVel.x) \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> dragFactors.x;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        dragForceLocal.y \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> -\u003C/span>\u003Cspan style=\"color:#E1E4E8\">localVel.y \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Mathf.\u003C/span>\u003Cspan style=\"color:#B392F0\">Abs\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(localVel.y) \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> dragFactors.y; \u003C/span>\u003Cspan style=\"color:#6A737D\">// 垂直阻力通常较大\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        dragForceLocal.z \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> -\u003C/span>\u003Cspan style=\"color:#E1E4E8\">localVel.z \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Mathf.\u003C/span>\u003Cspan style=\"color:#B392F0\">Abs\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(localVel.z) \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> dragFactors.z;\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Chr>\n\u003Ch2 id=\"飞行模式\">飞行模式\u003C/h2>\n\u003Cp>无人机操作一共配置了两种模式\u003C/p>\n\u003Ch3 id=\"acro-mode-手动模式\">Acro Mode (手动模式)\u003C/h3>\n\u003Cul>\n\u003Cli>\u003Cstrong>逻辑\u003C/strong>：摇杆控制\u003Cstrong>角速度\u003C/strong>。松杆后无人机保持当前姿态。\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"angle-mode-自稳模式\">Angle Mode (自稳模式)\u003C/h3>\n\u003Cul>\n\u003Cli>\u003Cstrong>逻辑\u003C/strong>：\u003Cstrong>双环 PID 控制\u003C/strong>。\n\u003Cul>\n\u003Cli>\u003Cstrong>外环\u003C/strong>：摇杆控制\u003Cstrong>角度\u003C/strong> (例如满杆 45 度)。计算出目标角速度。\u003C/li>\n\u003Cli>\u003Cstrong>内环\u003C/strong>：执行目标角速度。\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\u003Cstrong>特性\u003C/strong>：松杆自动回平。\u003C/li>\n\u003C/ul>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"csharp\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">       if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (mode \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> FlightMode.Angle)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            // --- Angle Mode (自稳模式) ---\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            // 摇杆输入映射为目标角度 (-45 ~ 45 度)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            float\u003C/span>\u003Cspan style=\"color:#B392F0\"> targetPitchAngle\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> input.Pitch \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> maxTiltAngle;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            float\u003C/span>\u003Cspan style=\"color:#B392F0\"> targetRollAngle\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#F97583\"> -\u003C/span>\u003Cspan style=\"color:#E1E4E8\">input.Roll \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> maxTiltAngle; \u003C/span>\u003Cspan style=\"color:#6A737D\">// Unity Z轴旋转方向可能需要反转\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            // 获取当前角度 (将 0-360 转换为 +/- 180)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            Vector3\u003C/span>\u003Cspan style=\"color:#B392F0\"> currentEuler\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> transform.localEulerAngles;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            float\u003C/span>\u003Cspan style=\"color:#B392F0\"> currentPitch\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Mathf.\u003C/span>\u003Cspan style=\"color:#B392F0\">DeltaAngle\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, currentEuler.x);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            float\u003C/span>\u003Cspan style=\"color:#B392F0\"> currentRoll\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Mathf.\u003C/span>\u003Cspan style=\"color:#B392F0\">DeltaAngle\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, currentEuler.z);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            // 外环 P 控制: 角度误差 -> 目标角速度\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            // Pitch: 目标 - 当前 (因为后面混控器 Pitch 反转了，所以这里保持 目标-当前)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            targetPitchRate \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (targetPitchAngle \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> currentPitch) \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> angleKP;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            // Roll: 当前 - 目标 (反转逻辑，防止正反馈翻滚)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            // 右滚是负角度，如果不反转，误差为正，导致继续右滚\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            targetRollRate \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (currentRoll \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> targetRollAngle) \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> angleKP;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            // Yaw 轴通常保持 Rate 模式\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            targetYawRate \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> input.Yaw \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 150f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        else\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            // --- Acro Mode (特技/手动模式) ---\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            // 摇杆输入直接映射为目标角速度 (-200 ~ 200 度/秒)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            targetPitchRate \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> input.Pitch \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 200f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            targetRollRate \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> input.Roll \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 200f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            targetYawRate \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> input.Yaw \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 150f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Chr>\n\u003Ch2 id=\"稳定性与体验优化\">稳定性与体验优化\u003C/h2>\n\u003Cp>除了核心物理，还有很多细节决定了模拟器的可用性：\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cstrong>怠速保护 (Idle Protection)\u003C/strong>：\n\u003Cul>\n\u003Cli>问题：地面待机时，PID 积分项累积导致无人机“抽搐”或乱跳。\u003C/li>\n\u003Cli>解决：油门 &#x3C; 5% 时，强制关闭电机并 \u003Cstrong>Reset PID\u003C/strong>。\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003C/ul>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"csharp\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // --- 怠速保护逻辑 ---\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (throttleBase \u003C/span>\u003Cspan style=\"color:#F97583\">&#x3C;\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0.05f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            m1 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> m2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> m3 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> m4 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            pitchPID.\u003C/span>\u003Cspan style=\"color:#B392F0\">Reset\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            rollPID.\u003C/span>\u003Cspan style=\"color:#B392F0\">Reset\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            yawPID.\u003C/span>\u003Cspan style=\"color:#B392F0\">Reset\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cul>\n\u003Cli>\u003Cstrong>PID 限幅 (Authority Limit)\u003C/strong>：\n\u003Cul>\n\u003Cli>限制 PID 对电机的最大控制权 (例如 30%)，防止极端情况下 PID 输出过大导致电机饱和甚至侧翻。\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003C/ul>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"csharp\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">         // --- PID 限幅保护 ---\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">         float\u003C/span>\u003Cspan style=\"color:#B392F0\"> pOut\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Mathf.\u003C/span>\u003Cspan style=\"color:#B392F0\">Clamp\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pitchCorrection \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> correctionScale, \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#E1E4E8\">maxPIDAuthority, maxPIDAuthority);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">         float\u003C/span>\u003Cspan style=\"color:#B392F0\"> rOut\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Mathf.\u003C/span>\u003Cspan style=\"color:#B392F0\">Clamp\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(rollCorrection \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> correctionScale, \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#E1E4E8\">maxPIDAuthority, maxPIDAuthority);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">         float\u003C/span>\u003Cspan style=\"color:#B392F0\"> yOut\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Mathf.\u003C/span>\u003Cspan style=\"color:#B392F0\">Clamp\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(yawCorrection \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> correctionScale, \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#E1E4E8\">maxPIDAuthority, maxPIDAuthority); \u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cul>\n\u003Cli>\u003Cstrong>一键重置\u003C/strong>：\n\u003Cul>\n\u003Cli>添加手柄 \u003Cstrong>Y 键\u003C/strong> 复位功能，炸机后瞬间回到原点并清空物理速度，方便反复练习。\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003C/ul>\n\u003Chr>\n\u003Ch1 id=\"二源码\">二、源码\u003C/h1>\n\u003Ch2 id=\"代码结构\">代码结构\u003C/h2>\n\u003Cp>代码结构比较简单，一共就4个代码就实现了整个无人机模拟，以下是流程图：\u003C/p>\n\u003Cp>\u003Cimg src=\"/uploads/images/1766732962738-221925025.jpg\" alt=\"Gemini_Generated_Image_v4l1irv4l1irv4l1.jpg\">\u003C/p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003Ctable>\u003Cthead>\u003Ctr>\u003Cth>架构分层\u003C/th>\u003Cth>核心脚本\u003C/th>\u003Cth>角色定位\u003C/th>\u003Cth>主要功能与逻辑\u003C/th>\u003Cth>数据流向 / 物理作用\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd>\u003Cstrong>输入层\u003C/strong>\u003C/td>\u003Ctd>\u003Ccode>DroneInput.cs\u003C/code>\u003C/td>\u003Ctd>\u003Cstrong>信号预处理\u003C/strong>\u003C/td>\u003Ctd>1. \u003Cstrong>读取硬件\u003C/strong>：接收物理手柄输入。\u003Cbr> 2. \u003Cstrong>数据清洗\u003C/strong>：处理摇杆死区、应用映射曲线。\u003C/td>\u003Ctd>\u003Cstrong>输出\u003C/strong>：标准化控制信号\u003Cbr>• 油门 (Throttle): \u003Ccode>0 ~ 1\u003C/code> \u003Cbr>•俯仰/横滚/偏航: \u003Ccode>-1 ~ 1\u003C/code>\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>控制层\u003C/strong>\u003C/td>\u003Ctd>\u003Ccode>FlightController.cs\u003C/code>\u003C/td>\u003Ctd>\u003Cstrong>大脑 (Brain)\u003C/strong>\u003C/td>\u003Ctd>1. \u003Cstrong>模式处理\u003C/strong>：根据 Angle/Acro 模式将输入转为目标角速度。\u003Cbr>2. \u003Cstrong>PID 调度\u003C/strong>：调用 \u003Ccode>PID.cs\u003C/code> 计算误差。\u003Cbr> 3. \u003Cstrong>混控 (Mixer)\u003C/strong>：混合主油门与 PID 修正值。\u003Cbr>  4. \u003Cstrong>环境模拟\u003C/strong>：计算非线性阻力与地面效应。\u003C/td>\u003Ctd>\u003Cstrong>输入\u003C/strong>：标准化信号 + 刚体物理状态\u003Cbr>\u003Cstrong>输出\u003C/strong>：4 个电机的最终目标油门\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>算法层\u003C/strong>\u003C/td>\u003Ctd>\u003Ccode>PID.cs\u003C/code>\u003C/td>\u003Ctd>\u003Cstrong>纯数学计算\u003C/strong>\u003C/td>\u003Ctd>1. \u003Cstrong>误差计算\u003C/strong>：对比目标值与当前值。\u003Cbr>2. \u003Cstrong>修正输出\u003C/strong>：计算比例(P)+积分(I)+微分(D)的总和。\u003C/td>\u003Ctd>\u003Cstrong>输入\u003C/strong>：目标值、当前值、时间差 (dt)\u003Cbr>\u003Cstrong>输出\u003C/strong>：PID 修正值\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>执行层\u003C/strong>\u003C/td>\u003Ctd>\u003Ccode>MotorEngine.cs\u003C/code>\u003C/td>\u003Ctd>\u003Cstrong>四肢 (Limbs)\u003C/strong>\u003C/td>\u003Ctd>1. \u003Cstrong>惯性模拟\u003C/strong>：通过低通滤波模拟电机响应延迟。\u003Cbr>2. \u003Cstrong>物理交互\u003C/strong>：将油门值转换为具体的物理力。\u003C/td>\u003Ctd>\u003Cstrong>输入\u003C/strong>：目标油门值\u003Cbr>\u003Cstrong>作用\u003C/strong>：向 Rigidbody 施加\u003Cbr>• 推力 (Force)\u003Cbr>• 反扭矩 (Torque)\u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\n\u003Ch1 id=\"总结\">总结\u003C/h1>\n\u003Cp>通过以上步骤，我们从一个简单的刚体运动，进化到了一个具备空气动力学特性的飞行模拟器。目前的物理手感已经能传达出穿越机的“惯性”和“风阻”。\u003C/p>\n\u003Cp>如果能帮助到你！可以给我来个点赞吗？ 谢谢！u😘\u003C/p>",{"headings":96,"localImagePaths":145,"remoteImagePaths":146,"frontmatter":89,"imagePaths":147},[97,100,102,105,107,109,111,114,117,119,122,125,128,130,133,136,138,141,143],{"depth":20,"slug":98,"text":99},"unity-无人机物理模拟开发日志从零打造穿越机手感","Unity 无人机物理模拟开发日志：从零打造穿越机手感",{"depth":44,"slug":101,"text":101},"开源仓库地址",{"depth":44,"slug":103,"text":104},"演示视频","演示视频：",{"depth":20,"slug":106,"text":106},"功能介绍",{"depth":37,"slug":108,"text":108},"输入系统",{"depth":37,"slug":110,"text":110},"核心物理引擎",{"depth":44,"slug":112,"text":113},"pid-控制器-rate-loop","PID 控制器 (Rate Loop)",{"depth":44,"slug":115,"text":116},"混控器-mixer","混控器 (Mixer)",{"depth":37,"slug":118,"text":118},"物理细节的打磨",{"depth":44,"slug":120,"text":121},"电机惯性-motor-inertia","电机惯性 (Motor Inertia)",{"depth":44,"slug":123,"text":124},"地面效应-ground-effect","地面效应 (Ground Effect)",{"depth":44,"slug":126,"text":127},"非线性空气阻力-quadratic-drag","非线性空气阻力 (Quadratic Drag)",{"depth":37,"slug":129,"text":129},"飞行模式",{"depth":44,"slug":131,"text":132},"acro-mode-手动模式","Acro Mode (手动模式)",{"depth":44,"slug":134,"text":135},"angle-mode-自稳模式","Angle Mode (自稳模式)",{"depth":37,"slug":137,"text":137},"稳定性与体验优化",{"depth":20,"slug":139,"text":140},"二源码","二、源码",{"depth":37,"slug":142,"text":142},"代码结构",{"depth":20,"slug":144,"text":144},"总结",[],[],[],"post_20251226070813.md"]