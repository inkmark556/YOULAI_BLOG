[["Map",1,2,7,8],"meta::meta",["Map",3,4,5,6],"astro-version","5.16.6","astro-config-digest","{\"root\":{},\"srcDir\":{},\"publicDir\":{},\"outDir\":{},\"cacheDir\":{},\"compressHTML\":true,\"base\":\"/\",\"trailingSlash\":\"ignore\",\"output\":\"static\",\"scopedStyleStrategy\":\"attribute\",\"build\":{\"format\":\"directory\",\"client\":{},\"server\":{},\"assets\":\"_astro\",\"serverEntry\":\"entry.mjs\",\"redirects\":true,\"inlineStylesheets\":\"auto\",\"concurrency\":1},\"server\":{\"open\":false,\"host\":false,\"port\":4321,\"streaming\":true,\"allowedHosts\":[]},\"redirects\":{},\"image\":{\"endpoint\":{\"route\":\"/_image\"},\"service\":{\"entrypoint\":\"astro/assets/services/sharp\",\"config\":{}},\"domains\":[],\"remotePatterns\":[],\"responsiveStyles\":false},\"devToolbar\":{\"enabled\":true},\"markdown\":{\"syntaxHighlight\":{\"type\":\"shiki\",\"excludeLangs\":[\"math\"]},\"shikiConfig\":{\"langs\":[],\"langAlias\":{},\"theme\":\"github-dark\",\"themes\":{},\"wrap\":false,\"transformers\":[]},\"remarkPlugins\":[],\"rehypePlugins\":[],\"remarkRehype\":{},\"gfm\":true,\"smartypants\":true},\"security\":{\"checkOrigin\":true,\"allowedDomains\":[]},\"env\":{\"schema\":{},\"validateSecrets\":false},\"experimental\":{\"clientPrerender\":false,\"contentIntellisense\":false,\"headingIdCompat\":false,\"preserveScriptOrder\":false,\"liveContentCollections\":false,\"csp\":false,\"staticImportMetaEnv\":false,\"chromeDevtoolsWorkspace\":false,\"failOnPrerenderConflict\":false,\"svgo\":false},\"legacy\":{\"collections\":false}}","posts",["Map",9,10,26,27,63,64,90,91,152,153,250,251,275,276],"about",{"id":9,"data":11,"body":12,"filePath":13,"digest":14,"rendered":15,"legacyId":25},{},"# 关于我\r\n\r\n  大家好，我是又来！来着长沙的一位热爱游戏和技术的00后开发者。\r\n\r\n  我喜欢用代码创造属于自己的世界，尤其喜欢研究游戏的底层机制和各种有趣的玩法。Unity 是我最常用的开发工具，无论是做单机、联机还是 VR/AR 项目，都能让我乐在其中。\r\n\r\n  平时除了写代码，也喜欢玩各种类型的游戏，尤其是策略类、动作类和独立游戏。最喜欢的系列有《文明》、《塞尔达》、《P5》、《星露谷物语》等等。偶尔也会自己做一些小游戏，或者和朋友一起开发一些有趣的 Demo。\r\n\r\n  兴趣爱好方面，除了游戏和编程，我还喜欢画画、摄影、看科幻小说、研究 AI 技术。喜欢和志同道合的朋友交流技术、分享创意。\r\n\r\n  我相信游戏不仅仅是娱乐，更是一种表达和连接的方式。希望能用自己的技术和创意，做出让人开心、感动、甚至能改变一点点世界的作品。\r\n\r\n  欢迎交流、一起玩游戏或者合作开发！","src/content/posts/about.md","7b2021144f2b4143",{"html":16,"metadata":17},"\u003Ch1 id=\"关于我\">关于我\u003C/h1>\n\u003Cp>大家好，我是又来！来着长沙的一位热爱游戏和技术的00后开发者。\u003C/p>\n\u003Cp>我喜欢用代码创造属于自己的世界，尤其喜欢研究游戏的底层机制和各种有趣的玩法。Unity 是我最常用的开发工具，无论是做单机、联机还是 VR/AR 项目，都能让我乐在其中。\u003C/p>\n\u003Cp>平时除了写代码，也喜欢玩各种类型的游戏，尤其是策略类、动作类和独立游戏。最喜欢的系列有《文明》、《塞尔达》、《P5》、《星露谷物语》等等。偶尔也会自己做一些小游戏，或者和朋友一起开发一些有趣的 Demo。\u003C/p>\n\u003Cp>兴趣爱好方面，除了游戏和编程，我还喜欢画画、摄影、看科幻小说、研究 AI 技术。喜欢和志同道合的朋友交流技术、分享创意。\u003C/p>\n\u003Cp>我相信游戏不仅仅是娱乐，更是一种表达和连接的方式。希望能用自己的技术和创意，做出让人开心、感动、甚至能改变一点点世界的作品。\u003C/p>\n\u003Cp>欢迎交流、一起玩游戏或者合作开发！\u003C/p>",{"headings":18,"localImagePaths":22,"remoteImagePaths":23,"frontmatter":11,"imagePaths":24},[19],{"depth":20,"slug":21,"text":21},1,"关于我",[],[],[],"about.md","post_20251226054819",{"id":26,"data":28,"body":29,"filePath":30,"digest":31,"rendered":32,"legacyId":62},{},"# Unity手柄开发指南：新旧输入系统按键映射详解\n在 Unity 中进行手柄开发时，按键的对应名称（Button Names）取决于你使用的是 **传统的 Input Manager (旧版)** 还是 **Input System Package (新版)**。\n\n目前主流且推荐的做法是使用 **Input System Package**，因为它能自动处理不同手柄（Xbox, PS4, Switch）之间的差异。\n\n---\n\n## 1. 新版 Input System (推荐)\n\n在新版系统中，你不需要记忆复杂的编号，只需使用路径（Path）即可。\n\n| 手柄按键 (通用名称) | 路径名称 (Path) |\n| --- | --- |\n| **南面按键** (Xbox: A / PS: ×) | `\u003CGamepad>/buttonSouth` |\n| **东面按键** (Xbox: B / PS: ○) | `\u003CGamepad>/buttonEast` |\n| **西面按键** (Xbox: X / PS: □) | `\u003CGamepad>/buttonWest` |\n| **北面按键** (Xbox: Y / PS: △) | `\u003CGamepad>/buttonNorth` |\n| **左/右肩键** (LB / RB) | `\u003CGamepad>/leftShoulder`, `\u003CGamepad>/rightShoulder` |\n| **左/右扳机** (LT / RT) | `\u003CGamepad>/leftTrigger`, `\u003CGamepad>/rightTrigger` |\n| **左/右摇杆点击** (LS / RS) | `\u003CGamepad>/leftStickPress`, `\u003CGamepad>/rightStickPress` |\n| **方向键** (D-Pad) | `\u003CGamepad>/dpad/up`, `down`, `left`, `right` |\n| **功能键** (Start / Back) | `\u003CGamepad>/start`, `\u003CGamepad>/select` |\n\n---\n\n## 2. 旧版 Input Manager (默认项目设置)\n\n如果你在 `Project Settings -> Input Manager` 中手动设置，通常需要对应 **Joystick Button** 的编号。以下是以 **Xbox Controller (Windows)** 为标准的映射：\n\n### 常用按键映射表 (Xbox)\n\n\n\n![3ba9965a91e04fa59ca496e1a5db8142.png](/uploads/images/1766734880544-906187610.png)\n\n\n### 按钮映射表 (Buttons)\n| 物理按键 (Physical Button) | Unity 映射 ID (Map to) | 备注 |\n| --- | --- | --- |\n| **A** | `joystick button 0` | 确认 / 跳跃 |\n| **B** | `joystick button 1` | 取消 / 返回 |\n| **X** | `joystick button 2` | **(你在图中漏标了这个)** |\n| **Y** | `joystick button 3` |  |\n| **LB** (左肩键) | `joystick button 4` | Left Bumper |\n| **RB** (右肩键) | `joystick button 5` | Right Bumper |\n| **View** (双框图标) | `joystick button 6` | 旧称 Back 键 |\n| **Menu** (三道杠图标) | `joystick button 7` | 旧称 Start 键 |\n| **L3** (按下左摇杆) | `joystick button 8` | Left Stick Click |\n| **R3** (按下右摇杆) | `joystick button 9` | Right Stick Click |\n| **Share** (中间分享键) | *通常无法识别* | 旧版输入系统很难直接检测到此键 |\n| **Xbox 标** (西瓜键) | *系统占用* | 呼出 Windows 游戏栏，Unity 无法获取 |\n### 轴线映射 (Axes)\n| 物理输入 (Physical Input) | Unity 轴向 (Axis Name/Number) | 值范围 (Value) |\n| --- | --- | --- |\n| **左摇杆 - 水平** | `X Axis` | -1 (左) 到 1 (右) |\n| **左摇杆 - 垂直** | `Y Axis` | -1 (下) 到 1 (上)* |\n| **右摇杆 - 水平** | `4th Axis` | -1 (左) 到 1 (右) |\n| **右摇杆 - 垂直** | `5th Axis` | -1 (下) 到 1 (上)* |\n| **D-Pad (十字键) - 水平** | `6th Axis` | -1 (左) 到 1 (右) |\n| **D-Pad (十字键) - 垂直** | `7th Axis` | -1 (下) 到 1 (上) |\n| **LT (左扳机)** | `9th Axis` | 0 (松开) 到 1 (按下) |\n| **RT (右扳机)** | `10th Axis` | 0 (松开) 到 1 (按下) |\n---\n\n## 3. 注意事项：PS4/PS5 手柄差异\n\n如果你使用的是 PS4 DualShock 手柄且通过旧版 Input Manager 识别，编号会完全不同：\n\n* **× (South):** `joystick button 1`\n* **○ (East):** `joystick button 2`\n* **□ (West):** `joystick button 0`\n* **△ (North):** `joystick button 3`","src/content/posts/post_20251226054819.md","a2544cbef5dc2712",{"html":33,"metadata":34},"\u003Ch1 id=\"unity手柄开发指南新旧输入系统按键映射详解\">Unity手柄开发指南：新旧输入系统按键映射详解\u003C/h1>\n\u003Cp>在 Unity 中进行手柄开发时，按键的对应名称（Button Names）取决于你使用的是 \u003Cstrong>传统的 Input Manager (旧版)\u003C/strong> 还是 \u003Cstrong>Input System Package (新版)\u003C/strong>。\u003C/p>\n\u003Cp>目前主流且推荐的做法是使用 \u003Cstrong>Input System Package\u003C/strong>，因为它能自动处理不同手柄（Xbox, PS4, Switch）之间的差异。\u003C/p>\n\u003Chr>\n\u003Ch2 id=\"1-新版-input-system-推荐\">1. 新版 Input System (推荐)\u003C/h2>\n\u003Cp>在新版系统中，你不需要记忆复杂的编号，只需使用路径（Path）即可。\u003C/p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003Ctable>\u003Cthead>\u003Ctr>\u003Cth>手柄按键 (通用名称)\u003C/th>\u003Cth>路径名称 (Path)\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd>\u003Cstrong>南面按键\u003C/strong> (Xbox: A / PS: ×)\u003C/td>\u003Ctd>\u003Ccode>&#x3C;Gamepad>/buttonSouth\u003C/code>\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>东面按键\u003C/strong> (Xbox: B / PS: ○)\u003C/td>\u003Ctd>\u003Ccode>&#x3C;Gamepad>/buttonEast\u003C/code>\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>西面按键\u003C/strong> (Xbox: X / PS: □)\u003C/td>\u003Ctd>\u003Ccode>&#x3C;Gamepad>/buttonWest\u003C/code>\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>北面按键\u003C/strong> (Xbox: Y / PS: △)\u003C/td>\u003Ctd>\u003Ccode>&#x3C;Gamepad>/buttonNorth\u003C/code>\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>左/右肩键\u003C/strong> (LB / RB)\u003C/td>\u003Ctd>\u003Ccode>&#x3C;Gamepad>/leftShoulder\u003C/code>, \u003Ccode>&#x3C;Gamepad>/rightShoulder\u003C/code>\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>左/右扳机\u003C/strong> (LT / RT)\u003C/td>\u003Ctd>\u003Ccode>&#x3C;Gamepad>/leftTrigger\u003C/code>, \u003Ccode>&#x3C;Gamepad>/rightTrigger\u003C/code>\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>左/右摇杆点击\u003C/strong> (LS / RS)\u003C/td>\u003Ctd>\u003Ccode>&#x3C;Gamepad>/leftStickPress\u003C/code>, \u003Ccode>&#x3C;Gamepad>/rightStickPress\u003C/code>\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>方向键\u003C/strong> (D-Pad)\u003C/td>\u003Ctd>\u003Ccode>&#x3C;Gamepad>/dpad/up\u003C/code>, \u003Ccode>down\u003C/code>, \u003Ccode>left\u003C/code>, \u003Ccode>right\u003C/code>\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>功能键\u003C/strong> (Start / Back)\u003C/td>\u003Ctd>\u003Ccode>&#x3C;Gamepad>/start\u003C/code>, \u003Ccode>&#x3C;Gamepad>/select\u003C/code>\u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\n\u003Chr>\n\u003Ch2 id=\"2-旧版-input-manager-默认项目设置\">2. 旧版 Input Manager (默认项目设置)\u003C/h2>\n\u003Cp>如果你在 \u003Ccode>Project Settings -> Input Manager\u003C/code> 中手动设置，通常需要对应 \u003Cstrong>Joystick Button\u003C/strong> 的编号。以下是以 \u003Cstrong>Xbox Controller (Windows)\u003C/strong> 为标准的映射：\u003C/p>\n\u003Ch3 id=\"常用按键映射表-xbox\">常用按键映射表 (Xbox)\u003C/h3>\n\u003Cp>\u003Cimg src=\"/uploads/images/1766734880544-906187610.png\" alt=\"3ba9965a91e04fa59ca496e1a5db8142.png\">\u003C/p>\n\u003Ch3 id=\"按钮映射表-buttons\">按钮映射表 (Buttons)\u003C/h3>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003Ctable>\u003Cthead>\u003Ctr>\u003Cth>物理按键 (Physical Button)\u003C/th>\u003Cth>Unity 映射 ID (Map to)\u003C/th>\u003Cth>备注\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd>\u003Cstrong>A\u003C/strong>\u003C/td>\u003Ctd>\u003Ccode>joystick button 0\u003C/code>\u003C/td>\u003Ctd>确认 / 跳跃\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>B\u003C/strong>\u003C/td>\u003Ctd>\u003Ccode>joystick button 1\u003C/code>\u003C/td>\u003Ctd>取消 / 返回\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>X\u003C/strong>\u003C/td>\u003Ctd>\u003Ccode>joystick button 2\u003C/code>\u003C/td>\u003Ctd>\u003Cstrong>(你在图中漏标了这个)\u003C/strong>\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>Y\u003C/strong>\u003C/td>\u003Ctd>\u003Ccode>joystick button 3\u003C/code>\u003C/td>\u003Ctd>\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>LB\u003C/strong> (左肩键)\u003C/td>\u003Ctd>\u003Ccode>joystick button 4\u003C/code>\u003C/td>\u003Ctd>Left Bumper\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>RB\u003C/strong> (右肩键)\u003C/td>\u003Ctd>\u003Ccode>joystick button 5\u003C/code>\u003C/td>\u003Ctd>Right Bumper\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>View\u003C/strong> (双框图标)\u003C/td>\u003Ctd>\u003Ccode>joystick button 6\u003C/code>\u003C/td>\u003Ctd>旧称 Back 键\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>Menu\u003C/strong> (三道杠图标)\u003C/td>\u003Ctd>\u003Ccode>joystick button 7\u003C/code>\u003C/td>\u003Ctd>旧称 Start 键\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>L3\u003C/strong> (按下左摇杆)\u003C/td>\u003Ctd>\u003Ccode>joystick button 8\u003C/code>\u003C/td>\u003Ctd>Left Stick Click\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>R3\u003C/strong> (按下右摇杆)\u003C/td>\u003Ctd>\u003Ccode>joystick button 9\u003C/code>\u003C/td>\u003Ctd>Right Stick Click\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>Share\u003C/strong> (中间分享键)\u003C/td>\u003Ctd>\u003Cem>通常无法识别\u003C/em>\u003C/td>\u003Ctd>旧版输入系统很难直接检测到此键\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>Xbox 标\u003C/strong> (西瓜键)\u003C/td>\u003Ctd>\u003Cem>系统占用\u003C/em>\u003C/td>\u003Ctd>呼出 Windows 游戏栏，Unity 无法获取\u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\n\u003Ch3 id=\"轴线映射-axes\">轴线映射 (Axes)\u003C/h3>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003Ctable>\u003Cthead>\u003Ctr>\u003Cth>物理输入 (Physical Input)\u003C/th>\u003Cth>Unity 轴向 (Axis Name/Number)\u003C/th>\u003Cth>值范围 (Value)\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd>\u003Cstrong>左摇杆 - 水平\u003C/strong>\u003C/td>\u003Ctd>\u003Ccode>X Axis\u003C/code>\u003C/td>\u003Ctd>-1 (左) 到 1 (右)\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>左摇杆 - 垂直\u003C/strong>\u003C/td>\u003Ctd>\u003Ccode>Y Axis\u003C/code>\u003C/td>\u003Ctd>-1 (下) 到 1 (上)*\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>右摇杆 - 水平\u003C/strong>\u003C/td>\u003Ctd>\u003Ccode>4th Axis\u003C/code>\u003C/td>\u003Ctd>-1 (左) 到 1 (右)\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>右摇杆 - 垂直\u003C/strong>\u003C/td>\u003Ctd>\u003Ccode>5th Axis\u003C/code>\u003C/td>\u003Ctd>-1 (下) 到 1 (上)*\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>D-Pad (十字键) - 水平\u003C/strong>\u003C/td>\u003Ctd>\u003Ccode>6th Axis\u003C/code>\u003C/td>\u003Ctd>-1 (左) 到 1 (右)\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>D-Pad (十字键) - 垂直\u003C/strong>\u003C/td>\u003Ctd>\u003Ccode>7th Axis\u003C/code>\u003C/td>\u003Ctd>-1 (下) 到 1 (上)\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>LT (左扳机)\u003C/strong>\u003C/td>\u003Ctd>\u003Ccode>9th Axis\u003C/code>\u003C/td>\u003Ctd>0 (松开) 到 1 (按下)\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>RT (右扳机)\u003C/strong>\u003C/td>\u003Ctd>\u003Ccode>10th Axis\u003C/code>\u003C/td>\u003Ctd>0 (松开) 到 1 (按下)\u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\n\u003Chr>\n\u003Ch2 id=\"3-注意事项ps4ps5-手柄差异\">3. 注意事项：PS4/PS5 手柄差异\u003C/h2>\n\u003Cp>如果你使用的是 PS4 DualShock 手柄且通过旧版 Input Manager 识别，编号会完全不同：\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cstrong>× (South):\u003C/strong> \u003Ccode>joystick button 1\u003C/code>\u003C/li>\n\u003Cli>\u003Cstrong>○ (East):\u003C/strong> \u003Ccode>joystick button 2\u003C/code>\u003C/li>\n\u003Cli>\u003Cstrong>□ (West):\u003C/strong> \u003Ccode>joystick button 0\u003C/code>\u003C/li>\n\u003Cli>\u003Cstrong>△ (North):\u003C/strong> \u003Ccode>joystick button 3\u003C/code>\u003C/li>\n\u003C/ul>",{"headings":35,"localImagePaths":59,"remoteImagePaths":60,"frontmatter":28,"imagePaths":61},[36,39,43,46,50,53,56],{"depth":20,"slug":37,"text":38},"unity手柄开发指南新旧输入系统按键映射详解","Unity手柄开发指南：新旧输入系统按键映射详解",{"depth":40,"slug":41,"text":42},2,"1-新版-input-system-推荐","1. 新版 Input System (推荐)",{"depth":40,"slug":44,"text":45},"2-旧版-input-manager-默认项目设置","2. 旧版 Input Manager (默认项目设置)",{"depth":47,"slug":48,"text":49},3,"常用按键映射表-xbox","常用按键映射表 (Xbox)",{"depth":47,"slug":51,"text":52},"按钮映射表-buttons","按钮映射表 (Buttons)",{"depth":47,"slug":54,"text":55},"轴线映射-axes","轴线映射 (Axes)",{"depth":40,"slug":57,"text":58},"3-注意事项ps4ps5-手柄差异","3. 注意事项：PS4/PS5 手柄差异",[],[],[],"post_20251226054819.md","unity_001",{"id":63,"data":65,"body":66,"filePath":67,"digest":68,"rendered":69,"legacyId":89},{},"# Unity 自由相机\r\n### 操作方式\r\n- WASD水平移动 (按住左SHIFT加速移动) \r\n- QE垂直移动   \r\n- 鼠标右键按下旋转视角\r\n\r\n### 代码内容\r\n```csharp\r\nusing UnityEngine;\r\n\r\n/// \u003Csummary>\r\n/// 自由相机\r\n/// \u003C/summary>\r\npublic class FreeCamera : MonoBehaviour\r\n{\r\n    [Tooltip(\"水平移动速度\")] public float horizontalSpeed = 50f; //水平移动速度\r\n    [Tooltip(\"垂直移动速度\")] public float verticalSpeed = 10f; //垂直移动速度\r\n    [Tooltip(\"鼠标旋转速度\")] public float rotationSpeed = 2f; //旋转速度\r\n\r\n    private float _rotationX; //上下旋转角度\r\n\r\n    public void Update()\r\n    {\r\n        HandleMove();\r\n        HandleRotate();\r\n    }\r\n\r\n    /// \u003Csummary>\r\n    /// 相机移动\r\n    /// \u003C/summary>\r\n    private void HandleMove()\r\n    {\r\n        //视角平行移动\r\n        var horizontal = Input.GetAxis(\"Horizontal\");\r\n        var vertical = Input.GetAxis(\"Vertical\");\r\n        var direction = horizontalSpeed * Time.deltaTime * new Vector3(horizontal, 0f, vertical);\r\n\r\n        if (Input.GetKey(KeyCode.LeftShift))  //按Shift移动加速\r\n            direction *= 3;\r\n\r\n        transform.Translate(direction);\r\n\r\n        //  控制摄像机垂直移动\r\n        if (Input.GetKey(KeyCode.Q))\r\n            transform.position += transform.up * (verticalSpeed * Time.deltaTime);\r\n        else if (Input.GetKey(KeyCode.E))\r\n            transform.position -= transform.up * (verticalSpeed * Time.deltaTime);\r\n    }\r\n\r\n\r\n    /// \u003Csummary>\r\n    /// 视角旋转\r\n    /// \u003C/summary>\r\n    private void HandleRotate()\r\n    {\r\n        if (Input.GetMouseButton(1))\r\n        {\r\n            var mouseX = Input.GetAxis(\"Mouse X\") * rotationSpeed;\r\n            var mouseY = Input.GetAxis(\"Mouse Y\") * rotationSpeed;\r\n\r\n            _rotationX -= mouseY;\r\n            _rotationX = Mathf.Clamp(_rotationX, -90， 90);\r\n            transform.localRotation = Quaternion.Euler(_rotationX, transform.localEulerAngles.y, 0f);\r\n            transform.Rotate(Vector3.up * mouseX, Space.World);\r\n        }\r\n    }\r\n}\r\n```\r\n\r\n# Unity RTS相机1\r\n```csharp\r\nusing UnityEngine;\r\n\r\npublic class CameraController01 : MonoBehaviour\r\n{\r\n    private Vector3 moveInput;//接收键盘的输入量\r\n    [SerializeField] private float panSpeed;//相机平移的速度\r\n\r\n    [SerializeField] private float scrollSpeed;//鼠标滚动的速度\r\n\r\n    private void Update()\r\n    {\r\n        HandleMovementInput();\r\n    }\r\n\r\n    private void HandleMovementInput()\r\n    {\r\n        //我们其实动态改变的是Main Camera的Trans组件的Pos\r\n        Vector3 pos = transform.position;\r\n\r\n        //moveInput = new Vector3(Input.GetAxisRaw(\"Horizontal\"), 0, Input.GetAxisRaw(\"Vertical\"));//性能？\r\n        moveInput.Set(Input.GetAxisRaw(\"Horizontal\"), 0, Input.GetAxisRaw(\"Vertical\"));\r\n\r\n        Vector2 mousePos = Input.mousePosition;\r\n        if (mousePos.x > Screen.width * 0.9f && mousePos.x \u003C Screen.width)\r\n            moveInput.x = 1;\r\n        if (mousePos.x \u003C Screen.width * 0.1f && mousePos.x > 0)\r\n            moveInput.x = -1;\r\n        if (mousePos.y > Screen.height * 0.9 && mousePos.y \u003C Screen.height)\r\n            moveInput.z = 1;\r\n        if (mousePos.y \u003C Screen.height * 0.1 && mousePos.y > 0)\r\n            moveInput.z = -1;\r\n\r\n        //pos += moveInput * panSpeed * Time.deltaTime;//ERROR\r\n        //pos += moveInput.normalized * panSpeed * Time.deltaTime;//匀速运动，归一化/向量化\r\n\r\n        pos.x += moveInput.normalized.x * panSpeed * Time.deltaTime;\r\n        pos.y += Input.GetAxis(\"Mouse ScrollWheel\") * scrollSpeed * Time.deltaTime;//Y轴滚轮输入量\r\n        pos.z += moveInput.normalized.z * panSpeed * Time.deltaTime;\r\n\r\n        pos.x = Mathf.Clamp(pos.x, -10, 10);\r\n        pos.y = Mathf.Clamp(pos.y, 5, 30);\r\n        pos.z = Mathf.Clamp(pos.z, -25, 5);//根据自己的地图范围进行调整，可以设置为变量，方便嘛！\r\n\r\n        transform.position = pos;\r\n    }\r\n}\r\n```\r\n\r\n# Unity RTS相机2\r\n```csharp\r\nusing System;\r\nusing UnityEngine;\r\n\r\npublic class CameraController02 : MonoBehaviour\r\n{\r\n    private float panSpeed;\r\n    [SerializeField] private float moveTime;//缓冲时间，用于之后的Vector3.Lerp和Quaternion.Lerp方法/函数\r\n    [SerializeField] private float normalSpeed, fastSpeed;\r\n\r\n    private Vector3 newPos;\r\n    private Quaternion newRotation;\r\n    [SerializeField] private float rotationAmount;//旋转的程度\r\n\r\n    private Transform cameraTrans;//子物体嘛～主相机Trans，要改YZ数值\r\n    [SerializeField] private Vector3 zoomAmount;//要改YZ数值，设置zoomAmount结构体中YZ的数值\r\n    private Vector3 newZoom;\r\n\r\n    private Vector3 dragStartPos, dragCurrentPos;//鼠标拖拽的起始点，和鼠标拖拽的当前位置\r\n    private Vector3 rotateStart, rotateCurrent;//鼠标初始位置和当前位置，用来计算相机旋转角度\r\n\r\n    private void Start()\r\n    {\r\n        newPos = transform.position;\r\n        newRotation = transform.rotation;\r\n\r\n        cameraTrans = transform.GetChild(0);\r\n        newZoom = cameraTrans.localPosition;\r\n    }\r\n\r\n    private void Update()\r\n    {\r\n        HandleMovementInput();//通过键盘控制相机\r\n        HandleMouseInput();//通过鼠标控制相机\r\n    }\r\n\r\n    private void HandleMouseInput()\r\n    {\r\n        if(Input.GetMouseButtonDown(1))//鼠标按下一瞬间！\r\n        {\r\n            Plane plane = new Plane(Vector3.up, Vector3.zero);\r\n            Ray ray = Camera.main.ScreenPointToRay(Input.mousePosition);\r\n            float distance;\r\n            if(plane.Raycast(ray, out distance))//out输出参数，一般方法返回一个数值，out则返回return和out数值，2个结果\r\n            {\r\n                dragStartPos = ray.GetPoint(distance);\r\n            }\r\n        }\r\n\r\n        if (Input.GetMouseButton(1))//鼠标按着（当前）\r\n        {\r\n            Plane plane = new Plane(Vector3.up, Vector3.zero);\r\n            Ray ray = Camera.main.ScreenPointToRay(Input.mousePosition);\r\n            float distance;\r\n            if (plane.Raycast(ray, out distance))//out输出参数，一般方法返回一个数值，out则返回return和out数值，2个结果\r\n            {\r\n                dragCurrentPos = ray.GetPoint(distance);\r\n\r\n                Vector3 difference = dragStartPos - dragCurrentPos;//大家可以试试反过来写，效果雷同只是方向相反\r\n                newPos = transform.position + difference;\r\n            }\r\n        }\r\n\r\n        newZoom += Input.mouseScrollDelta.y * zoomAmount;\r\n\r\n        if (Input.GetMouseButtonDown(2))\r\n            rotateStart = Input.mousePosition;\r\n        if(Input.GetMouseButton(2))\r\n        {\r\n            rotateCurrent = Input.mousePosition;\r\n            Vector3 difference = rotateStart - rotateCurrent;\r\n\r\n            rotateStart = rotateCurrent;//赋值最新的鼠标位置\r\n            newRotation *= Quaternion.Euler(Vector3.up * -difference.x / 20);//水平方向触发旋转\r\n            //newRotation *= Quaternion.Euler(Vector3.up * -difference.y / 20);//垂直方向\r\n        }\r\n    }\r\n\r\n    private void HandleMovementInput()\r\n    {\r\n        if (Input.GetKey(KeyCode.LeftShift))\r\n            panSpeed = fastSpeed;\r\n        else\r\n            panSpeed = normalSpeed;\r\n\r\n        if (Input.GetKey(KeyCode.UpArrow) || Input.GetKey(KeyCode.W))\r\n            newPos += transform.forward * panSpeed * Time.deltaTime;//相机平移向上\r\n        if (Input.GetKey(KeyCode.DownArrow) || Input.GetKey(KeyCode.S))\r\n            newPos -= transform.forward * panSpeed * Time.deltaTime;\r\n        if (Input.GetKey(KeyCode.RightArrow) || Input.GetKey(KeyCode.D))\r\n            newPos += transform.right * panSpeed * Time.deltaTime;//相机平移向右\r\n        if(Input.GetKey(KeyCode.LeftArrow) || Input.GetKey(KeyCode.A))\r\n            newPos -= transform.right * panSpeed * Time.deltaTime;\r\n\r\n        if (Input.GetKey(KeyCode.Q))\r\n            newRotation *= Quaternion.Euler(Vector3.up * rotationAmount);//Q：逆时针\r\n        if (Input.GetKey(KeyCode.E))\r\n            newRotation *= Quaternion.Euler(Vector3.down * rotationAmount);//(0,-1,0)顺时针\r\n\r\n        if (Input.GetKey(KeyCode.R))\r\n            newZoom += zoomAmount;//放大功能：Y越来越小，Z越来越大\r\n        if (Input.GetKey(KeyCode.F))\r\n            newZoom -= zoomAmount;//缩小：Y越来越大，Z越来越小\r\n\r\n        //transform.position = newPos;//AxisRaw / Axis\r\n        //Lerp方法：当前位置，目标位置，最大距离：速度 * 时间 =>从当前位置，到目标位置，需要多少时间到达\r\n        transform.position = Vector3.Lerp(transform.position, newPos, moveTime * Time.deltaTime);\r\n\r\n        //transform.rotation = newRotation;\r\n        transform.rotation = Quaternion.Lerp(transform.rotation, newRotation, moveTime * Time.deltaTime);\r\n\r\n        cameraTrans.localPosition = Vector3.Lerp(cameraTrans.localPosition, newZoom, moveTime * Time.deltaTime);\r\n    }\r\n}\r\n```\r\n\r\nrts相机部分代码来自：\r\nhttps://github.com/zheyuanzhou/EP00_RTSCamera/tree/main","src/content/posts/unity_001.md","b902277b5ca97ce6",{"html":70,"metadata":71},"\u003Ch1 id=\"unity-自由相机\">Unity 自由相机\u003C/h1>\n\u003Ch3 id=\"操作方式\">操作方式\u003C/h3>\n\u003Cul>\n\u003Cli>WASD水平移动 (按住左SHIFT加速移动)\u003C/li>\n\u003Cli>QE垂直移动\u003C/li>\n\u003Cli>鼠标右键按下旋转视角\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"代码内容\">代码内容\u003C/h3>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"csharp\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">using\u003C/span>\u003Cspan style=\"color:#B392F0\"> UnityEngine\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">/// &#x3C;\u003C/span>\u003Cspan style=\"color:#85E89D\">summary\u003C/span>\u003Cspan style=\"color:#6A737D\">>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">/// 自由相机\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">/// &#x3C;/\u003C/span>\u003Cspan style=\"color:#85E89D\">summary\u003C/span>\u003Cspan style=\"color:#6A737D\">>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">public\u003C/span>\u003Cspan style=\"color:#F97583\"> class\u003C/span>\u003Cspan style=\"color:#B392F0\"> FreeCamera\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> : \u003C/span>\u003Cspan style=\"color:#B392F0\">MonoBehaviour\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#B392F0\">Tooltip\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"水平移动速度\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)] \u003C/span>\u003Cspan style=\"color:#F97583\">public\u003C/span>\u003Cspan style=\"color:#F97583\"> float\u003C/span>\u003Cspan style=\"color:#B392F0\"> horizontalSpeed\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 50f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">; \u003C/span>\u003Cspan style=\"color:#6A737D\">//水平移动速度\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#B392F0\">Tooltip\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"垂直移动速度\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)] \u003C/span>\u003Cspan style=\"color:#F97583\">public\u003C/span>\u003Cspan style=\"color:#F97583\"> float\u003C/span>\u003Cspan style=\"color:#B392F0\"> verticalSpeed\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 10f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">; \u003C/span>\u003Cspan style=\"color:#6A737D\">//垂直移动速度\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#B392F0\">Tooltip\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"鼠标旋转速度\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)] \u003C/span>\u003Cspan style=\"color:#F97583\">public\u003C/span>\u003Cspan style=\"color:#F97583\"> float\u003C/span>\u003Cspan style=\"color:#B392F0\"> rotationSpeed\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 2f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">; \u003C/span>\u003Cspan style=\"color:#6A737D\">//旋转速度\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> float\u003C/span>\u003Cspan style=\"color:#B392F0\"> _rotationX\u003C/span>\u003Cspan style=\"color:#E1E4E8\">; \u003C/span>\u003Cspan style=\"color:#6A737D\">//上下旋转角度\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    public\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> Update\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        HandleMove\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        HandleRotate\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    /// &#x3C;\u003C/span>\u003Cspan style=\"color:#85E89D\">summary\u003C/span>\u003Cspan style=\"color:#6A737D\">>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    /// 相机移动\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    /// &#x3C;/\u003C/span>\u003Cspan style=\"color:#85E89D\">summary\u003C/span>\u003Cspan style=\"color:#6A737D\">>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> HandleMove\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        //视角平行移动\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        var\u003C/span>\u003Cspan style=\"color:#B392F0\"> horizontal\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetAxis\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Horizontal\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        var\u003C/span>\u003Cspan style=\"color:#B392F0\"> vertical\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetAxis\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Vertical\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        var\u003C/span>\u003Cspan style=\"color:#B392F0\"> direction\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> horizontalSpeed \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Time.deltaTime \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#F97583\"> new\u003C/span>\u003Cspan style=\"color:#B392F0\"> Vector3\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(horizontal, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, vertical);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(KeyCode.LeftShift))  \u003C/span>\u003Cspan style=\"color:#6A737D\">//按Shift移动加速\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            direction \u003C/span>\u003Cspan style=\"color:#F97583\">*=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 3\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        transform.\u003C/span>\u003Cspan style=\"color:#B392F0\">Translate\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(direction);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        //  控制摄像机垂直移动\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(KeyCode.Q))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            transform.position \u003C/span>\u003Cspan style=\"color:#F97583\">+=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> transform.up \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (verticalSpeed \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Time.deltaTime);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        else\u003C/span>\u003Cspan style=\"color:#F97583\"> if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(KeyCode.E))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            transform.position \u003C/span>\u003Cspan style=\"color:#F97583\">-=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> transform.up \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (verticalSpeed \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Time.deltaTime);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    /// &#x3C;\u003C/span>\u003Cspan style=\"color:#85E89D\">summary\u003C/span>\u003Cspan style=\"color:#6A737D\">>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    /// 视角旋转\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    /// &#x3C;/\u003C/span>\u003Cspan style=\"color:#85E89D\">summary\u003C/span>\u003Cspan style=\"color:#6A737D\">>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> HandleRotate\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetMouseButton\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            var\u003C/span>\u003Cspan style=\"color:#B392F0\"> mouseX\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetAxis\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Mouse X\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> rotationSpeed;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            var\u003C/span>\u003Cspan style=\"color:#B392F0\"> mouseY\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetAxis\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Mouse Y\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> rotationSpeed;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            _rotationX \u003C/span>\u003Cspan style=\"color:#F97583\">-=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> mouseY;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            _rotationX \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Mathf.\u003C/span>\u003Cspan style=\"color:#B392F0\">Clamp\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(_rotationX, \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#79B8FF\">90\u003C/span>\u003Cspan style=\"color:#E1E4E8\">， \u003C/span>\u003Cspan style=\"color:#79B8FF\">90\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            transform.localRotation \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Quaternion.\u003C/span>\u003Cspan style=\"color:#B392F0\">Euler\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(_rotationX, transform.localEulerAngles.y, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            transform.\u003C/span>\u003Cspan style=\"color:#B392F0\">Rotate\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(Vector3.up \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> mouseX, Space.World);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch1 id=\"unity-rts相机1\">Unity RTS相机1\u003C/h1>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"csharp\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">using\u003C/span>\u003Cspan style=\"color:#B392F0\"> UnityEngine\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">public\u003C/span>\u003Cspan style=\"color:#F97583\"> class\u003C/span>\u003Cspan style=\"color:#B392F0\"> CameraController01\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> : \u003C/span>\u003Cspan style=\"color:#B392F0\">MonoBehaviour\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#B392F0\"> Vector3\u003C/span>\u003Cspan style=\"color:#B392F0\"> moveInput\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003Cspan style=\"color:#6A737D\">//接收键盘的输入量\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#B392F0\">SerializeField\u003C/span>\u003Cspan style=\"color:#E1E4E8\">] \u003C/span>\u003Cspan style=\"color:#F97583\">private\u003C/span>\u003Cspan style=\"color:#F97583\"> float\u003C/span>\u003Cspan style=\"color:#B392F0\"> panSpeed\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003Cspan style=\"color:#6A737D\">//相机平移的速度\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#B392F0\">SerializeField\u003C/span>\u003Cspan style=\"color:#E1E4E8\">] \u003C/span>\u003Cspan style=\"color:#F97583\">private\u003C/span>\u003Cspan style=\"color:#F97583\"> float\u003C/span>\u003Cspan style=\"color:#B392F0\"> scrollSpeed\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003Cspan style=\"color:#6A737D\">//鼠标滚动的速度\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> Update\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        HandleMovementInput\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> HandleMovementInput\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        //我们其实动态改变的是Main Camera的Trans组件的Pos\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        Vector3\u003C/span>\u003Cspan style=\"color:#B392F0\"> pos\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> transform.position;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        //moveInput = new Vector3(Input.GetAxisRaw(\"Horizontal\"), 0, Input.GetAxisRaw(\"Vertical\"));//性能？\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        moveInput.\u003C/span>\u003Cspan style=\"color:#B392F0\">Set\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetAxisRaw\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Horizontal\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">), \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetAxisRaw\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Vertical\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        Vector2\u003C/span>\u003Cspan style=\"color:#B392F0\"> mousePos\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Input.mousePosition;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (mousePos.x \u003C/span>\u003Cspan style=\"color:#F97583\">>\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Screen.width \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0.9f\u003C/span>\u003Cspan style=\"color:#F97583\"> &#x26;&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> mousePos.x \u003C/span>\u003Cspan style=\"color:#F97583\">&#x3C;\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Screen.width)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            moveInput.x \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (mousePos.x \u003C/span>\u003Cspan style=\"color:#F97583\">&#x3C;\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Screen.width \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0.1f\u003C/span>\u003Cspan style=\"color:#F97583\"> &#x26;&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> mousePos.x \u003C/span>\u003Cspan style=\"color:#F97583\">>\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            moveInput.x \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> -\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (mousePos.y \u003C/span>\u003Cspan style=\"color:#F97583\">>\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Screen.height \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0.9\u003C/span>\u003Cspan style=\"color:#F97583\"> &#x26;&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> mousePos.y \u003C/span>\u003Cspan style=\"color:#F97583\">&#x3C;\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Screen.height)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            moveInput.z \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (mousePos.y \u003C/span>\u003Cspan style=\"color:#F97583\">&#x3C;\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Screen.height \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0.1\u003C/span>\u003Cspan style=\"color:#F97583\"> &#x26;&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> mousePos.y \u003C/span>\u003Cspan style=\"color:#F97583\">>\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            moveInput.z \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> -\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        //pos += moveInput * panSpeed * Time.deltaTime;//ERROR\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        //pos += moveInput.normalized * panSpeed * Time.deltaTime;//匀速运动，归一化/向量化\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        pos.x \u003C/span>\u003Cspan style=\"color:#F97583\">+=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> moveInput.normalized.x \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> panSpeed \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Time.deltaTime;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        pos.y \u003C/span>\u003Cspan style=\"color:#F97583\">+=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetAxis\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Mouse ScrollWheel\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> scrollSpeed \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Time.deltaTime;\u003C/span>\u003Cspan style=\"color:#6A737D\">//Y轴滚轮输入量\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        pos.z \u003C/span>\u003Cspan style=\"color:#F97583\">+=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> moveInput.normalized.z \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> panSpeed \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Time.deltaTime;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        pos.x \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Mathf.\u003C/span>\u003Cspan style=\"color:#B392F0\">Clamp\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pos.x, \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#79B8FF\">10\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">10\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        pos.y \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Mathf.\u003C/span>\u003Cspan style=\"color:#B392F0\">Clamp\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pos.y, \u003C/span>\u003Cspan style=\"color:#79B8FF\">5\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">30\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        pos.z \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Mathf.\u003C/span>\u003Cspan style=\"color:#B392F0\">Clamp\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pos.z, \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#79B8FF\">25\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">5\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003Cspan style=\"color:#6A737D\">//根据自己的地图范围进行调整，可以设置为变量，方便嘛！\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        transform.position \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> pos;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch1 id=\"unity-rts相机2\">Unity RTS相机2\u003C/h1>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"csharp\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">using\u003C/span>\u003Cspan style=\"color:#B392F0\"> System\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">using\u003C/span>\u003Cspan style=\"color:#B392F0\"> UnityEngine\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">public\u003C/span>\u003Cspan style=\"color:#F97583\"> class\u003C/span>\u003Cspan style=\"color:#B392F0\"> CameraController02\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> : \u003C/span>\u003Cspan style=\"color:#B392F0\">MonoBehaviour\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> float\u003C/span>\u003Cspan style=\"color:#B392F0\"> panSpeed\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#B392F0\">SerializeField\u003C/span>\u003Cspan style=\"color:#E1E4E8\">] \u003C/span>\u003Cspan style=\"color:#F97583\">private\u003C/span>\u003Cspan style=\"color:#F97583\"> float\u003C/span>\u003Cspan style=\"color:#B392F0\"> moveTime\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003Cspan style=\"color:#6A737D\">//缓冲时间，用于之后的Vector3.Lerp和Quaternion.Lerp方法/函数\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#B392F0\">SerializeField\u003C/span>\u003Cspan style=\"color:#E1E4E8\">] \u003C/span>\u003Cspan style=\"color:#F97583\">private\u003C/span>\u003Cspan style=\"color:#F97583\"> float\u003C/span>\u003Cspan style=\"color:#B392F0\"> normalSpeed\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">fastSpeed\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#B392F0\"> Vector3\u003C/span>\u003Cspan style=\"color:#B392F0\"> newPos\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#B392F0\"> Quaternion\u003C/span>\u003Cspan style=\"color:#B392F0\"> newRotation\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#B392F0\">SerializeField\u003C/span>\u003Cspan style=\"color:#E1E4E8\">] \u003C/span>\u003Cspan style=\"color:#F97583\">private\u003C/span>\u003Cspan style=\"color:#F97583\"> float\u003C/span>\u003Cspan style=\"color:#B392F0\"> rotationAmount\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003Cspan style=\"color:#6A737D\">//旋转的程度\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#B392F0\"> Transform\u003C/span>\u003Cspan style=\"color:#B392F0\"> cameraTrans\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003Cspan style=\"color:#6A737D\">//子物体嘛～主相机Trans，要改YZ数值\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#B392F0\">SerializeField\u003C/span>\u003Cspan style=\"color:#E1E4E8\">] \u003C/span>\u003Cspan style=\"color:#F97583\">private\u003C/span>\u003Cspan style=\"color:#B392F0\"> Vector3\u003C/span>\u003Cspan style=\"color:#B392F0\"> zoomAmount\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003Cspan style=\"color:#6A737D\">//要改YZ数值，设置zoomAmount结构体中YZ的数值\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#B392F0\"> Vector3\u003C/span>\u003Cspan style=\"color:#B392F0\"> newZoom\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#B392F0\"> Vector3\u003C/span>\u003Cspan style=\"color:#B392F0\"> dragStartPos\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">dragCurrentPos\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003Cspan style=\"color:#6A737D\">//鼠标拖拽的起始点，和鼠标拖拽的当前位置\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#B392F0\"> Vector3\u003C/span>\u003Cspan style=\"color:#B392F0\"> rotateStart\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">rotateCurrent\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003Cspan style=\"color:#6A737D\">//鼠标初始位置和当前位置，用来计算相机旋转角度\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> Start\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        newPos \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> transform.position;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        newRotation \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> transform.rotation;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        cameraTrans \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> transform.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetChild\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        newZoom \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> cameraTrans.localPosition;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> Update\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        HandleMovementInput\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003Cspan style=\"color:#6A737D\">//通过键盘控制相机\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        HandleMouseInput\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003Cspan style=\"color:#6A737D\">//通过鼠标控制相机\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> HandleMouseInput\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetMouseButtonDown\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">))\u003C/span>\u003Cspan style=\"color:#6A737D\">//鼠标按下一瞬间！\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            Plane\u003C/span>\u003Cspan style=\"color:#B392F0\"> plane\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#F97583\"> new\u003C/span>\u003Cspan style=\"color:#B392F0\"> Plane\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(Vector3.up, Vector3.zero);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            Ray\u003C/span>\u003Cspan style=\"color:#B392F0\"> ray\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Camera.main.\u003C/span>\u003Cspan style=\"color:#B392F0\">ScreenPointToRay\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(Input.mousePosition);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            float\u003C/span>\u003Cspan style=\"color:#B392F0\"> distance\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            if\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(plane.\u003C/span>\u003Cspan style=\"color:#B392F0\">Raycast\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(ray, \u003C/span>\u003Cspan style=\"color:#F97583\">out\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> distance))\u003C/span>\u003Cspan style=\"color:#6A737D\">//out输出参数，一般方法返回一个数值，out则返回return和out数值，2个结果\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                dragStartPos \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ray.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetPoint\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(distance);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetMouseButton\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">))\u003C/span>\u003Cspan style=\"color:#6A737D\">//鼠标按着（当前）\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            Plane\u003C/span>\u003Cspan style=\"color:#B392F0\"> plane\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#F97583\"> new\u003C/span>\u003Cspan style=\"color:#B392F0\"> Plane\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(Vector3.up, Vector3.zero);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            Ray\u003C/span>\u003Cspan style=\"color:#B392F0\"> ray\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Camera.main.\u003C/span>\u003Cspan style=\"color:#B392F0\">ScreenPointToRay\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(Input.mousePosition);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            float\u003C/span>\u003Cspan style=\"color:#B392F0\"> distance\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (plane.\u003C/span>\u003Cspan style=\"color:#B392F0\">Raycast\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(ray, \u003C/span>\u003Cspan style=\"color:#F97583\">out\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> distance))\u003C/span>\u003Cspan style=\"color:#6A737D\">//out输出参数，一般方法返回一个数值，out则返回return和out数值，2个结果\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                dragCurrentPos \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ray.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetPoint\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(distance);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                Vector3\u003C/span>\u003Cspan style=\"color:#B392F0\"> difference\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> dragStartPos \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> dragCurrentPos;\u003C/span>\u003Cspan style=\"color:#6A737D\">//大家可以试试反过来写，效果雷同只是方向相反\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                newPos \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> transform.position \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> difference;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        newZoom \u003C/span>\u003Cspan style=\"color:#F97583\">+=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Input.mouseScrollDelta.y \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> zoomAmount;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetMouseButtonDown\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            rotateStart \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Input.mousePosition;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetMouseButton\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            rotateCurrent \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Input.mousePosition;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            Vector3\u003C/span>\u003Cspan style=\"color:#B392F0\"> difference\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> rotateStart \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> rotateCurrent;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            rotateStart \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> rotateCurrent;\u003C/span>\u003Cspan style=\"color:#6A737D\">//赋值最新的鼠标位置\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            newRotation \u003C/span>\u003Cspan style=\"color:#F97583\">*=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Quaternion.\u003C/span>\u003Cspan style=\"color:#B392F0\">Euler\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(Vector3.up \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#F97583\"> -\u003C/span>\u003Cspan style=\"color:#E1E4E8\">difference.x \u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 20\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003Cspan style=\"color:#6A737D\">//水平方向触发旋转\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            //newRotation *= Quaternion.Euler(Vector3.up * -difference.y / 20);//垂直方向\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> HandleMovementInput\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(KeyCode.LeftShift))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            panSpeed \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> fastSpeed;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        else\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            panSpeed \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> normalSpeed;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(KeyCode.UpArrow) \u003C/span>\u003Cspan style=\"color:#F97583\">||\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(KeyCode.W))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            newPos \u003C/span>\u003Cspan style=\"color:#F97583\">+=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> transform.forward \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> panSpeed \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Time.deltaTime;\u003C/span>\u003Cspan style=\"color:#6A737D\">//相机平移向上\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(KeyCode.DownArrow) \u003C/span>\u003Cspan style=\"color:#F97583\">||\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(KeyCode.S))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            newPos \u003C/span>\u003Cspan style=\"color:#F97583\">-=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> transform.forward \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> panSpeed \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Time.deltaTime;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(KeyCode.RightArrow) \u003C/span>\u003Cspan style=\"color:#F97583\">||\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(KeyCode.D))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            newPos \u003C/span>\u003Cspan style=\"color:#F97583\">+=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> transform.right \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> panSpeed \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Time.deltaTime;\u003C/span>\u003Cspan style=\"color:#6A737D\">//相机平移向右\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(KeyCode.LeftArrow) \u003C/span>\u003Cspan style=\"color:#F97583\">||\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(KeyCode.A))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            newPos \u003C/span>\u003Cspan style=\"color:#F97583\">-=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> transform.right \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> panSpeed \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Time.deltaTime;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(KeyCode.Q))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            newRotation \u003C/span>\u003Cspan style=\"color:#F97583\">*=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Quaternion.\u003C/span>\u003Cspan style=\"color:#B392F0\">Euler\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(Vector3.up \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> rotationAmount);\u003C/span>\u003Cspan style=\"color:#6A737D\">//Q：逆时针\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(KeyCode.E))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            newRotation \u003C/span>\u003Cspan style=\"color:#F97583\">*=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Quaternion.\u003C/span>\u003Cspan style=\"color:#B392F0\">Euler\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(Vector3.down \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> rotationAmount);\u003C/span>\u003Cspan style=\"color:#6A737D\">//(0,-1,0)顺时针\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(KeyCode.R))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            newZoom \u003C/span>\u003Cspan style=\"color:#F97583\">+=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> zoomAmount;\u003C/span>\u003Cspan style=\"color:#6A737D\">//放大功能：Y越来越小，Z越来越大\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(KeyCode.F))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            newZoom \u003C/span>\u003Cspan style=\"color:#F97583\">-=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> zoomAmount;\u003C/span>\u003Cspan style=\"color:#6A737D\">//缩小：Y越来越大，Z越来越小\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        //transform.position = newPos;//AxisRaw / Axis\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        //Lerp方法：当前位置，目标位置，最大距离：速度 * 时间 =>从当前位置，到目标位置，需要多少时间到达\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        transform.position \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Vector3.\u003C/span>\u003Cspan style=\"color:#B392F0\">Lerp\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(transform.position, newPos, moveTime \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Time.deltaTime);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        //transform.rotation = newRotation;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        transform.rotation \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Quaternion.\u003C/span>\u003Cspan style=\"color:#B392F0\">Lerp\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(transform.rotation, newRotation, moveTime \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Time.deltaTime);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        cameraTrans.localPosition \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Vector3.\u003C/span>\u003Cspan style=\"color:#B392F0\">Lerp\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(cameraTrans.localPosition, newZoom, moveTime \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Time.deltaTime);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>rts相机部分代码来自：\r\n\u003Ca href=\"https://github.com/zheyuanzhou/EP00_RTSCamera/tree/main\">https://github.com/zheyuanzhou/EP00_RTSCamera/tree/main\u003C/a>\u003C/p>",{"headings":72,"localImagePaths":86,"remoteImagePaths":87,"frontmatter":65,"imagePaths":88},[73,76,78,80,83],{"depth":20,"slug":74,"text":75},"unity-自由相机","Unity 自由相机",{"depth":47,"slug":77,"text":77},"操作方式",{"depth":47,"slug":79,"text":79},"代码内容",{"depth":20,"slug":81,"text":82},"unity-rts相机1","Unity RTS相机1",{"depth":20,"slug":84,"text":85},"unity-rts相机2","Unity RTS相机2",[],[],[],"unity_001.md","post_20251226070813",{"id":90,"data":92,"body":93,"filePath":94,"digest":95,"rendered":96,"legacyId":151},{},"# Unity 无人机物理模拟开发日志：从零打造穿越机手感\r\n\r\n> **摘要**：本文记录了在 Unity 中构建一个高拟真 FPV 穿越机（Drone）物理模拟系统的过程。从基础的 PID 控制到引入空气动力学阻力、地面效应和电机惯性，一步步逼近真实的飞行手感。\r\n\r\n---\r\n环境：`Unity 2022.3.57c1f1` `Window10`  \r\n\r\n\r\n![cad859e8da0f4a42b86025f0b7122778.png](/uploads/images/1766733359777-825864655.png)\r\n\r\n\r\n### 开源仓库地址\r\n[Unity引擎开发的无人机模拟系统](https://gitee.com/youlai-code/unity-drone.git)\r\n### 演示视频：  \r\n[Unity无人机仿真-bilbil](https://www.bilibili.com/video/BV1Y8BVB9Edu/?share_source=copy_web&vd_source=996906670f4a2574b3c77132cb5ebda3)\r\n\u003Ciframe src=\"//player.bilibili.com/player.html?isOutside=true&aid=115772286377550&bvid=BV1Y8BVB9Edu&cid=34941700066&p=1\" scrolling=\"no\" border=\"0\" frameborder=\"no\" framespacing=\"0\" allowfullscreen=\"true\">\u003C/iframe>\r\n\r\n---\r\n# 功能介绍\r\n##  输入系统\r\n\r\n最初的实现使用键盘鼠标控制，但这对于模拟穿越机来说完全不够。真实的穿越机需要细腻的模拟量输入。\r\n\r\n\r\n![Gemini_Generated_Image_gczo5ggczo5ggczo.jpg](/uploads/images/1766732941939-2276967.jpg)\r\n\r\n\r\n---\r\n\r\n## 核心物理引擎\r\n\r\nUnity 的 `Rigidbody` 提供了基础物理，但要飞得像穿越机，必须手动计算力和力矩。\r\n\r\n### PID 控制器 (Rate Loop)\r\n这是飞控的灵魂。我们实现了三个独立的 PID 控制器分别控制 Pitch、Roll 和 Yaw 的**角速度**。\r\n**PID**的介绍请看我的另外一篇文档：  [PID算法](https://blog.csdn.net/wa36d/article/details/145108722?spm=1001.2014.3001.5502)\r\n*   **目标**：摇杆输入 = 目标角速度（例如满杆 200度/秒）。\r\n*   **反馈**：`rb.angularVelocity`。\r\n*   **输出**：PID 计算出的修正力矩。\r\n\r\n### 混控器 (Mixer)\r\n将 PID 输出分配到四个电机。采用标准的 **Quad X** 布局：\r\n\r\n\r\n\r\n![d09f547e541e4fbeaf68b5022ca118d2.png](/uploads/images/1766734335095-585963069.png)\r\n\r\n```csharp\r\n// FL (左前): +Pitch +Roll -Yaw\r\n// FR (右前): +Pitch -Roll +Yaw\r\n// BL (左后): -Pitch +Roll +Yaw\r\n// BR (右后): -Pitch -Roll -Yaw\r\n```\r\n---\r\n\r\n## 物理细节的打磨\r\n\r\n基础 PID 能飞，但手感像“在真空中飞行”或者“完美的刚体”。为了真实感，我引入了三个关键特性：\r\n\r\n### 电机惯性 (Motor Inertia)\r\n真实的电机从 0 加速到 100% 需要时间。\r\n*   **实现**：使用 `Mathf.Lerp` 对油门输入进行低通滤波。\r\n*   **效果**：消除了“瞬移般”的响应，给油门带来了一丝“肉”感和延迟，极大提升了重量感。\r\n```csharp\r\n    // 更新动力 (在 FlightController 的 FixedUpdate 中调用)\r\n    public void UpdatePhysics(float targetThrottle)\r\n    {\r\n        // 模拟电机惯性 (一阶低通滤波)\r\n        // 从当前油门平滑过渡到目标油门\r\n        float dt = Time.fixedDeltaTime;\r\n        currentThrottle = Mathf.Lerp(currentThrottle, targetThrottle, dt * motorResponseSpeed);\r\n\r\n        // 1. 施加升力 (垂直于机臂向上)\r\n        Vector3 force = transform.up * (currentThrottle * maxThrust);\r\n        rb.AddForceAtPosition(force, transform.position);\r\n\r\n        // 2. 施加反扭矩 (Yaw控制)\r\n        // 顺时针旋转的电机，会给机身施加逆时针的扭矩，反之亦然\r\n        float torqueDir = isClockwise ? -1f : 1f;\r\n        float torqueMagnitude = currentThrottle * maxThrust * torqueFactor * torqueDir;\r\n        rb.AddTorque(transform.up * torqueMagnitude, ForceMode.Force);\r\n    }\r\n```\r\n### 地面效应 (Ground Effect)\r\n当无人机贴近地面时，下洗气流受阻，升力会增加。\r\n*   **实现**：向下发射射线检测高度。高度 \u003C 0.5m 时，根据距离非线性增加升力系数。\r\n*   **效果**：降落时会有明显的“气垫感”，不会直接“砸”向地面，起飞也更轻盈。\r\n```csharp\r\n            // --- 地面效应 (Ground Effect) ---\r\n            RaycastHit hit;\r\n            if (Physics.Raycast(transform.position, Vector3.down, out hit, groundEffectMaxHeight))\r\n            {\r\n                float ratio = 1.0f - (hit.distance / groundEffectMaxHeight);\r\n                float groundEffectMultiplier = 1.0f + (ratio * groundEffectLiftFactor);\r\n                \r\n                m1 *= groundEffectMultiplier;\r\n                m2 *= groundEffectMultiplier;\r\n                m3 *= groundEffectMultiplier;\r\n                m4 *= groundEffectMultiplier;\r\n            }\r\n```\r\n### 非线性空气阻力 (Quadratic Drag)\r\nUnity 默认的 `Drag` 是线性的 ($F \\propto v$)，这让无人机感觉像在水里游。\r\n*   **实现**：手动计算平方阻力 $F = -v \\cdot |v| \\cdot k$。\r\n*   **差异化阻力**：\r\n    *   **垂直方向**：机身扁平，阻力系数大 (1.0)。下落会有明显的终端速度。\r\n    *   **水平方向**：机身流线，阻力系数小 (0.2)。允许长距离惯性滑行。\r\n*   **效果**：这是手感提升最明显的一步。前飞松杆后的滑行感，以及高空下落时的速度平衡，都非常接近真机。\r\n```csharp\r\n        // 计算平方阻力: F = -v * |v| * dragFactor\r\n        Vector3 dragForceLocal = Vector3.zero;\r\n        dragForceLocal.x = -localVel.x * Mathf.Abs(localVel.x) * dragFactors.x;\r\n        dragForceLocal.y = -localVel.y * Mathf.Abs(localVel.y) * dragFactors.y; // 垂直阻力通常较大\r\n        dragForceLocal.z = -localVel.z * Mathf.Abs(localVel.z) * dragFactors.z;\r\n```\r\n---\r\n\r\n## 飞行模式\r\n\r\n无人机操作一共配置了两种模式\r\n### Acro Mode (手动模式)\r\n*   **逻辑**：摇杆控制**角速度**。松杆后无人机保持当前姿态。\r\n### Angle Mode (自稳模式)\r\n*   **逻辑**：**双环 PID 控制**。\r\n    *   **外环**：摇杆控制**角度** (例如满杆 45 度)。计算出目标角速度。\r\n    *   **内环**：执行目标角速度。\r\n*   **特性**：松杆自动回平。\r\n```csharp\r\n       if (mode == FlightMode.Angle)\r\n        {\r\n            // --- Angle Mode (自稳模式) ---\r\n            // 摇杆输入映射为目标角度 (-45 ~ 45 度)\r\n            float targetPitchAngle = input.Pitch * maxTiltAngle;\r\n            float targetRollAngle = -input.Roll * maxTiltAngle; // Unity Z轴旋转方向可能需要反转\r\n\r\n            // 获取当前角度 (将 0-360 转换为 +/- 180)\r\n            Vector3 currentEuler = transform.localEulerAngles;\r\n            float currentPitch = Mathf.DeltaAngle(0, currentEuler.x);\r\n            float currentRoll = Mathf.DeltaAngle(0, currentEuler.z);\r\n\r\n            // 外环 P 控制: 角度误差 -> 目标角速度\r\n            // Pitch: 目标 - 当前 (因为后面混控器 Pitch 反转了，所以这里保持 目标-当前)\r\n            targetPitchRate = (targetPitchAngle - currentPitch) * angleKP;\r\n            \r\n            // Roll: 当前 - 目标 (反转逻辑，防止正反馈翻滚)\r\n            // 右滚是负角度，如果不反转，误差为正，导致继续右滚\r\n            targetRollRate = (currentRoll - targetRollAngle) * angleKP;\r\n            \r\n            // Yaw 轴通常保持 Rate 模式\r\n            targetYawRate = input.Yaw * 150f;\r\n        }\r\n        else\r\n        {\r\n            // --- Acro Mode (特技/手动模式) ---\r\n            // 摇杆输入直接映射为目标角速度 (-200 ~ 200 度/秒)\r\n            targetPitchRate = input.Pitch * 200f;\r\n            targetRollRate = input.Roll * 200f;\r\n            targetYawRate = input.Yaw * 150f;\r\n        }\r\n```\r\n---\r\n\r\n## 稳定性与体验优化\r\n\r\n除了核心物理，还有很多细节决定了模拟器的可用性：\r\n\r\n*   **怠速保护 (Idle Protection)**：\r\n    *   问题：地面待机时，PID 积分项累积导致无人机“抽搐”或乱跳。\r\n    *   解决：油门 \u003C 5% 时，强制关闭电机并 **Reset PID**。\r\n```csharp\r\n        // --- 怠速保护逻辑 ---\r\n        if (throttleBase \u003C 0.05f)\r\n        {\r\n            m1 = m2 = m3 = m4 = 0f;\r\n            pitchPID.Reset();\r\n            rollPID.Reset();\r\n            yawPID.Reset();\r\n        }\r\n```\r\n*   **PID 限幅 (Authority Limit)**：\r\n    *   限制 PID 对电机的最大控制权 (例如 30%)，防止极端情况下 PID 输出过大导致电机饱和甚至侧翻。\r\n   ```csharp\r\n            // --- PID 限幅保护 ---\r\n            float pOut = Mathf.Clamp(pitchCorrection * correctionScale, -maxPIDAuthority, maxPIDAuthority);\r\n            float rOut = Mathf.Clamp(rollCorrection * correctionScale, -maxPIDAuthority, maxPIDAuthority);\r\n            float yOut = Mathf.Clamp(yawCorrection * correctionScale, -maxPIDAuthority, maxPIDAuthority); \r\n   ```\r\n*   **一键重置**：\r\n    *   添加手柄 **Y 键** 复位功能，炸机后瞬间回到原点并清空物理速度，方便反复练习。\r\n\r\n---\r\n# 二、源码\r\n## 代码结构\r\n代码结构比较简单，一共就4个代码就实现了整个无人机模拟，以下是流程图：\r\n\r\n![Gemini_Generated_Image_v4l1irv4l1irv4l1.jpg](/uploads/images/1766732962738-221925025.jpg)\r\n\r\n| 架构分层   | 核心脚本              | 角色定位         | 主要功能与逻辑                                                                                                                                                                                | 数据流向 / 物理作用                                                            |\r\n| ---------- | --------------------- | ---------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------ |\r\n| **输入层** | `DroneInput.cs`       | **信号预处理**   | 1. **读取硬件**：接收物理手柄输入。\u003Cbr> 2. **数据清洗**：处理摇杆死区、应用映射曲线。                                                                                                             | **输出**：标准化控制信号\u003Cbr>• 油门 (Throttle): `0 ~ 1` \u003Cbr>•俯仰/横滚/偏航: `-1 ~ 1`   |\r\n| **控制层** | `FlightController.cs` | **大脑 (Brain)** | 1. **模式处理**：根据 Angle/Acro 模式将输入转为目标角速度。\u003Cbr>2. **PID 调度**：调用 `PID.cs` 计算误差。\u003Cbr> 3. **混控 (Mixer)**：混合主油门与 PID 修正值。\u003Cbr>  4. **环境模拟**：计算非线性阻力与地面效应。 | **输入**：标准化信号 + 刚体物理状态\u003Cbr>**输出**：4 个电机的最终目标油门            |\r\n| **算法层** | `PID.cs`              | **纯数学计算**   | 1. **误差计算**：对比目标值与当前值。\u003Cbr>2. **修正输出**：计算比例(P)+积分(I)+微分(D)的总和。                                                                                                     | **输入**：目标值、当前值、时间差 (dt)\u003Cbr>**输出**：PID 修正值                      |\r\n| **执行层** | `MotorEngine.cs`      | **四肢 (Limbs)** | 1. **惯性模拟**：通过低通滤波模拟电机响应延迟。\u003Cbr>2. **物理交互**：将油门值转换为具体的物理力。                                                                                                  | **输入**：目标油门值\u003Cbr>**作用**：向 Rigidbody 施加\u003Cbr>• 推力 (Force)\u003Cbr>• 反扭矩 (Torque) |\r\n\r\n# 总结\r\n\r\n通过以上步骤，我们从一个简单的刚体运动，进化到了一个具备空气动力学特性的飞行模拟器。目前的物理手感已经能传达出穿越机的“惯性”和“风阻”。\r\n\r\n如果能帮助到你！可以给我来个点赞吗？ 谢谢！u😘","src/content/posts/post_20251226070813.md","0552735030f0481d",{"html":97,"metadata":98},"\u003Ch1 id=\"unity-无人机物理模拟开发日志从零打造穿越机手感\">Unity 无人机物理模拟开发日志：从零打造穿越机手感\u003C/h1>\n\u003Cblockquote>\n\u003Cp>\u003Cstrong>摘要\u003C/strong>：本文记录了在 Unity 中构建一个高拟真 FPV 穿越机（Drone）物理模拟系统的过程。从基础的 PID 控制到引入空气动力学阻力、地面效应和电机惯性，一步步逼近真实的飞行手感。\u003C/p>\n\u003C/blockquote>\n\u003Chr>\n\u003Cp>环境：\u003Ccode>Unity 2022.3.57c1f1\u003C/code> \u003Ccode>Window10\u003C/code>\u003C/p>\n\u003Cp>\u003Cimg src=\"/uploads/images/1766733359777-825864655.png\" alt=\"cad859e8da0f4a42b86025f0b7122778.png\">\u003C/p>\n\u003Ch3 id=\"开源仓库地址\">开源仓库地址\u003C/h3>\n\u003Cp>\u003Ca href=\"https://gitee.com/youlai-code/unity-drone.git\">Unity引擎开发的无人机模拟系统\u003C/a>\u003C/p>\n\u003Ch3 id=\"演示视频\">演示视频：\u003C/h3>\n\u003Cp>\u003Ca href=\"https://www.bilibili.com/video/BV1Y8BVB9Edu/?share_source=copy_web&#x26;vd_source=996906670f4a2574b3c77132cb5ebda3\">Unity无人机仿真-bilbil\u003C/a>\u003C/p>\n\u003Ciframe src=\"//player.bilibili.com/player.html?isOutside=true&#x26;aid=115772286377550&#x26;bvid=BV1Y8BVB9Edu&#x26;cid=34941700066&#x26;p=1\" scrolling=\"no\" border=\"0\" frameborder=\"no\" framespacing=\"0\" allowfullscreen=\"true\">\u003C/iframe>\n\u003Chr>\n\u003Ch1 id=\"功能介绍\">功能介绍\u003C/h1>\n\u003Ch2 id=\"输入系统\">输入系统\u003C/h2>\n\u003Cp>最初的实现使用键盘鼠标控制，但这对于模拟穿越机来说完全不够。真实的穿越机需要细腻的模拟量输入。\u003C/p>\n\u003Cp>\u003Cimg src=\"/uploads/images/1766732941939-2276967.jpg\" alt=\"Gemini_Generated_Image_gczo5ggczo5ggczo.jpg\">\u003C/p>\n\u003Chr>\n\u003Ch2 id=\"核心物理引擎\">核心物理引擎\u003C/h2>\n\u003Cp>Unity 的 \u003Ccode>Rigidbody\u003C/code> 提供了基础物理，但要飞得像穿越机，必须手动计算力和力矩。\u003C/p>\n\u003Ch3 id=\"pid-控制器-rate-loop\">PID 控制器 (Rate Loop)\u003C/h3>\n\u003Cp>这是飞控的灵魂。我们实现了三个独立的 PID 控制器分别控制 Pitch、Roll 和 Yaw 的\u003Cstrong>角速度\u003C/strong>。\r\n\u003Cstrong>PID\u003C/strong>的介绍请看我的另外一篇文档：  \u003Ca href=\"https://blog.csdn.net/wa36d/article/details/145108722?spm=1001.2014.3001.5502\">PID算法\u003C/a>\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cstrong>目标\u003C/strong>：摇杆输入 = 目标角速度（例如满杆 200度/秒）。\u003C/li>\n\u003Cli>\u003Cstrong>反馈\u003C/strong>：\u003Ccode>rb.angularVelocity\u003C/code>。\u003C/li>\n\u003Cli>\u003Cstrong>输出\u003C/strong>：PID 计算出的修正力矩。\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"混控器-mixer\">混控器 (Mixer)\u003C/h3>\n\u003Cp>将 PID 输出分配到四个电机。采用标准的 \u003Cstrong>Quad X\u003C/strong> 布局：\u003C/p>\n\u003Cp>\u003Cimg src=\"/uploads/images/1766734335095-585963069.png\" alt=\"d09f547e541e4fbeaf68b5022ca118d2.png\">\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"csharp\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// FL (左前): +Pitch +Roll -Yaw\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// FR (右前): +Pitch -Roll +Yaw\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// BL (左后): -Pitch +Roll +Yaw\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// BR (右后): -Pitch -Roll -Yaw\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Chr>\n\u003Ch2 id=\"物理细节的打磨\">物理细节的打磨\u003C/h2>\n\u003Cp>基础 PID 能飞，但手感像“在真空中飞行”或者“完美的刚体”。为了真实感，我引入了三个关键特性：\u003C/p>\n\u003Ch3 id=\"电机惯性-motor-inertia\">电机惯性 (Motor Inertia)\u003C/h3>\n\u003Cp>真实的电机从 0 加速到 100% 需要时间。\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cstrong>实现\u003C/strong>：使用 \u003Ccode>Mathf.Lerp\u003C/code> 对油门输入进行低通滤波。\u003C/li>\n\u003Cli>\u003Cstrong>效果\u003C/strong>：消除了“瞬移般”的响应，给油门带来了一丝“肉”感和延迟，极大提升了重量感。\u003C/li>\n\u003C/ul>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"csharp\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 更新动力 (在 FlightController 的 FixedUpdate 中调用)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    public\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> UpdatePhysics\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">float\u003C/span>\u003Cspan style=\"color:#B392F0\"> targetThrottle\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // 模拟电机惯性 (一阶低通滤波)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // 从当前油门平滑过渡到目标油门\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        float\u003C/span>\u003Cspan style=\"color:#B392F0\"> dt\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Time.fixedDeltaTime;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        currentThrottle \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Mathf.\u003C/span>\u003Cspan style=\"color:#B392F0\">Lerp\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(currentThrottle, targetThrottle, dt \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> motorResponseSpeed);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // 1. 施加升力 (垂直于机臂向上)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        Vector3\u003C/span>\u003Cspan style=\"color:#B392F0\"> force\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> transform.up \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (currentThrottle \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> maxThrust);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        rb.\u003C/span>\u003Cspan style=\"color:#B392F0\">AddForceAtPosition\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(force, transform.position);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // 2. 施加反扭矩 (Yaw控制)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // 顺时针旋转的电机，会给机身施加逆时针的扭矩，反之亦然\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        float\u003C/span>\u003Cspan style=\"color:#B392F0\"> torqueDir\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> isClockwise \u003C/span>\u003Cspan style=\"color:#F97583\">?\u003C/span>\u003Cspan style=\"color:#F97583\"> -\u003C/span>\u003Cspan style=\"color:#79B8FF\">1f\u003C/span>\u003Cspan style=\"color:#F97583\"> :\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        float\u003C/span>\u003Cspan style=\"color:#B392F0\"> torqueMagnitude\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> currentThrottle \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> maxThrust \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> torqueFactor \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> torqueDir;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        rb.\u003C/span>\u003Cspan style=\"color:#B392F0\">AddTorque\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(transform.up \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> torqueMagnitude, ForceMode.Force);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch3 id=\"地面效应-ground-effect\">地面效应 (Ground Effect)\u003C/h3>\n\u003Cp>当无人机贴近地面时，下洗气流受阻，升力会增加。\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cstrong>实现\u003C/strong>：向下发射射线检测高度。高度 &#x3C; 0.5m 时，根据距离非线性增加升力系数。\u003C/li>\n\u003Cli>\u003Cstrong>效果\u003C/strong>：降落时会有明显的“气垫感”，不会直接“砸”向地面，起飞也更轻盈。\u003C/li>\n\u003C/ul>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"csharp\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            // --- 地面效应 (Ground Effect) ---\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            RaycastHit\u003C/span>\u003Cspan style=\"color:#B392F0\"> hit\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Physics.\u003C/span>\u003Cspan style=\"color:#B392F0\">Raycast\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(transform.position, Vector3.down, \u003C/span>\u003Cspan style=\"color:#F97583\">out\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> hit, groundEffectMaxHeight))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                float\u003C/span>\u003Cspan style=\"color:#B392F0\"> ratio\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1.0f\u003C/span>\u003Cspan style=\"color:#F97583\"> -\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (hit.distance \u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> groundEffectMaxHeight);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                float\u003C/span>\u003Cspan style=\"color:#B392F0\"> groundEffectMultiplier\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1.0f\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (ratio \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> groundEffectLiftFactor);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                m1 \u003C/span>\u003Cspan style=\"color:#F97583\">*=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> groundEffectMultiplier;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                m2 \u003C/span>\u003Cspan style=\"color:#F97583\">*=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> groundEffectMultiplier;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                m3 \u003C/span>\u003Cspan style=\"color:#F97583\">*=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> groundEffectMultiplier;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                m4 \u003C/span>\u003Cspan style=\"color:#F97583\">*=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> groundEffectMultiplier;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            }\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch3 id=\"非线性空气阻力-quadratic-drag\">非线性空气阻力 (Quadratic Drag)\u003C/h3>\n\u003Cp>Unity 默认的 \u003Ccode>Drag\u003C/code> 是线性的 ($F \\propto v$)，这让无人机感觉像在水里游。\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cstrong>实现\u003C/strong>：手动计算平方阻力 $F = -v \\cdot |v| \\cdot k$。\u003C/li>\n\u003Cli>\u003Cstrong>差异化阻力\u003C/strong>：\n\u003Cul>\n\u003Cli>\u003Cstrong>垂直方向\u003C/strong>：机身扁平，阻力系数大 (1.0)。下落会有明显的终端速度。\u003C/li>\n\u003Cli>\u003Cstrong>水平方向\u003C/strong>：机身流线，阻力系数小 (0.2)。允许长距离惯性滑行。\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\u003Cstrong>效果\u003C/strong>：这是手感提升最明显的一步。前飞松杆后的滑行感，以及高空下落时的速度平衡，都非常接近真机。\u003C/li>\n\u003C/ul>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"csharp\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // 计算平方阻力: F = -v * |v| * dragFactor\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        Vector3\u003C/span>\u003Cspan style=\"color:#B392F0\"> dragForceLocal\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Vector3.zero;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        dragForceLocal.x \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> -\u003C/span>\u003Cspan style=\"color:#E1E4E8\">localVel.x \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Mathf.\u003C/span>\u003Cspan style=\"color:#B392F0\">Abs\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(localVel.x) \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> dragFactors.x;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        dragForceLocal.y \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> -\u003C/span>\u003Cspan style=\"color:#E1E4E8\">localVel.y \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Mathf.\u003C/span>\u003Cspan style=\"color:#B392F0\">Abs\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(localVel.y) \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> dragFactors.y; \u003C/span>\u003Cspan style=\"color:#6A737D\">// 垂直阻力通常较大\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        dragForceLocal.z \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> -\u003C/span>\u003Cspan style=\"color:#E1E4E8\">localVel.z \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Mathf.\u003C/span>\u003Cspan style=\"color:#B392F0\">Abs\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(localVel.z) \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> dragFactors.z;\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Chr>\n\u003Ch2 id=\"飞行模式\">飞行模式\u003C/h2>\n\u003Cp>无人机操作一共配置了两种模式\u003C/p>\n\u003Ch3 id=\"acro-mode-手动模式\">Acro Mode (手动模式)\u003C/h3>\n\u003Cul>\n\u003Cli>\u003Cstrong>逻辑\u003C/strong>：摇杆控制\u003Cstrong>角速度\u003C/strong>。松杆后无人机保持当前姿态。\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"angle-mode-自稳模式\">Angle Mode (自稳模式)\u003C/h3>\n\u003Cul>\n\u003Cli>\u003Cstrong>逻辑\u003C/strong>：\u003Cstrong>双环 PID 控制\u003C/strong>。\n\u003Cul>\n\u003Cli>\u003Cstrong>外环\u003C/strong>：摇杆控制\u003Cstrong>角度\u003C/strong> (例如满杆 45 度)。计算出目标角速度。\u003C/li>\n\u003Cli>\u003Cstrong>内环\u003C/strong>：执行目标角速度。\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\u003Cstrong>特性\u003C/strong>：松杆自动回平。\u003C/li>\n\u003C/ul>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"csharp\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">       if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (mode \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> FlightMode.Angle)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            // --- Angle Mode (自稳模式) ---\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            // 摇杆输入映射为目标角度 (-45 ~ 45 度)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            float\u003C/span>\u003Cspan style=\"color:#B392F0\"> targetPitchAngle\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> input.Pitch \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> maxTiltAngle;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            float\u003C/span>\u003Cspan style=\"color:#B392F0\"> targetRollAngle\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#F97583\"> -\u003C/span>\u003Cspan style=\"color:#E1E4E8\">input.Roll \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> maxTiltAngle; \u003C/span>\u003Cspan style=\"color:#6A737D\">// Unity Z轴旋转方向可能需要反转\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            // 获取当前角度 (将 0-360 转换为 +/- 180)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            Vector3\u003C/span>\u003Cspan style=\"color:#B392F0\"> currentEuler\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> transform.localEulerAngles;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            float\u003C/span>\u003Cspan style=\"color:#B392F0\"> currentPitch\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Mathf.\u003C/span>\u003Cspan style=\"color:#B392F0\">DeltaAngle\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, currentEuler.x);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            float\u003C/span>\u003Cspan style=\"color:#B392F0\"> currentRoll\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Mathf.\u003C/span>\u003Cspan style=\"color:#B392F0\">DeltaAngle\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, currentEuler.z);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            // 外环 P 控制: 角度误差 -> 目标角速度\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            // Pitch: 目标 - 当前 (因为后面混控器 Pitch 反转了，所以这里保持 目标-当前)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            targetPitchRate \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (targetPitchAngle \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> currentPitch) \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> angleKP;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            // Roll: 当前 - 目标 (反转逻辑，防止正反馈翻滚)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            // 右滚是负角度，如果不反转，误差为正，导致继续右滚\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            targetRollRate \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (currentRoll \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> targetRollAngle) \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> angleKP;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            // Yaw 轴通常保持 Rate 模式\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            targetYawRate \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> input.Yaw \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 150f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        else\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            // --- Acro Mode (特技/手动模式) ---\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            // 摇杆输入直接映射为目标角速度 (-200 ~ 200 度/秒)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            targetPitchRate \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> input.Pitch \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 200f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            targetRollRate \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> input.Roll \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 200f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            targetYawRate \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> input.Yaw \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 150f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Chr>\n\u003Ch2 id=\"稳定性与体验优化\">稳定性与体验优化\u003C/h2>\n\u003Cp>除了核心物理，还有很多细节决定了模拟器的可用性：\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cstrong>怠速保护 (Idle Protection)\u003C/strong>：\n\u003Cul>\n\u003Cli>问题：地面待机时，PID 积分项累积导致无人机“抽搐”或乱跳。\u003C/li>\n\u003Cli>解决：油门 &#x3C; 5% 时，强制关闭电机并 \u003Cstrong>Reset PID\u003C/strong>。\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003C/ul>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"csharp\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // --- 怠速保护逻辑 ---\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (throttleBase \u003C/span>\u003Cspan style=\"color:#F97583\">&#x3C;\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0.05f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            m1 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> m2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> m3 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> m4 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            pitchPID.\u003C/span>\u003Cspan style=\"color:#B392F0\">Reset\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            rollPID.\u003C/span>\u003Cspan style=\"color:#B392F0\">Reset\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            yawPID.\u003C/span>\u003Cspan style=\"color:#B392F0\">Reset\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cul>\n\u003Cli>\u003Cstrong>PID 限幅 (Authority Limit)\u003C/strong>：\n\u003Cul>\n\u003Cli>限制 PID 对电机的最大控制权 (例如 30%)，防止极端情况下 PID 输出过大导致电机饱和甚至侧翻。\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003C/ul>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"csharp\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">         // --- PID 限幅保护 ---\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">         float\u003C/span>\u003Cspan style=\"color:#B392F0\"> pOut\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Mathf.\u003C/span>\u003Cspan style=\"color:#B392F0\">Clamp\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pitchCorrection \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> correctionScale, \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#E1E4E8\">maxPIDAuthority, maxPIDAuthority);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">         float\u003C/span>\u003Cspan style=\"color:#B392F0\"> rOut\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Mathf.\u003C/span>\u003Cspan style=\"color:#B392F0\">Clamp\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(rollCorrection \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> correctionScale, \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#E1E4E8\">maxPIDAuthority, maxPIDAuthority);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">         float\u003C/span>\u003Cspan style=\"color:#B392F0\"> yOut\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Mathf.\u003C/span>\u003Cspan style=\"color:#B392F0\">Clamp\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(yawCorrection \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> correctionScale, \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#E1E4E8\">maxPIDAuthority, maxPIDAuthority); \u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cul>\n\u003Cli>\u003Cstrong>一键重置\u003C/strong>：\n\u003Cul>\n\u003Cli>添加手柄 \u003Cstrong>Y 键\u003C/strong> 复位功能，炸机后瞬间回到原点并清空物理速度，方便反复练习。\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003C/ul>\n\u003Chr>\n\u003Ch1 id=\"二源码\">二、源码\u003C/h1>\n\u003Ch2 id=\"代码结构\">代码结构\u003C/h2>\n\u003Cp>代码结构比较简单，一共就4个代码就实现了整个无人机模拟，以下是流程图：\u003C/p>\n\u003Cp>\u003Cimg src=\"/uploads/images/1766732962738-221925025.jpg\" alt=\"Gemini_Generated_Image_v4l1irv4l1irv4l1.jpg\">\u003C/p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003Ctable>\u003Cthead>\u003Ctr>\u003Cth>架构分层\u003C/th>\u003Cth>核心脚本\u003C/th>\u003Cth>角色定位\u003C/th>\u003Cth>主要功能与逻辑\u003C/th>\u003Cth>数据流向 / 物理作用\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd>\u003Cstrong>输入层\u003C/strong>\u003C/td>\u003Ctd>\u003Ccode>DroneInput.cs\u003C/code>\u003C/td>\u003Ctd>\u003Cstrong>信号预处理\u003C/strong>\u003C/td>\u003Ctd>1. \u003Cstrong>读取硬件\u003C/strong>：接收物理手柄输入。\u003Cbr> 2. \u003Cstrong>数据清洗\u003C/strong>：处理摇杆死区、应用映射曲线。\u003C/td>\u003Ctd>\u003Cstrong>输出\u003C/strong>：标准化控制信号\u003Cbr>• 油门 (Throttle): \u003Ccode>0 ~ 1\u003C/code> \u003Cbr>•俯仰/横滚/偏航: \u003Ccode>-1 ~ 1\u003C/code>\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>控制层\u003C/strong>\u003C/td>\u003Ctd>\u003Ccode>FlightController.cs\u003C/code>\u003C/td>\u003Ctd>\u003Cstrong>大脑 (Brain)\u003C/strong>\u003C/td>\u003Ctd>1. \u003Cstrong>模式处理\u003C/strong>：根据 Angle/Acro 模式将输入转为目标角速度。\u003Cbr>2. \u003Cstrong>PID 调度\u003C/strong>：调用 \u003Ccode>PID.cs\u003C/code> 计算误差。\u003Cbr> 3. \u003Cstrong>混控 (Mixer)\u003C/strong>：混合主油门与 PID 修正值。\u003Cbr>  4. \u003Cstrong>环境模拟\u003C/strong>：计算非线性阻力与地面效应。\u003C/td>\u003Ctd>\u003Cstrong>输入\u003C/strong>：标准化信号 + 刚体物理状态\u003Cbr>\u003Cstrong>输出\u003C/strong>：4 个电机的最终目标油门\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>算法层\u003C/strong>\u003C/td>\u003Ctd>\u003Ccode>PID.cs\u003C/code>\u003C/td>\u003Ctd>\u003Cstrong>纯数学计算\u003C/strong>\u003C/td>\u003Ctd>1. \u003Cstrong>误差计算\u003C/strong>：对比目标值与当前值。\u003Cbr>2. \u003Cstrong>修正输出\u003C/strong>：计算比例(P)+积分(I)+微分(D)的总和。\u003C/td>\u003Ctd>\u003Cstrong>输入\u003C/strong>：目标值、当前值、时间差 (dt)\u003Cbr>\u003Cstrong>输出\u003C/strong>：PID 修正值\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>执行层\u003C/strong>\u003C/td>\u003Ctd>\u003Ccode>MotorEngine.cs\u003C/code>\u003C/td>\u003Ctd>\u003Cstrong>四肢 (Limbs)\u003C/strong>\u003C/td>\u003Ctd>1. \u003Cstrong>惯性模拟\u003C/strong>：通过低通滤波模拟电机响应延迟。\u003Cbr>2. \u003Cstrong>物理交互\u003C/strong>：将油门值转换为具体的物理力。\u003C/td>\u003Ctd>\u003Cstrong>输入\u003C/strong>：目标油门值\u003Cbr>\u003Cstrong>作用\u003C/strong>：向 Rigidbody 施加\u003Cbr>• 推力 (Force)\u003Cbr>• 反扭矩 (Torque)\u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\n\u003Ch1 id=\"总结\">总结\u003C/h1>\n\u003Cp>通过以上步骤，我们从一个简单的刚体运动，进化到了一个具备空气动力学特性的飞行模拟器。目前的物理手感已经能传达出穿越机的“惯性”和“风阻”。\u003C/p>\n\u003Cp>如果能帮助到你！可以给我来个点赞吗？ 谢谢！u😘\u003C/p>",{"headings":99,"localImagePaths":148,"remoteImagePaths":149,"frontmatter":92,"imagePaths":150},[100,103,105,108,110,112,114,117,120,122,125,128,131,133,136,139,141,144,146],{"depth":20,"slug":101,"text":102},"unity-无人机物理模拟开发日志从零打造穿越机手感","Unity 无人机物理模拟开发日志：从零打造穿越机手感",{"depth":47,"slug":104,"text":104},"开源仓库地址",{"depth":47,"slug":106,"text":107},"演示视频","演示视频：",{"depth":20,"slug":109,"text":109},"功能介绍",{"depth":40,"slug":111,"text":111},"输入系统",{"depth":40,"slug":113,"text":113},"核心物理引擎",{"depth":47,"slug":115,"text":116},"pid-控制器-rate-loop","PID 控制器 (Rate Loop)",{"depth":47,"slug":118,"text":119},"混控器-mixer","混控器 (Mixer)",{"depth":40,"slug":121,"text":121},"物理细节的打磨",{"depth":47,"slug":123,"text":124},"电机惯性-motor-inertia","电机惯性 (Motor Inertia)",{"depth":47,"slug":126,"text":127},"地面效应-ground-effect","地面效应 (Ground Effect)",{"depth":47,"slug":129,"text":130},"非线性空气阻力-quadratic-drag","非线性空气阻力 (Quadratic Drag)",{"depth":40,"slug":132,"text":132},"飞行模式",{"depth":47,"slug":134,"text":135},"acro-mode-手动模式","Acro Mode (手动模式)",{"depth":47,"slug":137,"text":138},"angle-mode-自稳模式","Angle Mode (自稳模式)",{"depth":40,"slug":140,"text":140},"稳定性与体验优化",{"depth":20,"slug":142,"text":143},"二源码","二、源码",{"depth":40,"slug":145,"text":145},"代码结构",{"depth":20,"slug":147,"text":147},"总结",[],[],[],"post_20251226070813.md","post_20251229070308",{"id":152,"data":154,"body":155,"filePath":156,"digest":157,"rendered":158,"legacyId":249},{},"# Cosys-AirSim 与 Microsoft AirSim 的架构演进、功能差异及生态系统对比\n>*本篇文章信息由 Gemini3辅助收集所得*\n\n![be7af7bafd5246889697ccdb05fffb7f.jpeg](/uploads/images/1766991763707-719088700.jpeg)\n\n>附录：详细技术规格对比表\n\n| 特性维度      | Microsoft AirSim (Original) | Cosys-AirSim         | 关键影响      |\n| ------------- | ------------------- | ------------------ | ------------------- |\n| 维护状态      | 已归档 (停止于 2022.07)     | 活跃开发中                                       | 安全性、新功能支持、Bug修复         |\n| Unreal Engine | UE 4.27 (主要)              | UE 5.2 (LTS) / UE 5.5                            | 图形质量 (Lumen/Nanite)、未来兼容性 |\n| 物理引擎      | PhysX                       | Chaos Physics                                    | 模拟精度、UE5 兼容性、确定性        |\n| ROS 支持      | ROS 1 (Wrapper)             | ROS 2 (Native rclcpp)                            | 实时性、DDS 通信、Nav2 兼容性       |\n| LiDAR 模型    | CPU Raycast, 无强度信息     | GPU 加速, 真实强度, 全扫描                       | 自动驾驶感知训练、高频仿真          |\n| 特有传感器    | 基础 (IMU, GPS, Baro, Mag)  | + Echo (声纳), GPU LiDAR, Light                  | 生物仿生、光照鲁棒性研究            |\n| 车辆类型      | Car, Multirotor             | + Skid Steer (Husky, P3DX), USV (ASVSim), BoxCar | 仓储物流、海事应用、快速验证        |\n| 开发接口      | C++, Python, Java           | C++, Python, Matlab                              | 工程科研便利性、Simulink 集成       |\n| Unity 支持    | 实验性支持                  | 已移除                                           | 资源集中于 UE 优化                  |\n| 语义分割      | 255 ID 限制                 | 无限 ID, 自动网格着色                            | 大规模场景数据集生成、实例分割      |\n\n\n# 1. 执行摘要\n本研究报告旨在详尽分析 Cosys-AirSim 与原版 Microsoft AirSim 之间的技术差异、架构演进及应用场景。在自主系统仿真领域，Microsoft AirSim 曾长期占据主导地位，为无人机（UAV）和自动驾驶汽车的研究提供了基于虚幻引擎（Unreal Engine）的高保真物理与视觉模拟环境。然而，随着 Microsoft 于 2022 年 7 月正式宣布终止对原版 AirSim 的维护并将其项目归档，开源社区与学术界迫切需要一个能够继承其高保真物理仿真遗产并适配现代图形引擎（如 Unreal Engine 5）的替代方案。\nCosys-AirSim 作为安特卫普大学（University of Antwerp）Cosys-Lab 开发并维护的活跃分支，不仅填补了微软退出后的生态空白，更在传感器模态的深度、ROS2 原生支持的广度、物理引擎的代际迁移（从 PhysX 到 Chaos）以及跨域仿真（如水面无人艇 ASVSim）等方面实现了重大突破。\n本报告将深入剖析两者在底层架构、渲染管线、API 接口兼容性、多智能体协同机制以及开发生态等维度的具体差异。特别是，我们将重点讨论 Cosys-AirSim 如何利用 Unreal Engine 5 的 Nanite 和 Lumen 技术提升感知数据的真实性，以及其彻底重构的 ROS2 接口如何满足现代机器人工业对实时性和分布式通信的需求。此外，报告还将详细介绍新增的生物启发式传感器（如回声定位传感器）和水面载具模拟能力，为机器人研究人员、自动驾驶工程师及仿真架构师提供权威的迁移指南与技术参考。\n#  2. 引言：仿真平台的代际更替与技术分叉\n## 2.1 Microsoft AirSim 的历史地位与终结\n自 2017 年由 Microsoft Research 发布以来，AirSim 迅速成为自主系统研究领域的基石 。它通过作为 Unreal Engine 的插件运行，利用游戏引擎强大的渲染能力来生成逼真的 RGB 图像、深度图和语义分割图，从而解决了深度学习模型训练中数据匮乏的关键痛点，即“模拟-现实差距”（Sim-to-Real Gap）。无论是用于无人机避障的强化学习算法，还是自动驾驶汽车的计算机视觉系统，AirSim 都提供了精确的物理模拟和丰富的数据接口。\n然而，软件生命周期总是有限的。2022 年，微软宣布原版 AirSim 项目已完成其历史使命，并将其 GitHub 仓库归档（Archived）。微软的战略重心转移到了商业闭源平台 \"Project AirSim\" 上，旨在为航空工业提供更高级别的商业模拟服务 。这一决定产生了深远的影响：原版 AirSim 停止了对新特性的支持，更重要的是，它不再适配 Unreal Engine 的后续版本（主要是 UE5），导致其在图形技术飞速发展的当下逐渐显得过时。社区用户虽然仍可访问代码，但面临着维护缺失、Bug 无法修复以及无法利用新硬件特性的困境 。\n## 2.2 Cosys-AirSim 的崛起与定位\n在微软宣布停止维护的同时，学术界和工业界对开源高保真仿真器的需求并未减弱。Cosys-AirSim 正是在这一背景下应运而生。它并非简单的代码托管或微小的维护性分支，而是由安特卫普大学（University of Antwerp）的 Cosys-Lab（网络物理系统实验室）发起并深度定制的演进版本 。\nCosys-AirSim 的核心定位是从一个通用的 AI 研究演示平台，转型为面向复杂工业应用、多领域机器人研究的生产力工具 。Cosys-Lab 团队不仅承担了代码维护的重任，更重要的是，他们对底层架构进行了大刀阔斧的重构，以适配 Unreal Engine 5 的革命性特性 。这一分叉版本（Fork）引入了对水面无人艇（ASVSim）、工业级移动机器人（如 Husky）、以及生物声纳感知（SonoNERF）的支持，极大地扩展了 AirSim 的应用边界 。\n本质上，Cosys-AirSim 代表了 AirSim 技术栈的现代化重生。它不仅解决了原版在 UE5 环境下的兼容性问题，还针对现代机器人开发流程（特别是 ROS2）进行了原生适配，成为了目前唯一活跃且功能完备的 AirSim 后继者 。\n# 3. 核心架构与引擎支持\n原版 AirSim 与 Cosys-AirSim 最根本的区别在于其所依附的底层游戏引擎版本及其配套的物理系统。这种底层的差异决定了仿真器的渲染上限、物理计算精度以及未来的可扩展性。\n![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/f3605f34ae7b43e88483fb6eede35ced.jpeg)\n\n## 3.1 物理引擎的范式转移：PhysX vs. Chaos\n物理引擎是仿真器的“心脏”，负责计算碰撞检测、刚体动力学、车辆悬挂以及空气动力学效应。在 Unreal Engine 4 到 5 的升级过程中，物理引擎发生了彻底的更替，这也是原版 AirSim 无法直接运行在 UE5 上的主要原因。\n###  * Microsoft AirSim (Legacy) - 深度绑定 NVIDIA PhysX\n   * 技术背景: 在 UE4 时代，NVIDIA 的 PhysX 是引擎默认集成的物理解决方案。原版 AirSim 的核心类 FastPhysicsEngine 以及车辆动力学模型 PhysXCar 是直接基于 PhysX API 构建的 。它依赖 PhysX 来处理车辆的轮胎摩擦、悬挂阻尼以及多旋翼无人机的刚体运动。\n   * 局限性: 随着 UE5 的发布，Epic Games 为了追求更高的物理计算确定性和跨平台一致性，弃用了 PhysX，全面转向自研的 Chaos 物理引擎。由于原版 AirSim 的代码库中充斥着对 PhysX 数据结构和函数调用的依赖，这导致其在 UE5 环境下无法编译，直接限制了其生命周期 。\n   * 现状: 原版 AirSim 仅能稳定运行于 UE 4.27 及更早版本，无法享受后续引擎更新带来的性能和功能提升。\n * Cosys-AirSim (Modern) - 全面迁移至 Chaos Physics\n   * 技术重构: Cosys-Lab 投入了大量工程资源，将底层的物理交互逻辑从 PhysX 迁移到了 Chaos。这不仅仅是简单的 API 替换，还涉及到车辆动力学模型的重新校准。Cosys-AirSim 利用 UE5 的 Chaos Vehicles 插件重写了四轮车辆模型，确保了在新的物理求解器下，车辆的加减速、转向和悬挂行为依然符合物理规律 。\n   * 优势: Chaos 物理引擎支持异步物理步进（Async Physics Ticking），允许物理模拟以独立于渲染帧率的固定频率运行，这对于保证仿真数据的时间一致性至关重要。此外，Chaos 在处理复杂几何体碰撞（Complex Collision）和大规模破碎效果方面表现更优，为模拟机器人与环境的交互（如无人机撞击障碍物）提供了更真实的反馈。\n   * 版本支持: Cosys-AirSim 官方提供了针对 UE 5.2 (LTS) 和最新 UE 5.5 的预编译插件和源码支持，确保用户始终处于技术前沿 。\n3.2 渲染管线与视觉高保真度：Nanite 与 Lumen 的引入\n视觉传感器（摄像头）是自主系统中最常用的感知手段。仿真图像的逼真度（Photorealism）直接决定了在仿真中训练的计算机视觉（CV）模型能否迁移到现实世界。Cosys-AirSim 通过支持 UE5，引入了图形学领域的两项颠覆性技术：Nanite 和 Lumen，这是原版 AirSim 无法企及的。\n * Lumen 全动态全局光照 (Global Illumination):\n   * 原版 AirSim: 主要依赖 UE4 的预烘焙光照（Baked Lighting）或简单的屏幕空间技术（SSGI）。在光照条件快速变化的场景（如无人机从室内飞到室外，或日夜交替）中，光影效果往往显得生硬且不真实。\n   * Cosys-AirSim: 启用了 Lumen 系统，能够实时模拟光线的无限次反弹和间接照明。这意味着当红色的卡车驶过白色墙壁时，墙壁会真实地呈现出红色的漫反射光（Color Bleeding）。对于依赖光照一致性的视觉 SLAM 和目标检测算法，Lumen 提供了极其接近真实物理世界的光照环境，显著降低了 Domain Gap 。\n * Nanite 虚拟化微多边形几何体:\n   * 原版 AirSim: 受限于传统渲染管线，场景中的模型必须制作多个细节层次（LODs）以平衡性能。高精度的几何体（如极其复杂的树木或岩石）会导致渲染帧率骤降。\n   * Cosys-AirSim: 支持 Nanite 技术，允许直接导入拥有数亿多边形的电影级资产（如 Quixel Megascans 库）。Nanite 会根据摄像机距离自动流式传输几何细节，使得仿真场景中的物体可以拥有像素级别的几何精度。这对于激光雷达（LiDAR）仿真尤为关键，因为更细致的表面几何意味着更真实的激光反射点云，尤其是在模拟非结构化环境（如森林、废墟）时 。\n3.3 性能优化与场景管理\n虽然 UE5 带来了画质的飞跃，但也引入了更高的计算负载。Cosys-AirSim 针对这一挑战进行了特定的优化：\n### * 实例化渲染优化 (Instanced Rendering): \n改进了对大规模场景中重复对象（如仓库中的数千个集装箱或森林中的树木）的渲染效率，减少了 Draw Call 的开销。\n### * 传感器解耦 (Sensor Decoupling): \n重构了传感器更新循环。在原版 AirSim 中，传感器往往与主物理循环强绑定。Cosys-AirSim 允许传感器以独立频率运行，且支持传感器在不同车辆间的灵活挂载，甚至支持独立于车辆的“世界传感器”（World Sensors），用于模拟监控摄像头等固定设施 。\n下表总结了两者在引擎支持方面的关键差异：\n\n| 特性维度       | Microsoft AirSim (Original) |Cosys-AirSim         | 技术影响   |\n| -------------- | ---------------------- | --------------- | ----------------- |\n| 支持的虚幻引擎 | UE 4.27 及更早      | UE 5.2, UE 5.5    | 图形渲染质量上限     |\n| 物理引擎       | NVIDIA PhysX      | Chaos Physics  | 物理仿真精度与兼容性 |\n| 几何系统       | 传统 Mesh LODs     | Nanite         | 支持极高精度环境建模 |\n| 光照系统       | 烘焙/光栅化光照      | Lumen (实时全局光照) | 动态光影真实度       |\n| 维护状态       | 归档 (停止更新)      | 活跃 (持续迭代)      | 对新硬件/驱动的适配  |\n\n\n# 4.传感器生态系统的扩展与深化\n 传感器仿真是 Cosys-AirSim 与原版 AirSim 差异最大的领域之一。Cosys-Lab 不仅修复了原版传感器模型中的已知缺陷，还引入了全新的传感器类型，特别是针对工业应用和生物仿生研究的需求进行了定制。\n## 4.1 激光雷达（LiDAR）的革新：从 CPU 到 GPU\n激光雷达是自动驾驶感知的核心传感器。原版 AirSim 的 LiDAR 实现存在显著的性能瓶颈和功能缺失，而 Cosys-AirSim 对此进行了彻底的重写。\n * 计算架构：CPU Raycast vs. GPU Acceleration\n   * 原版 AirSim: 使用 CPU 进行射线投射（Ray-casting）来模拟激光束。当模拟低线束雷达（如 16 线 VLP-16）时性能尚可，但在模拟高线束雷达（如 64 线或 128 线）或高分辨率固态雷达时，CPU 负载会呈指数级上升，导致仿真帧率大幅下降，甚至无法满足实时性要求。\n   * Cosys-AirSim: 引入了 GPU LiDAR 传感器类型。它利用现代 GPU 的计算着色器（Compute Shaders）或光栅化管线并行处理成千上万个激光点的碰撞检测。这使得在保持高帧率的同时，能够模拟极高点密度的雷达扫描，支持模拟如 Velodyne Alpha Prime 或 Ouster OS-128 等高端传感器 。\n * 回波强度（Intensity）与物理建模\n   * 原版 AirSim: 生成的点云数据通常缺乏真实的强度信息，或者仅提供基于距离的简单衰减，无法反映物体材质对激光反射率的影响。\n   * Cosys-AirSim: 实现了基于物理的强度模拟。模型考虑了物体表面的材质属性（反射率）、激光入射角、大气衰减以及激光雷达自身的发射功率曲线。生成的点云包含真实的 Intensity 通道，这对于开发基于强度的定位算法（Intensity-based Localization）和语义分割算法至关重要 。\n * 数据交付与畸变模拟\n   * 全扫描交付 (Full Scan): 原版 AirSim 的 LiDAR 数据往往受到渲染帧率的限制，一次 API 调用可能只返回部分扫描扇区的数据。Cosys-AirSim 改进了 API，支持输出完整的 360 度扫描帧（Full Scan），确保了数据的完整性 。\n   * 运动畸变 (Motion Distortion): 能够在仿真中模拟由于车辆高速运动导致的激光点云畸变（Rolling Shutter effect），这对于验证去畸变算法（De-skewing）非常有用。\n4.2 视觉传感器：光学缺陷的真实再现\n为了缩小 Sim-to-Real Gap，Cosys-AirSim 增强了相机模型，使其包含更多真实世界相机的光学瑕疵，从而防止神经网络模型在过于完美的仿真图像上发生过拟合。\n * 高级畸变模型: 新增了对 色差 (Chromatic Aberration)、运动模糊 (Motion Blur) 和 透镜畸变 (Lens Distortion) 的详细参数配置。用户可以精确控制径向畸变和切向畸变的系数，以匹配真实相机的内参 。\n * 光照传感器 (Lighting Sensor): 引入了一种名为 Lighting 的新图像类型。这种图像不包含物体的纹理材质，仅渲染场景中的光照分布（包括阴影和高光）。这为研究光照不变性算法提供了独特的 Ground Truth 数据 。\n * *噪声模型*: 实现了更复杂的深度相机噪声模型，能够模拟真实 RGB-D 相机（如 RealSense）在不同距离和材质下的测量误差，R平方值达到 0.62，显著优于原版简单的噪声叠加 。\n4.3 生物启发式感知：声纳与回声定位\n这是 Cosys-AirSim 独有的特色功能，源于 Cosys-Lab 在蝙蝠回声定位（Echolocation）方面的研究背景。\n * Echo Sensor: 引入了高保真的声学传感器模型，能够模拟声波在三维环境中的传播、反射、衍射和多普勒效应。结合相关的开源项目 SonoNERF（神经辐射场声学建模），Cosys-AirSim 能够生成逼真的声纳图谱（Spectrograms）。\n * 应用: 这一功能使得 Cosys-AirSim 成为研究声学导航、水下声纳成像以及生物仿生机器人的独特平台，而原版 AirSim 完全不具备处理声学信号的能力 。\n4.4 语义分割与真值系统的突破\n语义分割是计算机视觉训练中最重要的数据之一。原版 AirSim 在这方面存在一个著名的“硬伤”。\n * *ID 限制突破*: 原版 AirSim 的分割 ID 被限制在 0-255 之间（8位整数），这意味着在同一场景中最多只能区分 255 类物体。对于包含成千上万个独立对象（如森林中的每一棵树，或仓库中的每一个包裹）的大规模场景，这一限制是致命的。Cosys-AirSim 重写了底层的分割 ID 分配逻辑，支持数百万个唯一对象的 ID 映射，满足了实例分割（Instance Segmentation）和全景分割（Panoptic Segmentation）的需求 。\n * 自动标注系统: 利用 Unreal Engine 的顶点颜色（Vertex Color）技术，Cosys-AirSim 实现了对静态和动态对象的自动着色和标签生成。用户无需手动为每个资产配置 ID，系统会根据网格实例自动生成唯一的 RGB 掩码，并导出对应的 ID-名称映射表 。\n# 5.机器人中间件集成：ROS1 到 ROS2 的全面进化\n对于机器人研究者而言，仿真器与 ROS（Robot Operating System）的集成度是决定其易用性的关键。随着机器人工业界全面向 ROS2 转型以追求更好的实时性和安全性，Cosys-AirSim 在这方面的重构显得尤为重要。\n## 5.1 Microsoft AirSim 的 ROS1 遗产\n原版 AirSim 的 ROS 集成主要通过 airsim_ros_pkgs 实现，这是一个基于 ROS1（主要是 Melodic/Noetic 版本）的封装器（Wrapper）。\n * 架构限制: 原版 Wrapper 本质上是一个桥接节点（Bridge Node）。它运行在 ROS 环境中，通过 TCP/IP 协议的 RPC 接口与 AirSim 二进制程序通信，获取数据后再封装为 ROS 消息发布。这种架构虽然解耦了仿真器和 ROS，但在高频数据传输时存在明显的延迟。\n * ROS2 支持缺失: 虽然社区曾尝试通过 ros1_bridge 或早期的实验性分支来支持 ROS2，但原版 AirSim 从未提供官方稳定的 ROS2 支持。这意味着在原版 AirSim 上开发 ROS2 应用需要复杂的桥接配置，且难以利用 ROS2 的 DDS（Data Distribution Service）特性 。\n5.2 Cosys-AirSim 的原生 ROS2 重构\nCosys-AirSim 彻底重写了 ROS 集成层，使其成为 ROS2 Native 的实现，完全拥抱了 ROS2 生态 。\n * 基于 rclcpp 的原生实现:\n   * Cosys-AirSim 摒弃了旧的 Wrapper 架构，直接使用 ROS2 的 C++ 客户端库 (rclcpp) 在插件内部编写节点。这意味着仿真器本身就是一个或多个 ROS2 节点，可以直接参与 ROS2 网络的数据交换 。\n   * 优势: 这种原生集成允许利用 ROS2 的零拷贝（Zero-copy）通信机制（在同一进程内），大幅降低了图像和点云等大数据量传输的延迟。同时，它支持 ROS2 的生命周期管理（Lifecycle Nodes），允许外部控制器动态管理仿真节点的启动、暂停和配置。\n * TF 树与坐标系的标准化:\n   * 原版 AirSim 中，坐标系转换（从 Unreal 的左手系 NED 到 ROS 的右手系 ENU）经常引起混淆。Cosys-AirSim 重新设计了坐标变换（TF）树的结构，严格遵循 REP-105 标准：world -> odom -> vehicle -> sensors 。\n   * 这修正了原版中常见的坐标系不一致问题，使得 Cosys-AirSim 能够无缝对接 Nav2（ROS2 Navigation Stack）等标准导航包，无需用户手动编写复杂的坐标转换脚本 。\n * 自定义消息与服务扩展:\n   * Cosys-AirSim 不仅发布标准的传感器话题，还扩展了大量的 ROS2 Service 和 Action。用户可以通过 ROS 命令行或节点直接控制仿真环境，例如动态改变天气参数、控制非玩家车辆（NPC）的行为、或者触发特定的仿真事件。\n   * 话题列表也进行了现代化更新，例如相机图像话题现在采用符合 ROS2 最佳实践的命名空间结构，如 /sensing/camera/image_raw，并支持 QoS（Quality of Service）策略配置，允许在不可靠网络下丢弃过时数据以保证实时性 。\n * Unity 支持的移除:\n   * 为了集中资源优化 UE5 和 ROS2 的体验，Cosys-AirSim 明确做出了战略取舍，移除了原版 AirSim 中实验性的 Unity 引擎支持 。这一决定虽然减少了引擎的选择，但换来的是在 Unreal + ROS2 这一主流技术栈上的极致优化。\n# 6.载具动力学与跨域扩展：从陆空到海洋\n原版 AirSim 的设计初衷主要聚焦于四旋翼无人机（Multirotor）和乘用车（Car）。Cosys-AirSim 则打破了这一局限，极大地扩展了载具库，涵盖了更多样的机器人形态，甚至拓展到了水面领域，实现了“海陆空”全域仿真。\n## 6.1 地面移动机器人的多样化：不止于汽车\n在原版 AirSim 中，如果想模拟一个仓库里的轮式机器人，通常只能借用 Car 模型，但这会导致物理行为的不准确（例如汽车是阿克曼转向，而机器人通常是差速转向）。\n * 差速/滑移转向模型 (Skid Steering):\n   * Cosys-AirSim 引入了通用的滑移转向物理模型。这是大多数履带式车辆和差速轮式机器人的运动基础。\n   * 内置模型: 官方内置了 ClearPath Husky 和 Pioneer P3DX 等经典科研机器人的高精度模型 。这使得 Cosys-AirSim 可以直接用于仓储物流机器人、野外巡检机器人等非乘用车型算法的开发与验证。\n * *BoxCar*:\n   * 为了在资源受限的环境下进行快速算法验证，Cosys-AirSim 添加了一个名为 BoxCar 的简化车辆模型。它去除了复杂的悬挂和车轮物理计算，仅保留基本的运动学特性，非常适合用于大规模强化学习训练中的快速迭代 。\n## 6.2 ASVSim：水面无人艇仿真\n这是一个具有里程碑意义的扩展，标志着 AirSim 生态系统首次正式进入海洋工程领域。基于 Cosys-AirSim 框架，研究团队开发了 ASVSim（AirSim for Surface Vehicles）。\n * 流体动力学与浮力模型:\n   * ASVSim 集成了专门的船舶流体动力学模型。它不仅仅是将船视为在“蓝色地面”上滑行的汽车，而是真实模拟了水的浮力（Buoyancy）、水动阻力（Hydrodynamic Drag）以及波浪对船体产生的六自由度运动影响（如横摇、纵摇）。\n * 海事传感器仿真:\n   * 雷达: 实现了专门的海事导航雷达模拟。不同于激光雷达，ASVSim 的雷达模型应用了点扩散函数（PSF），能够生成具有真实噪声和杂波的雷达扫描图像（PPI 显示），支持基于雷达的海岸线检测和避障算法开发 。\n   * 应用场景: 这一扩展使得 Cosys-AirSim 能够支持内河航运、港口自动化监测以及水面垃圾清理机器人的仿真研究，特别是在安特卫普港等复杂水域环境的模拟中发挥了重要作用 。\n## 6.3 航空动力学的精细化\n针对无人机，Cosys-AirSim 也进行了微调。它引入了改进的空气阻力模型，相比原版在高速飞行（如 10m/s）时的阻力模拟误差降低了 51%，使得能耗预测和轨迹规划更加准确 。\n# 7.API 与开发生态：继承中的变革\nCosys-AirSim 在大幅扩展功能的同时，也致力于保持开发体验的连续性，但为了技术进步，不得不引入一些破坏性变更（Breaking Changes）。\n\n## 7.1 接口兼容性与破坏性变更\nCosys-AirSim 尽可能保持了 Python 和 C++ API 的向后兼容性，这意味着大多数基于原版 AirSim 编写的控制脚本（如 moveByVelocityAsync）无需修改即可运行。但在以下几个关键领域发生了变更：\n * 相机命名规范:\n   * 原版 AirSim: 允许使用数字索引（0, 1, 2...）或字符串ID来访问相机。\n   * Cosys-AirSim: 为了支持更复杂的传感器配置，强制推行基于字符串名称的访问方式（如 \"front_center\", \"back_right\"）。虽然为了兼容性保留了数字字符串别名（\"0\" 而非 0），但这要求开发者更新代码习惯，显式地使用具有语义的传感器名称，以避免在多传感器系统中的混淆 。\n * ROS2 话题重命名:\n   * 如前所述，ROS 侧的话题名称和消息类型发生了根本性变化，以符合 ROS2 标准。旧的 ROS1 启动脚本（Launch files）无法直接用于 Cosys-AirSim，必须重写 。\n## 7.2 Matlab 客户端的引入：工程科研的福音\n原版 AirSim 官方仅提供 C++ 和 Python 客户端，这对于习惯使用 Matlab/Simulink 进行控制理论研究、信号处理和硬件在环（HIL）仿真的传统工程人员来说是一个门槛。\n * Cosys-AirSim Matlab Client: 官方引入并维护了一个完整的 Matlab API 客户端工具箱 。\n * 功能: 它允许用户直接在 Matlab 环境中获取传感器数据、发送控制指令，甚至与 Simulink 模型进行联合仿真。这极大地简化了控制算法从理论设计到仿真验证的流程。\n##  7.3 文档与社区支持模式\n * 文档迁移: 随着 Microsoft 关闭并归档了原版文档站，Cosys-AirSim 建立了独立的文档托管站点（cosys-lab.github.io/Cosys-AirSim/）。文档结构进行了重组，专门增加了针对 UE5 迁移和 ROS2 配置的章节 。\n * \"As-is\" 支持模式: 需要注意的是，作为一个学术实验室维护的开源项目，Cosys-AirSim 明确声明软件是“按原样提供”（Provided As-is），不提供类似于微软时期的商业级支持承诺。社区互动主要依赖于 GitHub Issues 和相关的学术会议（如 ANNSIM），用户需要具备更强的自我排错能力 。\n# 8. 多智能体与集群仿真（Swarm Simulation）\n多智能体与集群仿真（Swarm Simulation）:在复杂的工业和救援场景中，单体机器人的能力往往有限，多机器人协同（Swarm Robotics）成为研究热点。Cosys-AirSim 利用 UE5 和 ROS2 的特性，在集群仿真方面展现了显著优势。\n## 8.1 性能优化与分布式架构\n原版 AirSim 虽然支持多车模式，但在车辆数量增加时，物理计算和渲染开销会导致性能急剧下降。\n * 实例化与优化: Cosys-AirSim 通过 UE5 的实例化技术优化了多智能体的渲染。更重要的是，基于 ROS2 的分布式架构允许将繁重的计算任务（如SLAM、路径规划）卸载到不同的计算节点甚至不同的物理机器上，仅保留仿真器进行物理和渲染计算。这使得在单台高性能工作站上实时模拟数十台无人机的集群成为可能 。\n## 8.2 典型应用场景\n * 工业巡检: 在布满管道、梁柱和设备的化工厂或海上钻井平台中，利用无人机集群进行覆盖式巡检。Cosys-AirSim 的高保真 LiDAR 和相机能够生成逼真的复杂结构点云，用于训练集群避障和协同建图算法。\n * 搜索与救援 (SAR): 模拟在灾后废墟环境中的搜索任务。利用其独特的声纳（Echo）传感器模拟，研究人员可以开发在烟雾或光线不足环境下依靠声学感知的搜索算法 。\n# 9. 结论与建议\n## 9.1 核心结论\n综上所述，Cosys-AirSim 并非原版 Microsoft AirSim 的简单替代品，而是一次全方位的现代化升级。\n * 不可逆的替代: 原版 Microsoft AirSim 已属“废弃软件”（Abandonware），且技术栈停留在 UE4 和 PhysX 时代。对于任何计划长期发展、且希望利用 Unreal Engine 5 强大功能的项目，Cosys-AirSim 是目前唯一可行的开源选择。\n * 功能超集: Cosys-AirSim 包含了原版的所有核心功能，并在物理引擎、渲染管线、传感器模态（GPU LiDAR, Sonar）、ROS2 集成以及载具类型（USV, Husky）上进行了深度扩展。\n * 门槛提升: 虽然功能强大，但对 UE5 和 ROS2 的依赖也提高了硬件门槛（需要支持 DirectX 12/Vulkan 的高性能 GPU）和技术栈要求。\n## 9.2 给研究人员与工程师的建议\n * 迁移策略: 对于仍在使用原版 AirSim 的用户，建议尽早启动迁移评估。虽然 Python 脚本改动不大，但 ROS 接口和物理参数的调整需要时间。\n * 新项目启动: 强烈建议直接基于 Cosys-AirSim 和 UE 5.2/5.5 启动新项目。利用其预编译插件可以大幅降低环境配置的复杂度。\n * 学术价值: Cosys-AirSim 提供的地面真值生成（语义分割、光照图）和新型传感器（声纳、高保真 LiDAR）为发表高质量、数据驱动的机器人学论文提供了强有力的工具支持。\nCosys-AirSim 成功地接过了开源高保真仿真的火炬，它不仅延续了 AirSim 的生命，更将其推向了更广阔的工业应用与跨域机器人研究的前沿。","src/content/posts/post_20251229070308.md","eda13bbed71efe7e",{"html":159,"metadata":160},"\u003Ch1 id=\"cosys-airsim-与-microsoft-airsim-的架构演进功能差异及生态系统对比\">Cosys-AirSim 与 Microsoft AirSim 的架构演进、功能差异及生态系统对比\u003C/h1>\n\u003Cblockquote>\n\u003Cp>\u003Cem>本篇文章信息由 Gemini3辅助收集所得\u003C/em>\u003C/p>\n\u003C/blockquote>\n\u003Cp>\u003Cimg src=\"/uploads/images/1766991763707-719088700.jpeg\" alt=\"be7af7bafd5246889697ccdb05fffb7f.jpeg\">\u003C/p>\n\u003Cblockquote>\n\u003Cp>附录：详细技术规格对比表\u003C/p>\n\u003C/blockquote>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003Ctable>\u003Cthead>\u003Ctr>\u003Cth>特性维度\u003C/th>\u003Cth>Microsoft AirSim (Original)\u003C/th>\u003Cth>Cosys-AirSim\u003C/th>\u003Cth>关键影响\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd>维护状态\u003C/td>\u003Ctd>已归档 (停止于 2022.07)\u003C/td>\u003Ctd>活跃开发中\u003C/td>\u003Ctd>安全性、新功能支持、Bug修复\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>Unreal Engine\u003C/td>\u003Ctd>UE 4.27 (主要)\u003C/td>\u003Ctd>UE 5.2 (LTS) / UE 5.5\u003C/td>\u003Ctd>图形质量 (Lumen/Nanite)、未来兼容性\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>物理引擎\u003C/td>\u003Ctd>PhysX\u003C/td>\u003Ctd>Chaos Physics\u003C/td>\u003Ctd>模拟精度、UE5 兼容性、确定性\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>ROS 支持\u003C/td>\u003Ctd>ROS 1 (Wrapper)\u003C/td>\u003Ctd>ROS 2 (Native rclcpp)\u003C/td>\u003Ctd>实时性、DDS 通信、Nav2 兼容性\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>LiDAR 模型\u003C/td>\u003Ctd>CPU Raycast, 无强度信息\u003C/td>\u003Ctd>GPU 加速, 真实强度, 全扫描\u003C/td>\u003Ctd>自动驾驶感知训练、高频仿真\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>特有传感器\u003C/td>\u003Ctd>基础 (IMU, GPS, Baro, Mag)\u003C/td>\u003Ctd>+ Echo (声纳), GPU LiDAR, Light\u003C/td>\u003Ctd>生物仿生、光照鲁棒性研究\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>车辆类型\u003C/td>\u003Ctd>Car, Multirotor\u003C/td>\u003Ctd>+ Skid Steer (Husky, P3DX), USV (ASVSim), BoxCar\u003C/td>\u003Ctd>仓储物流、海事应用、快速验证\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>开发接口\u003C/td>\u003Ctd>C++, Python, Java\u003C/td>\u003Ctd>C++, Python, Matlab\u003C/td>\u003Ctd>工程科研便利性、Simulink 集成\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>Unity 支持\u003C/td>\u003Ctd>实验性支持\u003C/td>\u003Ctd>已移除\u003C/td>\u003Ctd>资源集中于 UE 优化\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>语义分割\u003C/td>\u003Ctd>255 ID 限制\u003C/td>\u003Ctd>无限 ID, 自动网格着色\u003C/td>\u003Ctd>大规模场景数据集生成、实例分割\u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\n\u003Ch1 id=\"1-执行摘要\">1. 执行摘要\u003C/h1>\n\u003Cp>本研究报告旨在详尽分析 Cosys-AirSim 与原版 Microsoft AirSim 之间的技术差异、架构演进及应用场景。在自主系统仿真领域，Microsoft AirSim 曾长期占据主导地位，为无人机（UAV）和自动驾驶汽车的研究提供了基于虚幻引擎（Unreal Engine）的高保真物理与视觉模拟环境。然而，随着 Microsoft 于 2022 年 7 月正式宣布终止对原版 AirSim 的维护并将其项目归档，开源社区与学术界迫切需要一个能够继承其高保真物理仿真遗产并适配现代图形引擎（如 Unreal Engine 5）的替代方案。\nCosys-AirSim 作为安特卫普大学（University of Antwerp）Cosys-Lab 开发并维护的活跃分支，不仅填补了微软退出后的生态空白，更在传感器模态的深度、ROS2 原生支持的广度、物理引擎的代际迁移（从 PhysX 到 Chaos）以及跨域仿真（如水面无人艇 ASVSim）等方面实现了重大突破。\n本报告将深入剖析两者在底层架构、渲染管线、API 接口兼容性、多智能体协同机制以及开发生态等维度的具体差异。特别是，我们将重点讨论 Cosys-AirSim 如何利用 Unreal Engine 5 的 Nanite 和 Lumen 技术提升感知数据的真实性，以及其彻底重构的 ROS2 接口如何满足现代机器人工业对实时性和分布式通信的需求。此外，报告还将详细介绍新增的生物启发式传感器（如回声定位传感器）和水面载具模拟能力，为机器人研究人员、自动驾驶工程师及仿真架构师提供权威的迁移指南与技术参考。\u003C/p>\n\u003Ch1 id=\"2-引言仿真平台的代际更替与技术分叉\">2. 引言：仿真平台的代际更替与技术分叉\u003C/h1>\n\u003Ch2 id=\"21-microsoft-airsim-的历史地位与终结\">2.1 Microsoft AirSim 的历史地位与终结\u003C/h2>\n\u003Cp>自 2017 年由 Microsoft Research 发布以来，AirSim 迅速成为自主系统研究领域的基石 。它通过作为 Unreal Engine 的插件运行，利用游戏引擎强大的渲染能力来生成逼真的 RGB 图像、深度图和语义分割图，从而解决了深度学习模型训练中数据匮乏的关键痛点，即“模拟-现实差距”（Sim-to-Real Gap）。无论是用于无人机避障的强化学习算法，还是自动驾驶汽车的计算机视觉系统，AirSim 都提供了精确的物理模拟和丰富的数据接口。\n然而，软件生命周期总是有限的。2022 年，微软宣布原版 AirSim 项目已完成其历史使命，并将其 GitHub 仓库归档（Archived）。微软的战略重心转移到了商业闭源平台 “Project AirSim” 上，旨在为航空工业提供更高级别的商业模拟服务 。这一决定产生了深远的影响：原版 AirSim 停止了对新特性的支持，更重要的是，它不再适配 Unreal Engine 的后续版本（主要是 UE5），导致其在图形技术飞速发展的当下逐渐显得过时。社区用户虽然仍可访问代码，但面临着维护缺失、Bug 无法修复以及无法利用新硬件特性的困境 。\u003C/p>\n\u003Ch2 id=\"22-cosys-airsim-的崛起与定位\">2.2 Cosys-AirSim 的崛起与定位\u003C/h2>\n\u003Cp>在微软宣布停止维护的同时，学术界和工业界对开源高保真仿真器的需求并未减弱。Cosys-AirSim 正是在这一背景下应运而生。它并非简单的代码托管或微小的维护性分支，而是由安特卫普大学（University of Antwerp）的 Cosys-Lab（网络物理系统实验室）发起并深度定制的演进版本 。\nCosys-AirSim 的核心定位是从一个通用的 AI 研究演示平台，转型为面向复杂工业应用、多领域机器人研究的生产力工具 。Cosys-Lab 团队不仅承担了代码维护的重任，更重要的是，他们对底层架构进行了大刀阔斧的重构，以适配 Unreal Engine 5 的革命性特性 。这一分叉版本（Fork）引入了对水面无人艇（ASVSim）、工业级移动机器人（如 Husky）、以及生物声纳感知（SonoNERF）的支持，极大地扩展了 AirSim 的应用边界 。\n本质上，Cosys-AirSim 代表了 AirSim 技术栈的现代化重生。它不仅解决了原版在 UE5 环境下的兼容性问题，还针对现代机器人开发流程（特别是 ROS2）进行了原生适配，成为了目前唯一活跃且功能完备的 AirSim 后继者 。\u003C/p>\n\u003Ch1 id=\"3-核心架构与引擎支持\">3. 核心架构与引擎支持\u003C/h1>\n\u003Cp>原版 AirSim 与 Cosys-AirSim 最根本的区别在于其所依附的底层游戏引擎版本及其配套的物理系统。这种底层的差异决定了仿真器的渲染上限、物理计算精度以及未来的可扩展性。\n\u003Cimg src=\"https://i-blog.csdnimg.cn/direct/f3605f34ae7b43e88483fb6eede35ced.jpeg\" alt=\"在这里插入图片描述\">\u003C/p>\n\u003Ch2 id=\"31-物理引擎的范式转移physx-vs-chaos\">3.1 物理引擎的范式转移：PhysX vs. Chaos\u003C/h2>\n\u003Cp>物理引擎是仿真器的“心脏”，负责计算碰撞检测、刚体动力学、车辆悬挂以及空气动力学效应。在 Unreal Engine 4 到 5 的升级过程中，物理引擎发生了彻底的更替，这也是原版 AirSim 无法直接运行在 UE5 上的主要原因。\u003C/p>\n\u003Ch3 id=\"-microsoft-airsim-legacy---深度绑定-nvidia-physx\">* Microsoft AirSim (Legacy) - 深度绑定 NVIDIA PhysX\u003C/h3>\n\u003Cul>\n\u003Cli>技术背景: 在 UE4 时代，NVIDIA 的 PhysX 是引擎默认集成的物理解决方案。原版 AirSim 的核心类 FastPhysicsEngine 以及车辆动力学模型 PhysXCar 是直接基于 PhysX API 构建的 。它依赖 PhysX 来处理车辆的轮胎摩擦、悬挂阻尼以及多旋翼无人机的刚体运动。\u003C/li>\n\u003Cli>局限性: 随着 UE5 的发布，Epic Games 为了追求更高的物理计算确定性和跨平台一致性，弃用了 PhysX，全面转向自研的 Chaos 物理引擎。由于原版 AirSim 的代码库中充斥着对 PhysX 数据结构和函数调用的依赖，这导致其在 UE5 环境下无法编译，直接限制了其生命周期 。\u003C/li>\n\u003Cli>现状: 原版 AirSim 仅能稳定运行于 UE 4.27 及更早版本，无法享受后续引擎更新带来的性能和功能提升。\u003C/li>\n\u003Cli>Cosys-AirSim (Modern) - 全面迁移至 Chaos Physics\n\u003Cul>\n\u003Cli>技术重构: Cosys-Lab 投入了大量工程资源，将底层的物理交互逻辑从 PhysX 迁移到了 Chaos。这不仅仅是简单的 API 替换，还涉及到车辆动力学模型的重新校准。Cosys-AirSim 利用 UE5 的 Chaos Vehicles 插件重写了四轮车辆模型，确保了在新的物理求解器下，车辆的加减速、转向和悬挂行为依然符合物理规律 。\u003C/li>\n\u003Cli>优势: Chaos 物理引擎支持异步物理步进（Async Physics Ticking），允许物理模拟以独立于渲染帧率的固定频率运行，这对于保证仿真数据的时间一致性至关重要。此外，Chaos 在处理复杂几何体碰撞（Complex Collision）和大规模破碎效果方面表现更优，为模拟机器人与环境的交互（如无人机撞击障碍物）提供了更真实的反馈。\u003C/li>\n\u003Cli>版本支持: Cosys-AirSim 官方提供了针对 UE 5.2 (LTS) 和最新 UE 5.5 的预编译插件和源码支持，确保用户始终处于技术前沿 。\n3.2 渲染管线与视觉高保真度：Nanite 与 Lumen 的引入\n视觉传感器（摄像头）是自主系统中最常用的感知手段。仿真图像的逼真度（Photorealism）直接决定了在仿真中训练的计算机视觉（CV）模型能否迁移到现实世界。Cosys-AirSim 通过支持 UE5，引入了图形学领域的两项颠覆性技术：Nanite 和 Lumen，这是原版 AirSim 无法企及的。\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>Lumen 全动态全局光照 (Global Illumination):\n\u003Cul>\n\u003Cli>原版 AirSim: 主要依赖 UE4 的预烘焙光照（Baked Lighting）或简单的屏幕空间技术（SSGI）。在光照条件快速变化的场景（如无人机从室内飞到室外，或日夜交替）中，光影效果往往显得生硬且不真实。\u003C/li>\n\u003Cli>Cosys-AirSim: 启用了 Lumen 系统，能够实时模拟光线的无限次反弹和间接照明。这意味着当红色的卡车驶过白色墙壁时，墙壁会真实地呈现出红色的漫反射光（Color Bleeding）。对于依赖光照一致性的视觉 SLAM 和目标检测算法，Lumen 提供了极其接近真实物理世界的光照环境，显著降低了 Domain Gap 。\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>Nanite 虚拟化微多边形几何体:\n\u003Cul>\n\u003Cli>原版 AirSim: 受限于传统渲染管线，场景中的模型必须制作多个细节层次（LODs）以平衡性能。高精度的几何体（如极其复杂的树木或岩石）会导致渲染帧率骤降。\u003C/li>\n\u003Cli>Cosys-AirSim: 支持 Nanite 技术，允许直接导入拥有数亿多边形的电影级资产（如 Quixel Megascans 库）。Nanite 会根据摄像机距离自动流式传输几何细节，使得仿真场景中的物体可以拥有像素级别的几何精度。这对于激光雷达（LiDAR）仿真尤为关键，因为更细致的表面几何意味着更真实的激光反射点云，尤其是在模拟非结构化环境（如森林、废墟）时 。\n3.3 性能优化与场景管理\n虽然 UE5 带来了画质的飞跃，但也引入了更高的计算负载。Cosys-AirSim 针对这一挑战进行了特定的优化：\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"-实例化渲染优化-instanced-rendering\">* 实例化渲染优化 (Instanced Rendering):\u003C/h3>\n\u003Cp>改进了对大规模场景中重复对象（如仓库中的数千个集装箱或森林中的树木）的渲染效率，减少了 Draw Call 的开销。\u003C/p>\n\u003Ch3 id=\"-传感器解耦-sensor-decoupling\">* 传感器解耦 (Sensor Decoupling):\u003C/h3>\n\u003Cp>重构了传感器更新循环。在原版 AirSim 中，传感器往往与主物理循环强绑定。Cosys-AirSim 允许传感器以独立频率运行，且支持传感器在不同车辆间的灵活挂载，甚至支持独立于车辆的“世界传感器”（World Sensors），用于模拟监控摄像头等固定设施 。\n下表总结了两者在引擎支持方面的关键差异：\u003C/p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003Ctable>\u003Cthead>\u003Ctr>\u003Cth>特性维度\u003C/th>\u003Cth>Microsoft AirSim (Original)\u003C/th>\u003Cth>Cosys-AirSim\u003C/th>\u003Cth>技术影响\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd>支持的虚幻引擎\u003C/td>\u003Ctd>UE 4.27 及更早\u003C/td>\u003Ctd>UE 5.2, UE 5.5\u003C/td>\u003Ctd>图形渲染质量上限\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>物理引擎\u003C/td>\u003Ctd>NVIDIA PhysX\u003C/td>\u003Ctd>Chaos Physics\u003C/td>\u003Ctd>物理仿真精度与兼容性\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>几何系统\u003C/td>\u003Ctd>传统 Mesh LODs\u003C/td>\u003Ctd>Nanite\u003C/td>\u003Ctd>支持极高精度环境建模\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>光照系统\u003C/td>\u003Ctd>烘焙/光栅化光照\u003C/td>\u003Ctd>Lumen (实时全局光照)\u003C/td>\u003Ctd>动态光影真实度\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>维护状态\u003C/td>\u003Ctd>归档 (停止更新)\u003C/td>\u003Ctd>活跃 (持续迭代)\u003C/td>\u003Ctd>对新硬件/驱动的适配\u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\n\u003Ch1 id=\"4传感器生态系统的扩展与深化\">4.传感器生态系统的扩展与深化\u003C/h1>\n\u003Cp>传感器仿真是 Cosys-AirSim 与原版 AirSim 差异最大的领域之一。Cosys-Lab 不仅修复了原版传感器模型中的已知缺陷，还引入了全新的传感器类型，特别是针对工业应用和生物仿生研究的需求进行了定制。\u003C/p>\n\u003Ch2 id=\"41-激光雷达lidar的革新从-cpu-到-gpu\">4.1 激光雷达（LiDAR）的革新：从 CPU 到 GPU\u003C/h2>\n\u003Cp>激光雷达是自动驾驶感知的核心传感器。原版 AirSim 的 LiDAR 实现存在显著的性能瓶颈和功能缺失，而 Cosys-AirSim 对此进行了彻底的重写。\u003C/p>\n\u003Cul>\n\u003Cli>计算架构：CPU Raycast vs. GPU Acceleration\n\u003Cul>\n\u003Cli>原版 AirSim: 使用 CPU 进行射线投射（Ray-casting）来模拟激光束。当模拟低线束雷达（如 16 线 VLP-16）时性能尚可，但在模拟高线束雷达（如 64 线或 128 线）或高分辨率固态雷达时，CPU 负载会呈指数级上升，导致仿真帧率大幅下降，甚至无法满足实时性要求。\u003C/li>\n\u003Cli>Cosys-AirSim: 引入了 GPU LiDAR 传感器类型。它利用现代 GPU 的计算着色器（Compute Shaders）或光栅化管线并行处理成千上万个激光点的碰撞检测。这使得在保持高帧率的同时，能够模拟极高点密度的雷达扫描，支持模拟如 Velodyne Alpha Prime 或 Ouster OS-128 等高端传感器 。\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>回波强度（Intensity）与物理建模\n\u003Cul>\n\u003Cli>原版 AirSim: 生成的点云数据通常缺乏真实的强度信息，或者仅提供基于距离的简单衰减，无法反映物体材质对激光反射率的影响。\u003C/li>\n\u003Cli>Cosys-AirSim: 实现了基于物理的强度模拟。模型考虑了物体表面的材质属性（反射率）、激光入射角、大气衰减以及激光雷达自身的发射功率曲线。生成的点云包含真实的 Intensity 通道，这对于开发基于强度的定位算法（Intensity-based Localization）和语义分割算法至关重要 。\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>数据交付与畸变模拟\n\u003Cul>\n\u003Cli>全扫描交付 (Full Scan): 原版 AirSim 的 LiDAR 数据往往受到渲染帧率的限制，一次 API 调用可能只返回部分扫描扇区的数据。Cosys-AirSim 改进了 API，支持输出完整的 360 度扫描帧（Full Scan），确保了数据的完整性 。\u003C/li>\n\u003Cli>运动畸变 (Motion Distortion): 能够在仿真中模拟由于车辆高速运动导致的激光点云畸变（Rolling Shutter effect），这对于验证去畸变算法（De-skewing）非常有用。\n4.2 视觉传感器：光学缺陷的真实再现\n为了缩小 Sim-to-Real Gap，Cosys-AirSim 增强了相机模型，使其包含更多真实世界相机的光学瑕疵，从而防止神经网络模型在过于完美的仿真图像上发生过拟合。\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>高级畸变模型: 新增了对 色差 (Chromatic Aberration)、运动模糊 (Motion Blur) 和 透镜畸变 (Lens Distortion) 的详细参数配置。用户可以精确控制径向畸变和切向畸变的系数，以匹配真实相机的内参 。\u003C/li>\n\u003Cli>光照传感器 (Lighting Sensor): 引入了一种名为 Lighting 的新图像类型。这种图像不包含物体的纹理材质，仅渲染场景中的光照分布（包括阴影和高光）。这为研究光照不变性算法提供了独特的 Ground Truth 数据 。\u003C/li>\n\u003Cli>\u003Cem>噪声模型\u003C/em>: 实现了更复杂的深度相机噪声模型，能够模拟真实 RGB-D 相机（如 RealSense）在不同距离和材质下的测量误差，R平方值达到 0.62，显著优于原版简单的噪声叠加 。\n4.3 生物启发式感知：声纳与回声定位\n这是 Cosys-AirSim 独有的特色功能，源于 Cosys-Lab 在蝙蝠回声定位（Echolocation）方面的研究背景。\u003C/li>\n\u003Cli>Echo Sensor: 引入了高保真的声学传感器模型，能够模拟声波在三维环境中的传播、反射、衍射和多普勒效应。结合相关的开源项目 SonoNERF（神经辐射场声学建模），Cosys-AirSim 能够生成逼真的声纳图谱（Spectrograms）。\u003C/li>\n\u003Cli>应用: 这一功能使得 Cosys-AirSim 成为研究声学导航、水下声纳成像以及生物仿生机器人的独特平台，而原版 AirSim 完全不具备处理声学信号的能力 。\n4.4 语义分割与真值系统的突破\n语义分割是计算机视觉训练中最重要的数据之一。原版 AirSim 在这方面存在一个著名的“硬伤”。\u003C/li>\n\u003Cli>\u003Cem>ID 限制突破\u003C/em>: 原版 AirSim 的分割 ID 被限制在 0-255 之间（8位整数），这意味着在同一场景中最多只能区分 255 类物体。对于包含成千上万个独立对象（如森林中的每一棵树，或仓库中的每一个包裹）的大规模场景，这一限制是致命的。Cosys-AirSim 重写了底层的分割 ID 分配逻辑，支持数百万个唯一对象的 ID 映射，满足了实例分割（Instance Segmentation）和全景分割（Panoptic Segmentation）的需求 。\u003C/li>\n\u003Cli>自动标注系统: 利用 Unreal Engine 的顶点颜色（Vertex Color）技术，Cosys-AirSim 实现了对静态和动态对象的自动着色和标签生成。用户无需手动为每个资产配置 ID，系统会根据网格实例自动生成唯一的 RGB 掩码，并导出对应的 ID-名称映射表 。\u003C/li>\n\u003C/ul>\n\u003Ch1 id=\"5机器人中间件集成ros1-到-ros2-的全面进化\">5.机器人中间件集成：ROS1 到 ROS2 的全面进化\u003C/h1>\n\u003Cp>对于机器人研究者而言，仿真器与 ROS（Robot Operating System）的集成度是决定其易用性的关键。随着机器人工业界全面向 ROS2 转型以追求更好的实时性和安全性，Cosys-AirSim 在这方面的重构显得尤为重要。\u003C/p>\n\u003Ch2 id=\"51-microsoft-airsim-的-ros1-遗产\">5.1 Microsoft AirSim 的 ROS1 遗产\u003C/h2>\n\u003Cp>原版 AirSim 的 ROS 集成主要通过 airsim_ros_pkgs 实现，这是一个基于 ROS1（主要是 Melodic/Noetic 版本）的封装器（Wrapper）。\u003C/p>\n\u003Cul>\n\u003Cli>架构限制: 原版 Wrapper 本质上是一个桥接节点（Bridge Node）。它运行在 ROS 环境中，通过 TCP/IP 协议的 RPC 接口与 AirSim 二进制程序通信，获取数据后再封装为 ROS 消息发布。这种架构虽然解耦了仿真器和 ROS，但在高频数据传输时存在明显的延迟。\u003C/li>\n\u003Cli>ROS2 支持缺失: 虽然社区曾尝试通过 ros1_bridge 或早期的实验性分支来支持 ROS2，但原版 AirSim 从未提供官方稳定的 ROS2 支持。这意味着在原版 AirSim 上开发 ROS2 应用需要复杂的桥接配置，且难以利用 ROS2 的 DDS（Data Distribution Service）特性 。\n5.2 Cosys-AirSim 的原生 ROS2 重构\nCosys-AirSim 彻底重写了 ROS 集成层，使其成为 ROS2 Native 的实现，完全拥抱了 ROS2 生态 。\u003C/li>\n\u003Cli>基于 rclcpp 的原生实现:\n\u003Cul>\n\u003Cli>Cosys-AirSim 摒弃了旧的 Wrapper 架构，直接使用 ROS2 的 C++ 客户端库 (rclcpp) 在插件内部编写节点。这意味着仿真器本身就是一个或多个 ROS2 节点，可以直接参与 ROS2 网络的数据交换 。\u003C/li>\n\u003Cli>优势: 这种原生集成允许利用 ROS2 的零拷贝（Zero-copy）通信机制（在同一进程内），大幅降低了图像和点云等大数据量传输的延迟。同时，它支持 ROS2 的生命周期管理（Lifecycle Nodes），允许外部控制器动态管理仿真节点的启动、暂停和配置。\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>TF 树与坐标系的标准化:\n\u003Cul>\n\u003Cli>原版 AirSim 中，坐标系转换（从 Unreal 的左手系 NED 到 ROS 的右手系 ENU）经常引起混淆。Cosys-AirSim 重新设计了坐标变换（TF）树的结构，严格遵循 REP-105 标准：world -> odom -> vehicle -> sensors 。\u003C/li>\n\u003Cli>这修正了原版中常见的坐标系不一致问题，使得 Cosys-AirSim 能够无缝对接 Nav2（ROS2 Navigation Stack）等标准导航包，无需用户手动编写复杂的坐标转换脚本 。\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>自定义消息与服务扩展:\n\u003Cul>\n\u003Cli>Cosys-AirSim 不仅发布标准的传感器话题，还扩展了大量的 ROS2 Service 和 Action。用户可以通过 ROS 命令行或节点直接控制仿真环境，例如动态改变天气参数、控制非玩家车辆（NPC）的行为、或者触发特定的仿真事件。\u003C/li>\n\u003Cli>话题列表也进行了现代化更新，例如相机图像话题现在采用符合 ROS2 最佳实践的命名空间结构，如 /sensing/camera/image_raw，并支持 QoS（Quality of Service）策略配置，允许在不可靠网络下丢弃过时数据以保证实时性 。\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>Unity 支持的移除:\n\u003Cul>\n\u003Cli>为了集中资源优化 UE5 和 ROS2 的体验，Cosys-AirSim 明确做出了战略取舍，移除了原版 AirSim 中实验性的 Unity 引擎支持 。这一决定虽然减少了引擎的选择，但换来的是在 Unreal + ROS2 这一主流技术栈上的极致优化。\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003C/ul>\n\u003Ch1 id=\"6载具动力学与跨域扩展从陆空到海洋\">6.载具动力学与跨域扩展：从陆空到海洋\u003C/h1>\n\u003Cp>原版 AirSim 的设计初衷主要聚焦于四旋翼无人机（Multirotor）和乘用车（Car）。Cosys-AirSim 则打破了这一局限，极大地扩展了载具库，涵盖了更多样的机器人形态，甚至拓展到了水面领域，实现了“海陆空”全域仿真。\u003C/p>\n\u003Ch2 id=\"61-地面移动机器人的多样化不止于汽车\">6.1 地面移动机器人的多样化：不止于汽车\u003C/h2>\n\u003Cp>在原版 AirSim 中，如果想模拟一个仓库里的轮式机器人，通常只能借用 Car 模型，但这会导致物理行为的不准确（例如汽车是阿克曼转向，而机器人通常是差速转向）。\u003C/p>\n\u003Cul>\n\u003Cli>差速/滑移转向模型 (Skid Steering):\n\u003Cul>\n\u003Cli>Cosys-AirSim 引入了通用的滑移转向物理模型。这是大多数履带式车辆和差速轮式机器人的运动基础。\u003C/li>\n\u003Cli>内置模型: 官方内置了 ClearPath Husky 和 Pioneer P3DX 等经典科研机器人的高精度模型 。这使得 Cosys-AirSim 可以直接用于仓储物流机器人、野外巡检机器人等非乘用车型算法的开发与验证。\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\u003Cem>BoxCar\u003C/em>:\n\u003Cul>\n\u003Cli>为了在资源受限的环境下进行快速算法验证，Cosys-AirSim 添加了一个名为 BoxCar 的简化车辆模型。它去除了复杂的悬挂和车轮物理计算，仅保留基本的运动学特性，非常适合用于大规模强化学习训练中的快速迭代 。\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"62-asvsim水面无人艇仿真\">6.2 ASVSim：水面无人艇仿真\u003C/h2>\n\u003Cp>这是一个具有里程碑意义的扩展，标志着 AirSim 生态系统首次正式进入海洋工程领域。基于 Cosys-AirSim 框架，研究团队开发了 ASVSim（AirSim for Surface Vehicles）。\u003C/p>\n\u003Cul>\n\u003Cli>流体动力学与浮力模型:\n\u003Cul>\n\u003Cli>ASVSim 集成了专门的船舶流体动力学模型。它不仅仅是将船视为在“蓝色地面”上滑行的汽车，而是真实模拟了水的浮力（Buoyancy）、水动阻力（Hydrodynamic Drag）以及波浪对船体产生的六自由度运动影响（如横摇、纵摇）。\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>海事传感器仿真:\n\u003Cul>\n\u003Cli>雷达: 实现了专门的海事导航雷达模拟。不同于激光雷达，ASVSim 的雷达模型应用了点扩散函数（PSF），能够生成具有真实噪声和杂波的雷达扫描图像（PPI 显示），支持基于雷达的海岸线检测和避障算法开发 。\u003C/li>\n\u003Cli>应用场景: 这一扩展使得 Cosys-AirSim 能够支持内河航运、港口自动化监测以及水面垃圾清理机器人的仿真研究，特别是在安特卫普港等复杂水域环境的模拟中发挥了重要作用 。\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"63-航空动力学的精细化\">6.3 航空动力学的精细化\u003C/h2>\n\u003Cp>针对无人机，Cosys-AirSim 也进行了微调。它引入了改进的空气阻力模型，相比原版在高速飞行（如 10m/s）时的阻力模拟误差降低了 51%，使得能耗预测和轨迹规划更加准确 。\u003C/p>\n\u003Ch1 id=\"7api-与开发生态继承中的变革\">7.API 与开发生态：继承中的变革\u003C/h1>\n\u003Cp>Cosys-AirSim 在大幅扩展功能的同时，也致力于保持开发体验的连续性，但为了技术进步，不得不引入一些破坏性变更（Breaking Changes）。\u003C/p>\n\u003Ch2 id=\"71-接口兼容性与破坏性变更\">7.1 接口兼容性与破坏性变更\u003C/h2>\n\u003Cp>Cosys-AirSim 尽可能保持了 Python 和 C++ API 的向后兼容性，这意味着大多数基于原版 AirSim 编写的控制脚本（如 moveByVelocityAsync）无需修改即可运行。但在以下几个关键领域发生了变更：\u003C/p>\n\u003Cul>\n\u003Cli>相机命名规范:\n\u003Cul>\n\u003Cli>原版 AirSim: 允许使用数字索引（0, 1, 2…）或字符串ID来访问相机。\u003C/li>\n\u003Cli>Cosys-AirSim: 为了支持更复杂的传感器配置，强制推行基于字符串名称的访问方式（如 “front_center”, “back_right”）。虽然为了兼容性保留了数字字符串别名（“0” 而非 0），但这要求开发者更新代码习惯，显式地使用具有语义的传感器名称，以避免在多传感器系统中的混淆 。\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>ROS2 话题重命名:\n\u003Cul>\n\u003Cli>如前所述，ROS 侧的话题名称和消息类型发生了根本性变化，以符合 ROS2 标准。旧的 ROS1 启动脚本（Launch files）无法直接用于 Cosys-AirSim，必须重写 。\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"72-matlab-客户端的引入工程科研的福音\">7.2 Matlab 客户端的引入：工程科研的福音\u003C/h2>\n\u003Cp>原版 AirSim 官方仅提供 C++ 和 Python 客户端，这对于习惯使用 Matlab/Simulink 进行控制理论研究、信号处理和硬件在环（HIL）仿真的传统工程人员来说是一个门槛。\u003C/p>\n\u003Cul>\n\u003Cli>Cosys-AirSim Matlab Client: 官方引入并维护了一个完整的 Matlab API 客户端工具箱 。\u003C/li>\n\u003Cli>功能: 它允许用户直接在 Matlab 环境中获取传感器数据、发送控制指令，甚至与 Simulink 模型进行联合仿真。这极大地简化了控制算法从理论设计到仿真验证的流程。\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"73-文档与社区支持模式\">7.3 文档与社区支持模式\u003C/h2>\n\u003Cul>\n\u003Cli>文档迁移: 随着 Microsoft 关闭并归档了原版文档站，Cosys-AirSim 建立了独立的文档托管站点（cosys-lab.github.io/Cosys-AirSim/）。文档结构进行了重组，专门增加了针对 UE5 迁移和 ROS2 配置的章节 。\u003C/li>\n\u003Cli>“As-is” 支持模式: 需要注意的是，作为一个学术实验室维护的开源项目，Cosys-AirSim 明确声明软件是“按原样提供”（Provided As-is），不提供类似于微软时期的商业级支持承诺。社区互动主要依赖于 GitHub Issues 和相关的学术会议（如 ANNSIM），用户需要具备更强的自我排错能力 。\u003C/li>\n\u003C/ul>\n\u003Ch1 id=\"8-多智能体与集群仿真swarm-simulation\">8. 多智能体与集群仿真（Swarm Simulation）\u003C/h1>\n\u003Cp>多智能体与集群仿真（Swarm Simulation）:在复杂的工业和救援场景中，单体机器人的能力往往有限，多机器人协同（Swarm Robotics）成为研究热点。Cosys-AirSim 利用 UE5 和 ROS2 的特性，在集群仿真方面展现了显著优势。\u003C/p>\n\u003Ch2 id=\"81-性能优化与分布式架构\">8.1 性能优化与分布式架构\u003C/h2>\n\u003Cp>原版 AirSim 虽然支持多车模式，但在车辆数量增加时，物理计算和渲染开销会导致性能急剧下降。\u003C/p>\n\u003Cul>\n\u003Cli>实例化与优化: Cosys-AirSim 通过 UE5 的实例化技术优化了多智能体的渲染。更重要的是，基于 ROS2 的分布式架构允许将繁重的计算任务（如SLAM、路径规划）卸载到不同的计算节点甚至不同的物理机器上，仅保留仿真器进行物理和渲染计算。这使得在单台高性能工作站上实时模拟数十台无人机的集群成为可能 。\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"82-典型应用场景\">8.2 典型应用场景\u003C/h2>\n\u003Cul>\n\u003Cli>工业巡检: 在布满管道、梁柱和设备的化工厂或海上钻井平台中，利用无人机集群进行覆盖式巡检。Cosys-AirSim 的高保真 LiDAR 和相机能够生成逼真的复杂结构点云，用于训练集群避障和协同建图算法。\u003C/li>\n\u003Cli>搜索与救援 (SAR): 模拟在灾后废墟环境中的搜索任务。利用其独特的声纳（Echo）传感器模拟，研究人员可以开发在烟雾或光线不足环境下依靠声学感知的搜索算法 。\u003C/li>\n\u003C/ul>\n\u003Ch1 id=\"9-结论与建议\">9. 结论与建议\u003C/h1>\n\u003Ch2 id=\"91-核心结论\">9.1 核心结论\u003C/h2>\n\u003Cp>综上所述，Cosys-AirSim 并非原版 Microsoft AirSim 的简单替代品，而是一次全方位的现代化升级。\u003C/p>\n\u003Cul>\n\u003Cli>不可逆的替代: 原版 Microsoft AirSim 已属“废弃软件”（Abandonware），且技术栈停留在 UE4 和 PhysX 时代。对于任何计划长期发展、且希望利用 Unreal Engine 5 强大功能的项目，Cosys-AirSim 是目前唯一可行的开源选择。\u003C/li>\n\u003Cli>功能超集: Cosys-AirSim 包含了原版的所有核心功能，并在物理引擎、渲染管线、传感器模态（GPU LiDAR, Sonar）、ROS2 集成以及载具类型（USV, Husky）上进行了深度扩展。\u003C/li>\n\u003Cli>门槛提升: 虽然功能强大，但对 UE5 和 ROS2 的依赖也提高了硬件门槛（需要支持 DirectX 12/Vulkan 的高性能 GPU）和技术栈要求。\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"92-给研究人员与工程师的建议\">9.2 给研究人员与工程师的建议\u003C/h2>\n\u003Cul>\n\u003Cli>迁移策略: 对于仍在使用原版 AirSim 的用户，建议尽早启动迁移评估。虽然 Python 脚本改动不大，但 ROS 接口和物理参数的调整需要时间。\u003C/li>\n\u003Cli>新项目启动: 强烈建议直接基于 Cosys-AirSim 和 UE 5.2/5.5 启动新项目。利用其预编译插件可以大幅降低环境配置的复杂度。\u003C/li>\n\u003Cli>学术价值: Cosys-AirSim 提供的地面真值生成（语义分割、光照图）和新型传感器（声纳、高保真 LiDAR）为发表高质量、数据驱动的机器人学论文提供了强有力的工具支持。\nCosys-AirSim 成功地接过了开源高保真仿真的火炬，它不仅延续了 AirSim 的生命，更将其推向了更广阔的工业应用与跨域机器人研究的前沿。\u003C/li>\n\u003C/ul>",{"headings":161,"localImagePaths":246,"remoteImagePaths":247,"frontmatter":154,"imagePaths":248},[162,165,168,171,174,177,180,183,186,189,192,195,198,201,204,207,210,213,216,219,222,225,228,231,234,237,240,243],{"depth":20,"slug":163,"text":164},"cosys-airsim-与-microsoft-airsim-的架构演进功能差异及生态系统对比","Cosys-AirSim 与 Microsoft AirSim 的架构演进、功能差异及生态系统对比",{"depth":20,"slug":166,"text":167},"1-执行摘要","1. 执行摘要",{"depth":20,"slug":169,"text":170},"2-引言仿真平台的代际更替与技术分叉","2. 引言：仿真平台的代际更替与技术分叉",{"depth":40,"slug":172,"text":173},"21-microsoft-airsim-的历史地位与终结","2.1 Microsoft AirSim 的历史地位与终结",{"depth":40,"slug":175,"text":176},"22-cosys-airsim-的崛起与定位","2.2 Cosys-AirSim 的崛起与定位",{"depth":20,"slug":178,"text":179},"3-核心架构与引擎支持","3. 核心架构与引擎支持",{"depth":40,"slug":181,"text":182},"31-物理引擎的范式转移physx-vs-chaos","3.1 物理引擎的范式转移：PhysX vs. Chaos",{"depth":47,"slug":184,"text":185},"-microsoft-airsim-legacy---深度绑定-nvidia-physx","* Microsoft AirSim (Legacy) - 深度绑定 NVIDIA PhysX",{"depth":47,"slug":187,"text":188},"-实例化渲染优化-instanced-rendering","* 实例化渲染优化 (Instanced Rendering):",{"depth":47,"slug":190,"text":191},"-传感器解耦-sensor-decoupling","* 传感器解耦 (Sensor Decoupling):",{"depth":20,"slug":193,"text":194},"4传感器生态系统的扩展与深化","4.传感器生态系统的扩展与深化",{"depth":40,"slug":196,"text":197},"41-激光雷达lidar的革新从-cpu-到-gpu","4.1 激光雷达（LiDAR）的革新：从 CPU 到 GPU",{"depth":20,"slug":199,"text":200},"5机器人中间件集成ros1-到-ros2-的全面进化","5.机器人中间件集成：ROS1 到 ROS2 的全面进化",{"depth":40,"slug":202,"text":203},"51-microsoft-airsim-的-ros1-遗产","5.1 Microsoft AirSim 的 ROS1 遗产",{"depth":20,"slug":205,"text":206},"6载具动力学与跨域扩展从陆空到海洋","6.载具动力学与跨域扩展：从陆空到海洋",{"depth":40,"slug":208,"text":209},"61-地面移动机器人的多样化不止于汽车","6.1 地面移动机器人的多样化：不止于汽车",{"depth":40,"slug":211,"text":212},"62-asvsim水面无人艇仿真","6.2 ASVSim：水面无人艇仿真",{"depth":40,"slug":214,"text":215},"63-航空动力学的精细化","6.3 航空动力学的精细化",{"depth":20,"slug":217,"text":218},"7api-与开发生态继承中的变革","7.API 与开发生态：继承中的变革",{"depth":40,"slug":220,"text":221},"71-接口兼容性与破坏性变更","7.1 接口兼容性与破坏性变更",{"depth":40,"slug":223,"text":224},"72-matlab-客户端的引入工程科研的福音","7.2 Matlab 客户端的引入：工程科研的福音",{"depth":40,"slug":226,"text":227},"73-文档与社区支持模式","7.3 文档与社区支持模式",{"depth":20,"slug":229,"text":230},"8-多智能体与集群仿真swarm-simulation","8. 多智能体与集群仿真（Swarm Simulation）",{"depth":40,"slug":232,"text":233},"81-性能优化与分布式架构","8.1 性能优化与分布式架构",{"depth":40,"slug":235,"text":236},"82-典型应用场景","8.2 典型应用场景",{"depth":20,"slug":238,"text":239},"9-结论与建议","9. 结论与建议",{"depth":40,"slug":241,"text":242},"91-核心结论","9.1 核心结论",{"depth":40,"slug":244,"text":245},"92-给研究人员与工程师的建议","9.2 给研究人员与工程师的建议",[],[],[],"post_20251229070308.md","post_20251229070613",{"id":250,"data":252,"body":253,"filePath":254,"digest":255,"rendered":256,"legacyId":274},{},"# 解决Unity导入Google.Protobuf.dll的依赖缺失报错\n## 报错信息\n描述：在直接导入Google.Protobuf.dll时会出现以下两个报错信息\n```bash\n1.Assembly 'Library/ScriptAssemblies/Assembly-CSharp.dll' will not be loaded due to errors:\nReference has errors 'Google.Protobuf'.\n2.Assembly 'Assets/Plugins/Google.Protobuf.dll' will not be loaded due to errors:\nUnable to resolve reference 'System.Runtime.CompilerServices.Unsafe'. Is the assembly missing or incompatible with the current platform?\nReference validation can be disabled in the Plugin Inspector.\n```\n## 报错原因\nGoogle.Protobuf.dll 里面有的依赖并不是UnityEditor里面的版本，所以就会出现unity报错，但是VS2022内不报错的情况\n## 解决方法\n下载Google Protobuf 的开源代码使用VS2022生成解决方案，再把bin>Debug>net45文件夹内容全部一起导入unity即可\n下载地址：https://github.com/protocolbuffers/protobuf/releases\n\n## 问题解决","src/content/posts/post_20251229070613.md","d781b79efa39eac5",{"html":257,"metadata":258},"\u003Ch1 id=\"解决unity导入googleprotobufdll的依赖缺失报错\">解决Unity导入Google.Protobuf.dll的依赖缺失报错\u003C/h1>\n\u003Ch2 id=\"报错信息\">报错信息\u003C/h2>\n\u003Cp>描述：在直接导入Google.Protobuf.dll时会出现以下两个报错信息\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">1.Assembly\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 'Library/ScriptAssemblies/Assembly-CSharp.dll'\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> will\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> not\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> be\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> loaded\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> due\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> to\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> errors:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">Reference\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> has\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> errors\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 'Google.Protobuf'.\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">2.Assembly\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 'Assets/Plugins/Google.Protobuf.dll'\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> will\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> not\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> be\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> loaded\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> due\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> to\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> errors:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">Unable\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> to\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> resolve\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> reference\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 'System.Runtime.CompilerServices.Unsafe'.\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Is\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> the\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> assembly\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> missing\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> or\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> incompatible\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> with\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> the\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> current\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> platform?\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">Reference\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> validation\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> can\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> be\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> disabled\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> in\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> the\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Plugin\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Inspector.\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"报错原因\">报错原因\u003C/h2>\n\u003Cp>Google.Protobuf.dll 里面有的依赖并不是UnityEditor里面的版本，所以就会出现unity报错，但是VS2022内不报错的情况\u003C/p>\n\u003Ch2 id=\"解决方法\">解决方法\u003C/h2>\n\u003Cp>下载Google Protobuf 的开源代码使用VS2022生成解决方案，再把bin>Debug>net45文件夹内容全部一起导入unity即可\n下载地址：\u003Ca href=\"https://github.com/protocolbuffers/protobuf/releases\">https://github.com/protocolbuffers/protobuf/releases\u003C/a>\u003C/p>\n\u003Ch2 id=\"问题解决\">问题解决\u003C/h2>",{"headings":259,"localImagePaths":271,"remoteImagePaths":272,"frontmatter":252,"imagePaths":273},[260,263,265,267,269],{"depth":20,"slug":261,"text":262},"解决unity导入googleprotobufdll的依赖缺失报错","解决Unity导入Google.Protobuf.dll的依赖缺失报错",{"depth":40,"slug":264,"text":264},"报错信息",{"depth":40,"slug":266,"text":266},"报错原因",{"depth":40,"slug":268,"text":268},"解决方法",{"depth":40,"slug":270,"text":270},"问题解决",[],[],[],"post_20251229070613.md","post_20251229070750",{"id":275,"data":277,"body":278,"filePath":279,"digest":280,"rendered":281,"legacyId":310},{},"# Unity 编辑器扩展：小说阅读器\n# 前言\n想看小说又不想多开一个程序在桌面上，写了一个简单的脚本阅读器融合进Unity的检视窗口\n其实就是上班摸鱼时用的！😁\n\n***要点：***\n - 使用的Unity自动的PlayerPrefs进行进度的保存 \n - 识别目录用的简单的正则表达式 \n - 识别速度还行，2000章的文本用不了1秒就能识别完毕\n - 支持按键绑定\n# 效果演示\n\n# 使用步骤\n## 1.引入代码\n\n```csharp\nusing System.Collections;\nusing System.Collections.Generic;\nusing System.Text.RegularExpressions;\nusing UnityEditor;\nusing UnityEngine;\n\npublic class NovelFish : MonoBehaviour\n{\n    private string[] _novelChapters;\n    private string[] _novelWords;\n\n    //小说显示内容\n    [Multiline(10)]\n    public string novel = \"\";\n    //TXT文本文件\n    public TextAsset novelFile;\n    public KeyCode 上一页 = KeyCode.Mouse0;\n    public KeyCode 下一页 = KeyCode.Mouse1;\n    public KeyCode 隐藏 = KeyCode.Mouse2;\n    public KeyCode 自动播放 = KeyCode.A;\n    public KeyCode 上一章 = KeyCode.PageUp;\n    public KeyCode 下一章 = KeyCode.PageDown;\n\n    public bool _isPlaying;\n    public int ChapterTarget;\n    private int ChapterIndex\n    {\n        get => PlayerPrefs.GetInt(\"Chapter_\" + novelFile.name, 0);\n        set => PlayerPrefs.SetInt(\"Chapter_\" + novelFile.name, value);\n    }\n\n    private int NowChapterIndex\n    {\n        get => PlayerPrefs.GetInt(\"Now_\" + novelFile.name, 0);\n        set => PlayerPrefs.SetInt(\"Now_\" + novelFile.name, value);\n    }\n\n\n    private void Start()\n    {\n        LoadNovel();\n    }\n\n    //章节跳转\n    [ContextMenu(\"章节跳转\")]\n    private void JumpPage()\n    {\n        if (ChapterTarget \u003C 0 || ChapterTarget >= _novelChapters.Length)\n            return;\n        ChapterIndex = ChapterTarget;\n        NowChapterIndex = 0;\n        _novelWords = LoadOriginalWord(_novelChapters[ChapterTarget]);\n        novel = _novelWords[NowChapterIndex];\n    }\n\n    //重置文章\n    [ContextMenu(\"重置文章\")]\n    private void ResetText()\n    {\n        NowChapterIndex = 0;\n        ChapterIndex = 0;\n        LoadNovel();\n        print(\"总章数：\" + _novelChapters.Length);\n    }\n\n    //文章（按章节）加载\n    private void LoadNovel()\n    {\n        //第1章\n        var pattern = @\"(?m)^[第][0-9]{1,4}[章]\";\n        //000 nnn\n        // var pattern = @\"(?m)^\\d{3,4}[\\s]\";\n        //第一章 （中文数字）\n\t    // var pattern = @\"(?m)^[第][\\u4e00-\\u9fa5]{1,5}[章]\";\n\n\n        var novelChapters = Regex.Split(novelFile.text, pattern);\n        for (var i = 0; i \u003C novelChapters.Length; i++)\n        {\n            novelChapters[i] = \"第\" + i + \"章\" + novelChapters[i];\n        }\n\n        _novelChapters = novelChapters;\n        _novelWords = LoadOriginalWord(_novelChapters[ChapterIndex]);\n        // novel = _novelWords[NowChapterIndex];\n    }\n\n    //按键绑定\n    public void Update()\n    {\n        if (Input.GetKeyDown(下一页))\n            PageDown();\n        if (Input.GetKeyDown(上一页))\n            PageUp();\n        if (Input.GetKeyDown(隐藏))\n            Hide();\n        if (Input.GetKeyDown(自动播放))\n            AutoPlay();\n        if (Input.GetKeyDown(上一章))\n            UpChapter();\n        if (Input.GetKeyDown(下一章))\n            DownChapter(); \n    }\n\n    //上一章\n    private void PageUp()\n    {\n        NowChapterIndex--;\n        if (NowChapterIndex == -1)\n        {\n            ChapterIndex--;\n            _novelWords = LoadOriginalWord(_novelChapters[ChapterIndex]);\n            NowChapterIndex = _novelWords.Length - 1;\n        }\n\n        novel = _novelWords[NowChapterIndex];\n    }\n\n    //下一章\n    private void PageDown()\n    {\n        NowChapterIndex++;\n        if (NowChapterIndex == _novelWords.Length)\n        {\n            ChapterIndex++;\n            NowChapterIndex = 0;\n            _novelWords = LoadOriginalWord(_novelChapters[ChapterIndex]);\n        }\n\n        novel = _novelWords[NowChapterIndex];\n    }\n\n    //下一页\n    private void DownChapter()\n    {\n        ChapterIndex++;\n        NowChapterIndex = 0;\n        _novelWords = LoadOriginalWord(_novelChapters[ChapterIndex]);\n        novel = _novelWords[NowChapterIndex];\n    }\n\n    //上一页\n    private void UpChapter()\n    {\n        ChapterIndex--;\n        NowChapterIndex = 0;\n        _novelWords = LoadOriginalWord(_novelChapters[ChapterIndex]);\n        novel = _novelWords[NowChapterIndex];\n    }\n\n    //自动播放\n    private void AutoPlay()\n    {\n        _isPlaying = !_isPlaying;\n        if (_isPlaying)\n            StartCoroutine(nameof(AutoPlayIe));\n        else\n            StopCoroutine(nameof(AutoPlayIe));\n    }\n\n    private IEnumerator AutoPlayIe()\n    {\n        PageDown();\n        // 自动播放延迟\n        yield return new WaitForSeconds(5f);\n        StartCoroutine(nameof(AutoPlayIe));\n    }\n\n    //快速隐藏（显示）\n    private void Hide()\n    {\n        var haveWord = novel != \"\";\n        novel = haveWord ? \"\" : _novelWords[NowChapterIndex];\n    }\n\n    //文字最多显示数量\n    private const int MaxWordLength = 200;\n\n    /// \u003Csummary>\n    /// 加载文章片段\n    /// \u003C/summary>\n    private static string[] LoadOriginalWord(string word)\n    {\n        var novelFileList = new List\u003Cstring>();\n        var originalWord = word.Split('\\n');\n        for (var i = 0; i \u003C originalWord.Length; i++)\n        {\n            //处理掉空字符串\n            originalWord[i] = Regex.Replace(originalWord[i], @\"\\s\", \"\");\n            if (originalWord[i].Length > 1 && originalWord[i].Length \u003C= 200)\n            {\n                novelFileList.Add(originalWord[i]);\n            }\n            else if (originalWord[i].Length > 200)\n            {\n                var ccl = originalWord[i].Length / MaxWordLength;\n                for (var j = 0; j \u003C= ccl; j++)\n                {\n                    if (originalWord[i].Length != j * MaxWordLength)\n                        novelFileList.Add(originalWord[i].Substring(j * MaxWordLength,\n                            j == ccl ? (originalWord[i].Length - j * MaxWordLength) - 1 : MaxWordLength));\n                }\n            }\n        }\n\n        return novelFileList.ToArray();\n    }\n}\n\n```\nodin插件版\n![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/1af3cc8a4eb94dda4e0d528d4a66c1e6.png)\n\n```csharp\nusing Sirenix.OdinInspector;\nusing System.Collections;\nusing System.Collections.Generic;\nusing System.Text.RegularExpressions;\nusing UnityEngine;\n\npublic class NovelFish : MonoBehaviour\n{\n    public enum TitleType\n    {\n        T00Z,  // 00 Z\n        D00Z,  // DI 00 Z\n        DCNZ,  // DI CNNUME Z\n    }\n    private string[] _novelChapters;\n    private string[] _novelWords;\n    private const int MAX_WORD_LENGTH = 200;\n    [Multiline(9), ReadOnly]\n    public string novel = \"\";\n\n    [FoldoutGroup(\"SET\")] public TextAsset novelFile;\n    [FoldoutGroup(\"SET\")] public TitleType titleType;\n    [FoldoutGroup(\"SET\")] public KeyCode Up = KeyCode.Mouse0;\n    [FoldoutGroup(\"SET\")] public KeyCode Down = KeyCode.Mouse1;\n    [FoldoutGroup(\"SET\")] public KeyCode HideKey = KeyCode.Mouse2;\n    [FoldoutGroup(\"SET\")] public KeyCode Auto = KeyCode.A;\n    [FoldoutGroup(\"SET\")] public KeyCode PageUpKey = KeyCode.PageUp;\n    [FoldoutGroup(\"SET\")] public KeyCode PageDownKey = KeyCode.PageDown;\n    [FoldoutGroup(\"SET\")] public KeyCode Stop = KeyCode.P;\n    [FoldoutGroup(\"SET\"), Range(1f, 20f)] public float AutoSpeed = 5f;\n\n    private bool _isPlaying;\n    private bool _isPaused = true;\n\n    private int ChapterIndex\n    {\n        get => PlayerPrefs.GetInt(\"Chapter_\" + novelFile.name, 0);\n        set => PlayerPrefs.SetInt(\"Chapter_\" + novelFile.name, value);\n    }\n    private int NowChapterIndex\n    {\n        get => PlayerPrefs.GetInt(\"Now_\" + novelFile.name, 0);\n        set => PlayerPrefs.SetInt(\"Now_\" + novelFile.name, value);\n    }\n\n    private void Start()\n    {\n        if (novelFile == null)\n        {\n            _isPaused = true;\n            return;\n        }\n        LoadNovel();\n    }\n\n    [Button(Expanded = true), FoldoutGroup(\"SET\")]\n    private void JumpPage(int num)\n    {\n        if (num \u003C 0 || num >= _novelChapters.Length)\n            return;\n        ChapterIndex = num;\n        NowChapterIndex = 0;\n        _novelWords = LoadOriginalWord(_novelChapters[ChapterIndex]);\n        novel = _novelWords[NowChapterIndex];\n    }\n\n    [Button, FoldoutGroup(\"SET\")]\n    private void Clear()\n    {\n        novel = \"\";\n    }\n\n    [Button, FoldoutGroup(\"SET\")]\n    private void ResetText()\n    {\n        NowChapterIndex = 0;\n        ChapterIndex = 0;\n        LoadNovel();\n        print(\"Total：\" + _novelChapters.Length);\n    }\n\n    private void LoadNovel()\n    {\n        string pattern = string.Empty;\n        switch (titleType)\n        {\n            case TitleType.T00Z:\n                pattern = @\"(?m)^\\d{3,4}[\\s]\";\n                break;\n            case TitleType.D00Z:\n                pattern = @\"(?m)^[第][0-9]{1,4}[章]\";\n                break;\n            case TitleType.DCNZ:\n                pattern = @\"(?m)^[第][\\u4e00-\\u9fa5]{1,5}[章]\";\n                break;\n        }\n\n        var novelChapters = Regex.Split(novelFile.text, pattern);\n        for (var i = 0; i \u003C novelChapters.Length; i++)\n        {\n            novelChapters[i] = \"第\" + i + \"章\" + novelChapters[i];\n        }\n\n        _novelChapters = novelChapters;\n        _novelWords = LoadOriginalWord(_novelChapters[ChapterIndex]);\n    }\n\n    //按键绑定\n    public void Update()\n    {\n        if (Input.GetKeyDown(Stop))\n            _isPaused = !_isPaused;\n        if (_isPaused) return;\n\n        if (Input.GetKeyDown(Down))\n            PageDown();\n        if (Input.GetKeyDown(Up))\n            PageUp();\n        if (Input.GetKeyDown(HideKey))\n            Hide();\n        if (Input.GetKeyDown(Auto))\n            AutoPlay();\n        if (Input.GetKeyDown(PageUpKey))\n            UpChapter();\n        if (Input.GetKeyDown(PageDownKey))\n            DownChapter();\n    }\n\n    //上一章\n    private void PageUp()\n    {\n        NowChapterIndex--;\n        if (NowChapterIndex == -1)\n        {\n            ChapterIndex--;\n            _novelWords = LoadOriginalWord(_novelChapters[ChapterIndex]);\n            NowChapterIndex = _novelWords.Length - 1;\n        }\n        novel = _novelWords[NowChapterIndex];\n    }\n\n\n    public void PageDown(int page)\n    {\n        NowChapterIndex += page;\n        if (NowChapterIndex >= _novelWords.Length)\n        {\n            ChapterIndex++;\n            NowChapterIndex = 0;\n            _novelWords = LoadOriginalWord(_novelChapters[ChapterIndex]);\n        }\n\n        novel = _novelWords[NowChapterIndex];\n    }\n\n    private void PageDown()\n    {\n        NowChapterIndex++;\n        if (NowChapterIndex == _novelWords.Length)\n        {\n            ChapterIndex++;\n            NowChapterIndex = 0;\n            _novelWords = LoadOriginalWord(_novelChapters[ChapterIndex]);\n        }\n\n        novel = _novelWords[NowChapterIndex];\n    }\n\n\n    private void DownChapter()\n    {\n        ChapterIndex++;\n        NowChapterIndex = 0;\n        _novelWords = LoadOriginalWord(_novelChapters[ChapterIndex]);\n        novel = _novelWords[NowChapterIndex];\n    }\n\n\n    private void UpChapter()\n    {\n        ChapterIndex--;\n        NowChapterIndex = 0;\n        _novelWords = LoadOriginalWord(_novelChapters[ChapterIndex]);\n        novel = _novelWords[NowChapterIndex];\n    }\n\n    private void AutoPlay()\n    {\n        _isPlaying = !_isPlaying;\n        if (_isPlaying)\n            StartCoroutine(nameof(AutoPlayIe));\n        else\n            StopCoroutine(nameof(AutoPlayIe));\n    }\n\n    private IEnumerator AutoPlayIe()\n    {\n        PageDown();\n        yield return new WaitForSeconds(AutoSpeed);\n        if (_isPaused)\n        {\n            _isPlaying = false;\n        }\n        else\n        {\n            StartCoroutine(nameof(AutoPlayIe));\n        }\n    }\n\n    //快速隐藏（显示）\n    private void Hide()\n    {\n        var haveWord = novel != \"\";\n        novel = haveWord ? \"\" : _novelWords[NowChapterIndex];\n    }\n\n    /// \u003Csummary>\n    /// 加载文章片段\n    /// \u003C/summary>\n    private static string[] LoadOriginalWord(string word)\n    {\n        var novelFileList = new List\u003Cstring>();\n        var originalWord = word.Split('\\n');\n        for (var i = 0; i \u003C originalWord.Length; i++)\n        {\n            //处理掉空字符串\n            originalWord[i] = Regex.Replace(originalWord[i], @\"\\s\", \"\");\n            if (originalWord[i].Length > 1 && originalWord[i].Length \u003C= 200)\n            {\n                novelFileList.Add(originalWord[i]);\n            }\n            else if (originalWord[i].Length > 200)\n            {\n                var ccl = originalWord[i].Length / MAX_WORD_LENGTH;\n                for (var j = 0; j \u003C= ccl; j++)\n                {\n                    if (originalWord[i].Length != j * MAX_WORD_LENGTH)\n                        novelFileList.Add(originalWord[i].Substring(j * MAX_WORD_LENGTH,\n                            j == ccl ? (originalWord[i].Length - j * MAX_WORD_LENGTH) - 1 : MAX_WORD_LENGTH));\n                }\n            }\n        }\n\n        return novelFileList.ToArray();\n    }\n}\n\n\n```\n\n## 2.导入的小说文本 TXT\n`记得要将导入的txt格式设置为UTF-8不然识别不出来`\n可以用记事本打开让后另存为时设置格式就好了\n## 3.在代码块里选择你下载文件的目录格式\n在70行代码左右`注释掉不用的正则表达式部分`\n\n\n## 4.拖入文本文件再选择重置文章即可\n\n# 总结\n目前缺陷还是有的，不能自动识别小说目录格式，必须在游戏运行模式下使用（用的Input检测）。\n有空还是可以改改的。","src/content/posts/post_20251229070750.md","9a753bbf3ac875a7",{"html":282,"metadata":283},"\u003Ch1 id=\"unity-编辑器扩展小说阅读器\">Unity 编辑器扩展：小说阅读器\u003C/h1>\n\u003Ch1 id=\"前言\">前言\u003C/h1>\n\u003Cp>想看小说又不想多开一个程序在桌面上，写了一个简单的脚本阅读器融合进Unity的检视窗口\n其实就是上班摸鱼时用的！😁\u003C/p>\n\u003Cp>\u003Cem>\u003Cstrong>要点：\u003C/strong>\u003C/em>\u003C/p>\n\u003Cul>\n\u003Cli>使用的Unity自动的PlayerPrefs进行进度的保存\u003C/li>\n\u003Cli>识别目录用的简单的正则表达式\u003C/li>\n\u003Cli>识别速度还行，2000章的文本用不了1秒就能识别完毕\u003C/li>\n\u003Cli>支持按键绑定\u003C/li>\n\u003C/ul>\n\u003Ch1 id=\"效果演示\">效果演示\u003C/h1>\n\u003Ch1 id=\"使用步骤\">使用步骤\u003C/h1>\n\u003Ch2 id=\"1引入代码\">1.引入代码\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"csharp\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">using\u003C/span>\u003Cspan style=\"color:#B392F0\"> System\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">Collections\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">using\u003C/span>\u003Cspan style=\"color:#B392F0\"> System\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">Collections\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">Generic\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">using\u003C/span>\u003Cspan style=\"color:#B392F0\"> System\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">Text\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">RegularExpressions\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">using\u003C/span>\u003Cspan style=\"color:#B392F0\"> UnityEditor\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">using\u003C/span>\u003Cspan style=\"color:#B392F0\"> UnityEngine\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">public\u003C/span>\u003Cspan style=\"color:#F97583\"> class\u003C/span>\u003Cspan style=\"color:#B392F0\"> NovelFish\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> : \u003C/span>\u003Cspan style=\"color:#B392F0\">MonoBehaviour\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> string\u003C/span>\u003Cspan style=\"color:#E1E4E8\">[] \u003C/span>\u003Cspan style=\"color:#B392F0\">_novelChapters\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> string\u003C/span>\u003Cspan style=\"color:#E1E4E8\">[] \u003C/span>\u003Cspan style=\"color:#B392F0\">_novelWords\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    //小说显示内容\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#B392F0\">Multiline\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">10\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    public\u003C/span>\u003Cspan style=\"color:#F97583\"> string\u003C/span>\u003Cspan style=\"color:#B392F0\"> novel\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    //TXT文本文件\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    public\u003C/span>\u003Cspan style=\"color:#B392F0\"> TextAsset\u003C/span>\u003Cspan style=\"color:#B392F0\"> novelFile\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    public\u003C/span>\u003Cspan style=\"color:#B392F0\"> KeyCode\u003C/span>\u003Cspan style=\"color:#B392F0\"> 上一页\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> KeyCode.Mouse0;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    public\u003C/span>\u003Cspan style=\"color:#B392F0\"> KeyCode\u003C/span>\u003Cspan style=\"color:#B392F0\"> 下一页\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> KeyCode.Mouse1;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    public\u003C/span>\u003Cspan style=\"color:#B392F0\"> KeyCode\u003C/span>\u003Cspan style=\"color:#B392F0\"> 隐藏\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> KeyCode.Mouse2;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    public\u003C/span>\u003Cspan style=\"color:#B392F0\"> KeyCode\u003C/span>\u003Cspan style=\"color:#B392F0\"> 自动播放\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> KeyCode.A;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    public\u003C/span>\u003Cspan style=\"color:#B392F0\"> KeyCode\u003C/span>\u003Cspan style=\"color:#B392F0\"> 上一章\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> KeyCode.PageUp;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    public\u003C/span>\u003Cspan style=\"color:#B392F0\"> KeyCode\u003C/span>\u003Cspan style=\"color:#B392F0\"> 下一章\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> KeyCode.PageDown;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    public\u003C/span>\u003Cspan style=\"color:#F97583\"> bool\u003C/span>\u003Cspan style=\"color:#B392F0\"> _isPlaying\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    public\u003C/span>\u003Cspan style=\"color:#F97583\"> int\u003C/span>\u003Cspan style=\"color:#B392F0\"> ChapterTarget\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> int\u003C/span>\u003Cspan style=\"color:#B392F0\"> ChapterIndex\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        get\u003C/span>\u003Cspan style=\"color:#F97583\"> =>\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> PlayerPrefs.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetInt\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Chapter_\"\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> novelFile.name, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        set\u003C/span>\u003Cspan style=\"color:#F97583\"> =>\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> PlayerPrefs.\u003C/span>\u003Cspan style=\"color:#B392F0\">SetInt\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Chapter_\"\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> novelFile.name, value);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> int\u003C/span>\u003Cspan style=\"color:#B392F0\"> NowChapterIndex\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        get\u003C/span>\u003Cspan style=\"color:#F97583\"> =>\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> PlayerPrefs.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetInt\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Now_\"\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> novelFile.name, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        set\u003C/span>\u003Cspan style=\"color:#F97583\"> =>\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> PlayerPrefs.\u003C/span>\u003Cspan style=\"color:#B392F0\">SetInt\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Now_\"\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> novelFile.name, value);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> Start\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        LoadNovel\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    //章节跳转\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#B392F0\">ContextMenu\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"章节跳转\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> JumpPage\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (ChapterTarget \u003C/span>\u003Cspan style=\"color:#F97583\">&#x3C;\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#F97583\"> ||\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ChapterTarget \u003C/span>\u003Cspan style=\"color:#F97583\">>=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _novelChapters.Length)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            return\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        ChapterIndex \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ChapterTarget;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        NowChapterIndex \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        _novelWords \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> LoadOriginalWord\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(_novelChapters[ChapterTarget]);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        novel \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _novelWords[NowChapterIndex];\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    //重置文章\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#B392F0\">ContextMenu\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"重置文章\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> ResetText\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        NowChapterIndex \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        ChapterIndex \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        LoadNovel\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"总章数：\"\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _novelChapters.Length);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    //文章（按章节）加载\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> LoadNovel\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        //第1章\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        var\u003C/span>\u003Cspan style=\"color:#B392F0\"> pattern\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> @\"(?m)^[第][0-9]{1,4}[章]\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        //000 nnn\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // var pattern = @\"(?m)^\\d{3,4}[\\s]\";\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        //第一章 （中文数字）\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">\t    // var pattern = @\"(?m)^[第][\\u4e00-\\u9fa5]{1,5}[章]\";\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        var\u003C/span>\u003Cspan style=\"color:#B392F0\"> novelChapters\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Regex.\u003C/span>\u003Cspan style=\"color:#B392F0\">Split\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(novelFile.text, pattern);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">var\u003C/span>\u003Cspan style=\"color:#B392F0\"> i\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">; i \u003C/span>\u003Cspan style=\"color:#F97583\">&#x3C;\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> novelChapters.Length; i\u003C/span>\u003Cspan style=\"color:#F97583\">++\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            novelChapters[i] \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"第\"\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> i \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"章\"\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> novelChapters[i];\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        _novelChapters \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> novelChapters;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        _novelWords \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> LoadOriginalWord\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(_novelChapters[ChapterIndex]);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // novel = _novelWords[NowChapterIndex];\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    //按键绑定\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    public\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> Update\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKeyDown\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(下一页))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            PageDown\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKeyDown\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(上一页))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            PageUp\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKeyDown\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(隐藏))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            Hide\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKeyDown\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(自动播放))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            AutoPlay\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKeyDown\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(上一章))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            UpChapter\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKeyDown\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(下一章))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            DownChapter\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(); \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    //上一章\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> PageUp\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        NowChapterIndex\u003C/span>\u003Cspan style=\"color:#F97583\">--\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (NowChapterIndex \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#F97583\"> -\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            ChapterIndex\u003C/span>\u003Cspan style=\"color:#F97583\">--\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            _novelWords \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> LoadOriginalWord\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(_novelChapters[ChapterIndex]);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            NowChapterIndex \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _novelWords.Length \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        novel \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _novelWords[NowChapterIndex];\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    //下一章\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> PageDown\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        NowChapterIndex\u003C/span>\u003Cspan style=\"color:#F97583\">++\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (NowChapterIndex \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _novelWords.Length)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            ChapterIndex\u003C/span>\u003Cspan style=\"color:#F97583\">++\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            NowChapterIndex \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            _novelWords \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> LoadOriginalWord\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(_novelChapters[ChapterIndex]);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        novel \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _novelWords[NowChapterIndex];\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    //下一页\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> DownChapter\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        ChapterIndex\u003C/span>\u003Cspan style=\"color:#F97583\">++\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        NowChapterIndex \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        _novelWords \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> LoadOriginalWord\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(_novelChapters[ChapterIndex]);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        novel \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _novelWords[NowChapterIndex];\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    //上一页\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> UpChapter\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        ChapterIndex\u003C/span>\u003Cspan style=\"color:#F97583\">--\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        NowChapterIndex \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        _novelWords \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> LoadOriginalWord\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(_novelChapters[ChapterIndex]);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        novel \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _novelWords[NowChapterIndex];\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    //自动播放\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> AutoPlay\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        _isPlaying \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> !\u003C/span>\u003Cspan style=\"color:#E1E4E8\">_isPlaying;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (_isPlaying)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            StartCoroutine\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">nameof\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(AutoPlayIe));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        else\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            StopCoroutine\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">nameof\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(AutoPlayIe));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#B392F0\"> IEnumerator\u003C/span>\u003Cspan style=\"color:#B392F0\"> AutoPlayIe\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        PageDown\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // 自动播放延迟\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        yield\u003C/span>\u003Cspan style=\"color:#F97583\"> return\u003C/span>\u003Cspan style=\"color:#F97583\"> new\u003C/span>\u003Cspan style=\"color:#B392F0\"> WaitForSeconds\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">5f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        StartCoroutine\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">nameof\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(AutoPlayIe));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    //快速隐藏（显示）\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> Hide\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        var\u003C/span>\u003Cspan style=\"color:#B392F0\"> haveWord\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> novel \u003C/span>\u003Cspan style=\"color:#F97583\">!=\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        novel \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> haveWord \u003C/span>\u003Cspan style=\"color:#F97583\">?\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"\"\u003C/span>\u003Cspan style=\"color:#F97583\"> :\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _novelWords[NowChapterIndex];\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    //文字最多显示数量\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> const\u003C/span>\u003Cspan style=\"color:#F97583\"> int\u003C/span>\u003Cspan style=\"color:#B392F0\"> MaxWordLength\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 200\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    /// &#x3C;\u003C/span>\u003Cspan style=\"color:#85E89D\">summary\u003C/span>\u003Cspan style=\"color:#6A737D\">>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    /// 加载文章片段\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    /// &#x3C;/\u003C/span>\u003Cspan style=\"color:#85E89D\">summary\u003C/span>\u003Cspan style=\"color:#6A737D\">>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> static\u003C/span>\u003Cspan style=\"color:#F97583\"> string\u003C/span>\u003Cspan style=\"color:#E1E4E8\">[] \u003C/span>\u003Cspan style=\"color:#B392F0\">LoadOriginalWord\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">string\u003C/span>\u003Cspan style=\"color:#B392F0\"> word\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        var\u003C/span>\u003Cspan style=\"color:#B392F0\"> novelFileList\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#F97583\"> new\u003C/span>\u003Cspan style=\"color:#B392F0\"> List\u003C/span>\u003Cspan style=\"color:#E1E4E8\">&#x3C;\u003C/span>\u003Cspan style=\"color:#F97583\">string\u003C/span>\u003Cspan style=\"color:#E1E4E8\">>();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        var\u003C/span>\u003Cspan style=\"color:#B392F0\"> originalWord\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> word.\u003C/span>\u003Cspan style=\"color:#B392F0\">Split\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">var\u003C/span>\u003Cspan style=\"color:#B392F0\"> i\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">; i \u003C/span>\u003Cspan style=\"color:#F97583\">&#x3C;\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> originalWord.Length; i\u003C/span>\u003Cspan style=\"color:#F97583\">++\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            //处理掉空字符串\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            originalWord[i] \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Regex.\u003C/span>\u003Cspan style=\"color:#B392F0\">Replace\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(originalWord[i], \u003C/span>\u003Cspan style=\"color:#9ECBFF\">@\"\\s\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (originalWord[i].Length \u003C/span>\u003Cspan style=\"color:#F97583\">>\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#F97583\"> &#x26;&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> originalWord[i].Length \u003C/span>\u003Cspan style=\"color:#F97583\">&#x3C;=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 200\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                novelFileList.\u003C/span>\u003Cspan style=\"color:#B392F0\">Add\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(originalWord[i]);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            else\u003C/span>\u003Cspan style=\"color:#F97583\"> if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (originalWord[i].Length \u003C/span>\u003Cspan style=\"color:#F97583\">>\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 200\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                var\u003C/span>\u003Cspan style=\"color:#B392F0\"> ccl\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> originalWord[i].Length \u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> MaxWordLength;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">var\u003C/span>\u003Cspan style=\"color:#B392F0\"> j\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">; j \u003C/span>\u003Cspan style=\"color:#F97583\">&#x3C;=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ccl; j\u003C/span>\u003Cspan style=\"color:#F97583\">++\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                    if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (originalWord[i].Length \u003C/span>\u003Cspan style=\"color:#F97583\">!=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> j \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> MaxWordLength)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                        novelFileList.\u003C/span>\u003Cspan style=\"color:#B392F0\">Add\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(originalWord[i].\u003C/span>\u003Cspan style=\"color:#B392F0\">Substring\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(j \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> MaxWordLength,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                            j \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ccl \u003C/span>\u003Cspan style=\"color:#F97583\">?\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (originalWord[i].Length \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> j \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> MaxWordLength) \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#F97583\"> :\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> MaxWordLength));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        return\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> novelFileList.\u003C/span>\u003Cspan style=\"color:#B392F0\">ToArray\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>odin插件版\n\u003Cimg src=\"https://i-blog.csdnimg.cn/blog_migrate/1af3cc8a4eb94dda4e0d528d4a66c1e6.png\" alt=\"在这里插入图片描述\">\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"csharp\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">using\u003C/span>\u003Cspan style=\"color:#B392F0\"> Sirenix\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">OdinInspector\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">using\u003C/span>\u003Cspan style=\"color:#B392F0\"> System\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">Collections\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">using\u003C/span>\u003Cspan style=\"color:#B392F0\"> System\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">Collections\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">Generic\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">using\u003C/span>\u003Cspan style=\"color:#B392F0\"> System\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">Text\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">RegularExpressions\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">using\u003C/span>\u003Cspan style=\"color:#B392F0\"> UnityEngine\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">public\u003C/span>\u003Cspan style=\"color:#F97583\"> class\u003C/span>\u003Cspan style=\"color:#B392F0\"> NovelFish\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> : \u003C/span>\u003Cspan style=\"color:#B392F0\">MonoBehaviour\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    public\u003C/span>\u003Cspan style=\"color:#F97583\"> enum\u003C/span>\u003Cspan style=\"color:#B392F0\"> TitleType\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        T00Z\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,  \u003C/span>\u003Cspan style=\"color:#6A737D\">// 00 Z\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        D00Z\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,  \u003C/span>\u003Cspan style=\"color:#6A737D\">// DI 00 Z\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        DCNZ\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,  \u003C/span>\u003Cspan style=\"color:#6A737D\">// DI CNNUME Z\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> string\u003C/span>\u003Cspan style=\"color:#E1E4E8\">[] \u003C/span>\u003Cspan style=\"color:#B392F0\">_novelChapters\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> string\u003C/span>\u003Cspan style=\"color:#E1E4E8\">[] \u003C/span>\u003Cspan style=\"color:#B392F0\">_novelWords\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> const\u003C/span>\u003Cspan style=\"color:#F97583\"> int\u003C/span>\u003Cspan style=\"color:#B392F0\"> MAX_WORD_LENGTH\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 200\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#B392F0\">Multiline\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">9\u003C/span>\u003Cspan style=\"color:#E1E4E8\">), \u003C/span>\u003Cspan style=\"color:#B392F0\">ReadOnly\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    public\u003C/span>\u003Cspan style=\"color:#F97583\"> string\u003C/span>\u003Cspan style=\"color:#B392F0\"> novel\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#B392F0\">FoldoutGroup\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"SET\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)] \u003C/span>\u003Cspan style=\"color:#F97583\">public\u003C/span>\u003Cspan style=\"color:#B392F0\"> TextAsset\u003C/span>\u003Cspan style=\"color:#B392F0\"> novelFile\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#B392F0\">FoldoutGroup\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"SET\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)] \u003C/span>\u003Cspan style=\"color:#F97583\">public\u003C/span>\u003Cspan style=\"color:#B392F0\"> TitleType\u003C/span>\u003Cspan style=\"color:#B392F0\"> titleType\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#B392F0\">FoldoutGroup\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"SET\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)] \u003C/span>\u003Cspan style=\"color:#F97583\">public\u003C/span>\u003Cspan style=\"color:#B392F0\"> KeyCode\u003C/span>\u003Cspan style=\"color:#B392F0\"> Up\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> KeyCode.Mouse0;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#B392F0\">FoldoutGroup\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"SET\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)] \u003C/span>\u003Cspan style=\"color:#F97583\">public\u003C/span>\u003Cspan style=\"color:#B392F0\"> KeyCode\u003C/span>\u003Cspan style=\"color:#B392F0\"> Down\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> KeyCode.Mouse1;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#B392F0\">FoldoutGroup\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"SET\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)] \u003C/span>\u003Cspan style=\"color:#F97583\">public\u003C/span>\u003Cspan style=\"color:#B392F0\"> KeyCode\u003C/span>\u003Cspan style=\"color:#B392F0\"> HideKey\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> KeyCode.Mouse2;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#B392F0\">FoldoutGroup\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"SET\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)] \u003C/span>\u003Cspan style=\"color:#F97583\">public\u003C/span>\u003Cspan style=\"color:#B392F0\"> KeyCode\u003C/span>\u003Cspan style=\"color:#B392F0\"> Auto\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> KeyCode.A;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#B392F0\">FoldoutGroup\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"SET\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)] \u003C/span>\u003Cspan style=\"color:#F97583\">public\u003C/span>\u003Cspan style=\"color:#B392F0\"> KeyCode\u003C/span>\u003Cspan style=\"color:#B392F0\"> PageUpKey\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> KeyCode.PageUp;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#B392F0\">FoldoutGroup\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"SET\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)] \u003C/span>\u003Cspan style=\"color:#F97583\">public\u003C/span>\u003Cspan style=\"color:#B392F0\"> KeyCode\u003C/span>\u003Cspan style=\"color:#B392F0\"> PageDownKey\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> KeyCode.PageDown;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#B392F0\">FoldoutGroup\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"SET\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)] \u003C/span>\u003Cspan style=\"color:#F97583\">public\u003C/span>\u003Cspan style=\"color:#B392F0\"> KeyCode\u003C/span>\u003Cspan style=\"color:#B392F0\"> Stop\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> KeyCode.P;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#B392F0\">FoldoutGroup\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"SET\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">), \u003C/span>\u003Cspan style=\"color:#B392F0\">Range\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">1f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">20f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)] \u003C/span>\u003Cspan style=\"color:#F97583\">public\u003C/span>\u003Cspan style=\"color:#F97583\"> float\u003C/span>\u003Cspan style=\"color:#B392F0\"> AutoSpeed\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 5f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> bool\u003C/span>\u003Cspan style=\"color:#B392F0\"> _isPlaying\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> bool\u003C/span>\u003Cspan style=\"color:#B392F0\"> _isPaused\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#79B8FF\"> true\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> int\u003C/span>\u003Cspan style=\"color:#B392F0\"> ChapterIndex\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        get\u003C/span>\u003Cspan style=\"color:#F97583\"> =>\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> PlayerPrefs.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetInt\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Chapter_\"\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> novelFile.name, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        set\u003C/span>\u003Cspan style=\"color:#F97583\"> =>\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> PlayerPrefs.\u003C/span>\u003Cspan style=\"color:#B392F0\">SetInt\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Chapter_\"\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> novelFile.name, value);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> int\u003C/span>\u003Cspan style=\"color:#B392F0\"> NowChapterIndex\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        get\u003C/span>\u003Cspan style=\"color:#F97583\"> =>\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> PlayerPrefs.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetInt\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Now_\"\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> novelFile.name, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        set\u003C/span>\u003Cspan style=\"color:#F97583\"> =>\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> PlayerPrefs.\u003C/span>\u003Cspan style=\"color:#B392F0\">SetInt\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Now_\"\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> novelFile.name, value);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> Start\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (novelFile \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#79B8FF\"> null\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            _isPaused \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> true\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            return\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        LoadNovel\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#B392F0\">Button\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#B392F0\">Expanded\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#79B8FF\"> true\u003C/span>\u003Cspan style=\"color:#E1E4E8\">), \u003C/span>\u003Cspan style=\"color:#B392F0\">FoldoutGroup\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"SET\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> JumpPage\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">int\u003C/span>\u003Cspan style=\"color:#B392F0\"> num\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (num \u003C/span>\u003Cspan style=\"color:#F97583\">&#x3C;\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#F97583\"> ||\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> num \u003C/span>\u003Cspan style=\"color:#F97583\">>=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _novelChapters.Length)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            return\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        ChapterIndex \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> num;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        NowChapterIndex \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        _novelWords \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> LoadOriginalWord\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(_novelChapters[ChapterIndex]);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        novel \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _novelWords[NowChapterIndex];\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#B392F0\">Button\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">FoldoutGroup\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"SET\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> Clear\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        novel \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    [\u003C/span>\u003Cspan style=\"color:#B392F0\">Button\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#B392F0\">FoldoutGroup\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"SET\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> ResetText\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        NowChapterIndex \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        ChapterIndex \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        LoadNovel\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Total：\"\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _novelChapters.Length);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> LoadNovel\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        string\u003C/span>\u003Cspan style=\"color:#B392F0\"> pattern\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#F97583\"> string\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.Empty;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        switch\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (titleType)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            case\u003C/span>\u003Cspan style=\"color:#B392F0\"> TitleType\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">T00Z\u003C/span>\u003Cspan style=\"color:#E1E4E8\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pattern \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> @\"(?m)^\\d{3,4}[\\s]\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                break\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            case\u003C/span>\u003Cspan style=\"color:#B392F0\"> TitleType\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">D00Z\u003C/span>\u003Cspan style=\"color:#E1E4E8\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pattern \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> @\"(?m)^[第][0-9]{1,4}[章]\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                break\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            case\u003C/span>\u003Cspan style=\"color:#B392F0\"> TitleType\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">DCNZ\u003C/span>\u003Cspan style=\"color:#E1E4E8\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pattern \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> @\"(?m)^[第][\\u4e00-\\u9fa5]{1,5}[章]\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                break\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        var\u003C/span>\u003Cspan style=\"color:#B392F0\"> novelChapters\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Regex.\u003C/span>\u003Cspan style=\"color:#B392F0\">Split\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(novelFile.text, pattern);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">var\u003C/span>\u003Cspan style=\"color:#B392F0\"> i\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">; i \u003C/span>\u003Cspan style=\"color:#F97583\">&#x3C;\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> novelChapters.Length; i\u003C/span>\u003Cspan style=\"color:#F97583\">++\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            novelChapters[i] \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"第\"\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> i \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"章\"\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> novelChapters[i];\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        _novelChapters \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> novelChapters;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        _novelWords \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> LoadOriginalWord\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(_novelChapters[ChapterIndex]);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    //按键绑定\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    public\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> Update\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKeyDown\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(Stop))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            _isPaused \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> !\u003C/span>\u003Cspan style=\"color:#E1E4E8\">_isPaused;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (_isPaused) \u003C/span>\u003Cspan style=\"color:#F97583\">return\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKeyDown\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(Down))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            PageDown\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKeyDown\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(Up))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            PageUp\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKeyDown\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(HideKey))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            Hide\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKeyDown\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(Auto))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            AutoPlay\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKeyDown\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(PageUpKey))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            UpChapter\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Input.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetKeyDown\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(PageDownKey))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            DownChapter\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    //上一章\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> PageUp\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        NowChapterIndex\u003C/span>\u003Cspan style=\"color:#F97583\">--\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (NowChapterIndex \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#F97583\"> -\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            ChapterIndex\u003C/span>\u003Cspan style=\"color:#F97583\">--\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            _novelWords \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> LoadOriginalWord\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(_novelChapters[ChapterIndex]);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            NowChapterIndex \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _novelWords.Length \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        novel \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _novelWords[NowChapterIndex];\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    public\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> PageDown\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">int\u003C/span>\u003Cspan style=\"color:#B392F0\"> page\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        NowChapterIndex \u003C/span>\u003Cspan style=\"color:#F97583\">+=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> page;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (NowChapterIndex \u003C/span>\u003Cspan style=\"color:#F97583\">>=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _novelWords.Length)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            ChapterIndex\u003C/span>\u003Cspan style=\"color:#F97583\">++\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            NowChapterIndex \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            _novelWords \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> LoadOriginalWord\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(_novelChapters[ChapterIndex]);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        novel \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _novelWords[NowChapterIndex];\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> PageDown\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        NowChapterIndex\u003C/span>\u003Cspan style=\"color:#F97583\">++\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (NowChapterIndex \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _novelWords.Length)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            ChapterIndex\u003C/span>\u003Cspan style=\"color:#F97583\">++\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            NowChapterIndex \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            _novelWords \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> LoadOriginalWord\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(_novelChapters[ChapterIndex]);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        novel \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _novelWords[NowChapterIndex];\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> DownChapter\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        ChapterIndex\u003C/span>\u003Cspan style=\"color:#F97583\">++\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        NowChapterIndex \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        _novelWords \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> LoadOriginalWord\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(_novelChapters[ChapterIndex]);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        novel \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _novelWords[NowChapterIndex];\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> UpChapter\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        ChapterIndex\u003C/span>\u003Cspan style=\"color:#F97583\">--\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        NowChapterIndex \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        _novelWords \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> LoadOriginalWord\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(_novelChapters[ChapterIndex]);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        novel \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _novelWords[NowChapterIndex];\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> AutoPlay\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        _isPlaying \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> !\u003C/span>\u003Cspan style=\"color:#E1E4E8\">_isPlaying;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (_isPlaying)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            StartCoroutine\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">nameof\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(AutoPlayIe));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        else\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            StopCoroutine\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">nameof\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(AutoPlayIe));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#B392F0\"> IEnumerator\u003C/span>\u003Cspan style=\"color:#B392F0\"> AutoPlayIe\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        PageDown\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        yield\u003C/span>\u003Cspan style=\"color:#F97583\"> return\u003C/span>\u003Cspan style=\"color:#F97583\"> new\u003C/span>\u003Cspan style=\"color:#B392F0\"> WaitForSeconds\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(AutoSpeed);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (_isPaused)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            _isPlaying \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> false\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        else\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            StartCoroutine\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">nameof\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(AutoPlayIe));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    //快速隐藏（显示）\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> Hide\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        var\u003C/span>\u003Cspan style=\"color:#B392F0\"> haveWord\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> novel \u003C/span>\u003Cspan style=\"color:#F97583\">!=\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        novel \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> haveWord \u003C/span>\u003Cspan style=\"color:#F97583\">?\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"\"\u003C/span>\u003Cspan style=\"color:#F97583\"> :\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _novelWords[NowChapterIndex];\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    /// &#x3C;\u003C/span>\u003Cspan style=\"color:#85E89D\">summary\u003C/span>\u003Cspan style=\"color:#6A737D\">>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    /// 加载文章片段\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    /// &#x3C;/\u003C/span>\u003Cspan style=\"color:#85E89D\">summary\u003C/span>\u003Cspan style=\"color:#6A737D\">>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    private\u003C/span>\u003Cspan style=\"color:#F97583\"> static\u003C/span>\u003Cspan style=\"color:#F97583\"> string\u003C/span>\u003Cspan style=\"color:#E1E4E8\">[] \u003C/span>\u003Cspan style=\"color:#B392F0\">LoadOriginalWord\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">string\u003C/span>\u003Cspan style=\"color:#B392F0\"> word\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        var\u003C/span>\u003Cspan style=\"color:#B392F0\"> novelFileList\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#F97583\"> new\u003C/span>\u003Cspan style=\"color:#B392F0\"> List\u003C/span>\u003Cspan style=\"color:#E1E4E8\">&#x3C;\u003C/span>\u003Cspan style=\"color:#F97583\">string\u003C/span>\u003Cspan style=\"color:#E1E4E8\">>();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        var\u003C/span>\u003Cspan style=\"color:#B392F0\"> originalWord\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> word.\u003C/span>\u003Cspan style=\"color:#B392F0\">Split\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">var\u003C/span>\u003Cspan style=\"color:#B392F0\"> i\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">; i \u003C/span>\u003Cspan style=\"color:#F97583\">&#x3C;\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> originalWord.Length; i\u003C/span>\u003Cspan style=\"color:#F97583\">++\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            //处理掉空字符串\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            originalWord[i] \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Regex.\u003C/span>\u003Cspan style=\"color:#B392F0\">Replace\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(originalWord[i], \u003C/span>\u003Cspan style=\"color:#9ECBFF\">@\"\\s\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (originalWord[i].Length \u003C/span>\u003Cspan style=\"color:#F97583\">>\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#F97583\"> &#x26;&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> originalWord[i].Length \u003C/span>\u003Cspan style=\"color:#F97583\">&#x3C;=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 200\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                novelFileList.\u003C/span>\u003Cspan style=\"color:#B392F0\">Add\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(originalWord[i]);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            else\u003C/span>\u003Cspan style=\"color:#F97583\"> if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (originalWord[i].Length \u003C/span>\u003Cspan style=\"color:#F97583\">>\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 200\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                var\u003C/span>\u003Cspan style=\"color:#B392F0\"> ccl\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> originalWord[i].Length \u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> MAX_WORD_LENGTH;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">var\u003C/span>\u003Cspan style=\"color:#B392F0\"> j\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">; j \u003C/span>\u003Cspan style=\"color:#F97583\">&#x3C;=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ccl; j\u003C/span>\u003Cspan style=\"color:#F97583\">++\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                    if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (originalWord[i].Length \u003C/span>\u003Cspan style=\"color:#F97583\">!=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> j \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> MAX_WORD_LENGTH)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                        novelFileList.\u003C/span>\u003Cspan style=\"color:#B392F0\">Add\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(originalWord[i].\u003C/span>\u003Cspan style=\"color:#B392F0\">Substring\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(j \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> MAX_WORD_LENGTH,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                            j \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ccl \u003C/span>\u003Cspan style=\"color:#F97583\">?\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (originalWord[i].Length \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> j \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> MAX_WORD_LENGTH) \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#F97583\"> :\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> MAX_WORD_LENGTH));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        return\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> novelFileList.\u003C/span>\u003Cspan style=\"color:#B392F0\">ToArray\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"2导入的小说文本-txt\">2.导入的小说文本 TXT\u003C/h2>\n\u003Cp>\u003Ccode>记得要将导入的txt格式设置为UTF-8不然识别不出来\u003C/code>\n可以用记事本打开让后另存为时设置格式就好了\u003C/p>\n\u003Ch2 id=\"3在代码块里选择你下载文件的目录格式\">3.在代码块里选择你下载文件的目录格式\u003C/h2>\n\u003Cp>在70行代码左右\u003Ccode>注释掉不用的正则表达式部分\u003C/code>\u003C/p>\n\u003Ch2 id=\"4拖入文本文件再选择重置文章即可\">4.拖入文本文件再选择重置文章即可\u003C/h2>\n\u003Ch1 id=\"总结\">总结\u003C/h1>\n\u003Cp>目前缺陷还是有的，不能自动识别小说目录格式，必须在游戏运行模式下使用（用的Input检测）。\n有空还是可以改改的。\u003C/p>",{"headings":284,"localImagePaths":307,"remoteImagePaths":308,"frontmatter":277,"imagePaths":309},[285,288,290,292,294,297,300,303,306],{"depth":20,"slug":286,"text":287},"unity-编辑器扩展小说阅读器","Unity 编辑器扩展：小说阅读器",{"depth":20,"slug":289,"text":289},"前言",{"depth":20,"slug":291,"text":291},"效果演示",{"depth":20,"slug":293,"text":293},"使用步骤",{"depth":40,"slug":295,"text":296},"1引入代码","1.引入代码",{"depth":40,"slug":298,"text":299},"2导入的小说文本-txt","2.导入的小说文本 TXT",{"depth":40,"slug":301,"text":302},"3在代码块里选择你下载文件的目录格式","3.在代码块里选择你下载文件的目录格式",{"depth":40,"slug":304,"text":305},"4拖入文本文件再选择重置文章即可","4.拖入文本文件再选择重置文章即可",{"depth":20,"slug":147,"text":147},[],[],[],"post_20251229070750.md"]